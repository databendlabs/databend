=== #0 sql ===
SELECT
    l_orderkey,
    sum(l_extendedprice * (1 - l_discount)) AS revenue,
    o_orderdate,
    o_shippriority
FROM
    orders join customer on c_custkey = o_custkey,
    lineitem
WHERE
    c_mktsegment = 'BUILDING'
    AND l_orderkey = o_orderkey
    AND o_orderdate < CAST('1995-03-15' AS date)
    AND l_shipdate > CAST('1995-03-15' AS date)
GROUP BY
    l_orderkey,
    o_orderdate,
    o_shippriority
ORDER BY
    revenue DESC,
    o_orderdate

=== #0 raw plan ===
Sort
├── sort keys: [sum(l_extendedprice * (1 - l_discount)) (#34) DESC NULLS LAST, orders.o_orderdate (#4) ASC NULLS LAST]
├── limit: [NONE]
└── EvalScalar
    ├── scalars: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), lineitem.l_orderkey (#17) AS (#17), sum(l_extendedprice * (1 - l_discount)) (#34) AS (#34)]
    └── Aggregate(Final)
        ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
        ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
        └── Aggregate(Partial)
            ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
            ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
            └── EvalScalar
                ├── scalars: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), lineitem.l_orderkey (#17) AS (#17), multiply(lineitem.l_extendedprice (#22), minus(1, lineitem.l_discount (#23))) AS (#33), orders.o_custkey (#1) AS (#35), customer.c_custkey (#9) AS (#36), customer.c_mktsegment (#15) AS (#37), orders.o_orderkey (#0) AS (#38), lineitem.l_shipdate (#27) AS (#39)]
                └── Join(Inner)
                    ├── build keys: [lineitem.l_orderkey (#17)]
                    ├── probe keys: [orders.o_orderkey (#0)]
                    ├── other filters: []
                    ├── Scan
                    │   ├── table: default.lineitem (#2)
                    │   ├── filters: [gt(lineitem.l_shipdate (#27), '1995-03-15')]
                    │   ├── order by: []
                    │   └── limit: NONE
                    └── Join(Inner)
                        ├── build keys: [customer.c_custkey (#9)]
                        ├── probe keys: [orders.o_custkey (#1)]
                        ├── other filters: []
                        ├── Scan
                        │   ├── table: default.customer (#1)
                        │   ├── filters: [eq(customer.c_mktsegment (#15), 'BUILDING')]
                        │   ├── order by: []
                        │   └── limit: NONE
                        └── Scan
                            ├── table: default.orders (#0)
                            ├── filters: [lt(orders.o_orderdate (#4), '1995-03-15')]
                            ├── order by: []
                            └── limit: NONE

=== #0 apply plan 0 ===
EvalScalar
├── scalars: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), lineitem.l_orderkey (#17) AS (#17), _eager_final_sum (#41) AS (#34)]
└── Aggregate(Final)
    ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#34)) AS (#41)]
    └── Aggregate(Partial)
        ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#34)) AS (#41)]
        └── Join(Inner)
            ├── build keys: [lineitem.l_orderkey (#17)]
            ├── probe keys: [orders.o_orderkey (#0)]
            ├── other filters: []
            ├── Aggregate(Final)
            │   ├── group items: [lineitem.l_orderkey (#17) AS (#17)]
            │   ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
            │   └── Aggregate(Partial)
            │       ├── group items: [lineitem.l_orderkey (#17) AS (#17)]
            │       ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
            │       └── EvalScalar
            │           ├── scalars: [lineitem.l_orderkey (#17) AS (#17), multiply(lineitem.l_extendedprice (#22), minus(1, lineitem.l_discount (#23))) AS (#33), lineitem.l_shipdate (#27) AS (#39)]
            │           └── Scan
            │               ├── table: default.lineitem (#2)
            │               ├── filters: [gt(lineitem.l_shipdate (#27), '1995-03-15')]
            │               ├── order by: []
            │               └── limit: NONE
            └── Join(Inner)
                ├── build keys: [customer.c_custkey (#9)]
                ├── probe keys: [orders.o_custkey (#1)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.customer (#1)
                │   ├── filters: [eq(customer.c_mktsegment (#15), 'BUILDING')]
                │   ├── order by: []
                │   └── limit: NONE
                └── Scan
                    ├── table: default.orders (#0)
                    ├── filters: [lt(orders.o_orderdate (#4), '1995-03-15')]
                    ├── order by: []
                    └── limit: NONE

=== #0 apply plan 1 ===
EvalScalar
├── scalars: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), lineitem.l_orderkey (#17) AS (#17), sum(l_extendedprice * (1 - l_discount)) (#34) AS (#34)]
└── Aggregate(Final)
    ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#43)) AS (#34)]
    └── Aggregate(Partial)
        ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#43)) AS (#34)]
        └── EvalScalar
            ├── scalars: [multiply(multiply(lineitem.l_extendedprice (#22), minus(1, lineitem.l_discount (#23))), CAST(count(*) (#40) AS UInt64)) AS (#43)]
            └── Join(Inner)
                ├── build keys: [lineitem.l_orderkey (#17)]
                ├── probe keys: [orders.o_orderkey (#0)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.lineitem (#2)
                │   ├── filters: [gt(lineitem.l_shipdate (#27), '1995-03-15')]
                │   ├── order by: []
                │   └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), orders.o_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [count() AS (#40)]
                    └── Aggregate(Partial)
                        ├── group items: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), orders.o_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [count() AS (#40)]
                        └── Join(Inner)
                            ├── build keys: [customer.c_custkey (#9)]
                            ├── probe keys: [orders.o_custkey (#1)]
                            ├── other filters: []
                            ├── Scan
                            │   ├── table: default.customer (#1)
                            │   ├── filters: [eq(customer.c_mktsegment (#15), 'BUILDING')]
                            │   ├── order by: []
                            │   └── limit: NONE
                            └── Scan
                                ├── table: default.orders (#0)
                                ├── filters: [lt(orders.o_orderdate (#4), '1995-03-15')]
                                ├── order by: []
                                └── limit: NONE

=== #0 apply plan 2 ===
EvalScalar
├── scalars: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), lineitem.l_orderkey (#17) AS (#17), _eager_final_sum (#41) AS (#34)]
└── Aggregate(Final)
    ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#42)) AS (#41)]
    └── Aggregate(Partial)
        ├── group items: [lineitem.l_orderkey (#17) AS (#17), orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#42)) AS (#41)]
        └── EvalScalar
            ├── scalars: [multiply(sum(l_extendedprice * (1 - l_discount)) (#34), CAST(count(*) (#40) AS UInt64)) AS (#42)]
            └── Join(Inner)
                ├── build keys: [lineitem.l_orderkey (#17)]
                ├── probe keys: [orders.o_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [lineitem.l_orderkey (#17) AS (#17)]
                │   ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
                │   └── Aggregate(Partial)
                │       ├── group items: [lineitem.l_orderkey (#17) AS (#17)]
                │       ├── aggregate functions: [sum(sum_arg_0 (#33)) AS (#34)]
                │       └── EvalScalar
                │           ├── scalars: [lineitem.l_orderkey (#17) AS (#17), multiply(lineitem.l_extendedprice (#22), minus(1, lineitem.l_discount (#23))) AS (#33), lineitem.l_shipdate (#27) AS (#39)]
                │           └── Scan
                │               ├── table: default.lineitem (#2)
                │               ├── filters: [gt(lineitem.l_shipdate (#27), '1995-03-15')]
                │               ├── order by: []
                │               └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), orders.o_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [count() AS (#40)]
                    └── Aggregate(Partial)
                        ├── group items: [orders.o_orderdate (#4) AS (#4), orders.o_shippriority (#7) AS (#7), orders.o_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [count() AS (#40)]
                        └── Join(Inner)
                            ├── build keys: [customer.c_custkey (#9)]
                            ├── probe keys: [orders.o_custkey (#1)]
                            ├── other filters: []
                            ├── Scan
                            │   ├── table: default.customer (#1)
                            │   ├── filters: [eq(customer.c_mktsegment (#15), 'BUILDING')]
                            │   ├── order by: []
                            │   └── limit: NONE
                            └── Scan
                                ├── table: default.orders (#0)
                                ├── filters: [lt(orders.o_orderdate (#4), '1995-03-15')]
                                ├── order by: []
                                └── limit: NONE

=== #1 sql ===
SELECT o_orderkey, sum(l_extendedprice * (1-l_discount))
FROM lineitem, orders
WHERE o_orderkey = l_orderkey
AND l_returnflag = 'R'
GROUP BY o_orderkey

=== #1 raw plan ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), sum(l_extendedprice * (1 - l_discount)) (#26) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
        └── EvalScalar
            ├── scalars: [orders.o_orderkey (#16) AS (#16), multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#25), lineitem.l_orderkey (#0) AS (#27), lineitem.l_returnflag (#8) AS (#28)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.orders (#1)
                │   ├── filters: []
                │   ├── order by: []
                │   └── limit: NONE
                └── Scan
                    ├── table: default.lineitem (#0)
                    ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                    ├── order by: []
                    └── limit: NONE

=== #1 apply plan 0 ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), _eager_final_sum (#30) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#26)) AS (#30)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#26)) AS (#30)]
        └── Join(Inner)
            ├── build keys: [orders.o_orderkey (#16)]
            ├── probe keys: [lineitem.l_orderkey (#0)]
            ├── other filters: []
            ├── Scan
            │   ├── table: default.orders (#1)
            │   ├── filters: []
            │   ├── order by: []
            │   └── limit: NONE
            └── Aggregate(Final)
                ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
                └── Aggregate(Partial)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
                    └── EvalScalar
                        ├── scalars: [multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#25), lineitem.l_orderkey (#0) AS (#27), lineitem.l_returnflag (#8) AS (#28)]
                        └── Scan
                            ├── table: default.lineitem (#0)
                            ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                            ├── order by: []
                            └── limit: NONE

=== #1 apply plan 1 ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), sum(l_extendedprice * (1 - l_discount)) (#26) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#32)) AS (#26)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#32)) AS (#26)]
        └── EvalScalar
            ├── scalars: [multiply(multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))), CAST(count(*) (#29) AS UInt64)) AS (#32)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │   ├── aggregate functions: [count() AS (#29)]
                │   └── Aggregate(Partial)
                │       ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │       ├── aggregate functions: [count() AS (#29)]
                │       └── Scan
                │           ├── table: default.orders (#1)
                │           ├── filters: []
                │           ├── order by: []
                │           └── limit: NONE
                └── Scan
                    ├── table: default.lineitem (#0)
                    ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                    ├── order by: []
                    └── limit: NONE

=== #1 apply plan 2 ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), _eager_final_sum (#30) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#31)) AS (#30)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) * _eager_count (#31)) AS (#30)]
        └── EvalScalar
            ├── scalars: [multiply(sum(l_extendedprice * (1 - l_discount)) (#26), CAST(count(*) (#29) AS UInt64)) AS (#31)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │   ├── aggregate functions: [count() AS (#29)]
                │   └── Aggregate(Partial)
                │       ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │       ├── aggregate functions: [count() AS (#29)]
                │       └── Scan
                │           ├── table: default.orders (#1)
                │           ├── filters: []
                │           ├── order by: []
                │           └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
                    └── Aggregate(Partial)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(sum_arg_0 (#25)) AS (#26)]
                        └── EvalScalar
                            ├── scalars: [multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#25), lineitem.l_orderkey (#0) AS (#27), lineitem.l_returnflag (#8) AS (#28)]
                            └── Scan
                                ├── table: default.lineitem (#0)
                                ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                                ├── order by: []
                                └── limit: NONE

=== #2 sql ===
SELECT o_orderkey, sum(l_extendedprice), sum(o_totalprice)
FROM lineitem, orders
WHERE o_orderkey = l_orderkey
GROUP BY o_orderkey

=== #2 raw plan ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), sum(l_extendedprice) (#25) AS (#25), sum(o_totalprice) (#26) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), sum(orders.o_totalprice (#19)) AS (#26)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), sum(orders.o_totalprice (#19)) AS (#26)]
        └── EvalScalar
            ├── scalars: [lineitem.l_extendedprice (#5) AS (#5), orders.o_orderkey (#16) AS (#16), orders.o_totalprice (#19) AS (#19), lineitem.l_orderkey (#0) AS (#27)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.orders (#1)
                │   ├── filters: []
                │   ├── order by: []
                │   └── limit: NONE
                └── Scan
                    ├── table: default.lineitem (#0)
                    ├── filters: []
                    ├── order by: []
                    └── limit: NONE

=== #2 apply plan 0 ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), _eager_final_sum (#30) AS (#25), sum(o_totalprice) (#26) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum(l_extendedprice) (#25)) AS (#30), sum(sum(o_totalprice) * _eager_count (#34)) AS (#26)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum(l_extendedprice) (#25)) AS (#30), sum(sum(o_totalprice) * _eager_count (#34)) AS (#26)]
        └── EvalScalar
            ├── scalars: [multiply(orders.o_totalprice (#19), CAST(count(*) (#28) AS UInt64)) AS (#34)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.orders (#1)
                │   ├── filters: []
                │   ├── order by: []
                │   └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), count() AS (#28)]
                    └── Aggregate(Partial)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), count() AS (#28)]
                        └── EvalScalar
                            ├── scalars: [lineitem.l_extendedprice (#5) AS (#5), lineitem.l_orderkey (#0) AS (#27)]
                            └── Scan
                                ├── table: default.lineitem (#0)
                                ├── filters: []
                                ├── order by: []
                                └── limit: NONE

=== #2 apply plan 1 ===
EvalScalar
├── scalars: [orders.o_orderkey (#16) AS (#16), _eager_final_sum (#30) AS (#25), _eager_final_sum (#31) AS (#26)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#16) AS (#16)]
    ├── aggregate functions: [sum(sum(l_extendedprice) * _eager_count (#32)) AS (#30), sum(sum(o_totalprice) * _eager_count (#33)) AS (#31)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#16) AS (#16)]
        ├── aggregate functions: [sum(sum(l_extendedprice) * _eager_count (#32)) AS (#30), sum(sum(o_totalprice) * _eager_count (#33)) AS (#31)]
        └── EvalScalar
            ├── scalars: [multiply(sum(l_extendedprice) (#25), CAST(count(*) (#29) AS UInt64)) AS (#32), multiply(sum(o_totalprice) (#26), CAST(count(*) (#28) AS UInt64)) AS (#33)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#16)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │   ├── aggregate functions: [sum(orders.o_totalprice (#19)) AS (#26), count() AS (#29)]
                │   └── Aggregate(Partial)
                │       ├── group items: [orders.o_orderkey (#16) AS (#16)]
                │       ├── aggregate functions: [sum(orders.o_totalprice (#19)) AS (#26), count() AS (#29)]
                │       └── EvalScalar
                │           ├── scalars: [orders.o_orderkey (#16) AS (#16), orders.o_totalprice (#19) AS (#19)]
                │           └── Scan
                │               ├── table: default.orders (#1)
                │               ├── filters: []
                │               ├── order by: []
                │               └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), count() AS (#28)]
                    └── Aggregate(Partial)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(lineitem.l_extendedprice (#5)) AS (#25), count() AS (#28)]
                        └── EvalScalar
                            ├── scalars: [lineitem.l_extendedprice (#5) AS (#5), lineitem.l_orderkey (#0) AS (#27)]
                            └── Scan
                                ├── table: default.lineitem (#0)
                                ├── filters: []
                                ├── order by: []
                                └── limit: NONE

=== #3 sql ===
SELECT o_orderkey, sum(revenue)
    FROM (SELECT l_orderkey, sum(l_extendedprice * (1-l_discount)) as revenue
        FROM lineitem WHERE l_returnflag = 'R' GROUP BY l_orderkey) as loss, orders
    WHERE o_orderkey = l_orderkey
    AND o_orderdate BETWEEN CAST('1995-05-01' as date) AND CAST('1995-05-31' as date)
    GROUP BY o_orderkey

=== #3 raw plan ===
EvalScalar
├── scalars: [orders.o_orderkey (#18) AS (#18), sum(revenue) (#27) AS (#27)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#18) AS (#18)]
    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#18) AS (#18)]
        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
        └── EvalScalar
            ├── scalars: [sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17), orders.o_orderkey (#18) AS (#18), lineitem.l_orderkey (#0) AS (#29), orders.o_orderdate (#22) AS (#30)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#18)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Scan
                │   ├── table: default.orders (#1)
                │   ├── filters: [gte(orders.o_orderdate (#22), '1995-05-01'), lte(orders.o_orderdate (#22), '1995-05-31')]
                │   ├── order by: []
                │   └── limit: NONE
                └── EvalScalar
                    ├── scalars: [lineitem.l_orderkey (#0) AS (#0), sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17)]
                    └── Aggregate(Final)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                        └── Aggregate(Partial)
                            ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                            ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                            └── EvalScalar
                                ├── scalars: [lineitem.l_orderkey (#0) AS (#0), multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#16), lineitem.l_returnflag (#8) AS (#28)]
                                └── Scan
                                    ├── table: default.lineitem (#0)
                                    ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                                    ├── order by: []
                                    └── limit: NONE

=== #3 apply plan 0 ===
EvalScalar
├── scalars: [orders.o_orderkey (#18) AS (#18), _eager_final_sum (#32) AS (#27)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#18) AS (#18)]
    ├── aggregate functions: [sum(sum(revenue) (#27)) AS (#32)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#18) AS (#18)]
        ├── aggregate functions: [sum(sum(revenue) (#27)) AS (#32)]
        └── Join(Inner)
            ├── build keys: [orders.o_orderkey (#18)]
            ├── probe keys: [lineitem.l_orderkey (#0)]
            ├── other filters: []
            ├── Scan
            │   ├── table: default.orders (#1)
            │   ├── filters: [gte(orders.o_orderdate (#22), '1995-05-01'), lte(orders.o_orderdate (#22), '1995-05-31')]
            │   ├── order by: []
            │   └── limit: NONE
            └── Aggregate(Final)
                ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
                └── Aggregate(Partial)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
                    └── EvalScalar
                        ├── scalars: [sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17), lineitem.l_orderkey (#0) AS (#29)]
                        └── EvalScalar
                            ├── scalars: [lineitem.l_orderkey (#0) AS (#0), sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17)]
                            └── Aggregate(Final)
                                ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                                ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                                └── Aggregate(Partial)
                                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                                    ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                                    └── EvalScalar
                                        ├── scalars: [lineitem.l_orderkey (#0) AS (#0), multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#16), lineitem.l_returnflag (#8) AS (#28)]
                                        └── Scan
                                            ├── table: default.lineitem (#0)
                                            ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                                            ├── order by: []
                                            └── limit: NONE

=== #3 apply plan 1 ===
EvalScalar
├── scalars: [orders.o_orderkey (#18) AS (#18), sum(revenue) (#27) AS (#27)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#18) AS (#18)]
    ├── aggregate functions: [sum(sum(revenue) * _eager_count (#34)) AS (#27)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#18) AS (#18)]
        ├── aggregate functions: [sum(sum(revenue) * _eager_count (#34)) AS (#27)]
        └── EvalScalar
            ├── scalars: [multiply(sum(l_extendedprice * (1 - l_discount)) (#17), CAST(count(*) (#31) AS UInt64)) AS (#34)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#18)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [orders.o_orderkey (#18) AS (#18)]
                │   ├── aggregate functions: [count() AS (#31)]
                │   └── Aggregate(Partial)
                │       ├── group items: [orders.o_orderkey (#18) AS (#18)]
                │       ├── aggregate functions: [count() AS (#31)]
                │       └── Scan
                │           ├── table: default.orders (#1)
                │           ├── filters: [gte(orders.o_orderdate (#22), '1995-05-01'), lte(orders.o_orderdate (#22), '1995-05-31')]
                │           ├── order by: []
                │           └── limit: NONE
                └── EvalScalar
                    ├── scalars: [lineitem.l_orderkey (#0) AS (#0), sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17)]
                    └── Aggregate(Final)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                        └── Aggregate(Partial)
                            ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                            ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                            └── EvalScalar
                                ├── scalars: [lineitem.l_orderkey (#0) AS (#0), multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#16), lineitem.l_returnflag (#8) AS (#28)]
                                └── Scan
                                    ├── table: default.lineitem (#0)
                                    ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                                    ├── order by: []
                                    └── limit: NONE

=== #3 apply plan 2 ===
EvalScalar
├── scalars: [orders.o_orderkey (#18) AS (#18), _eager_final_sum (#32) AS (#27)]
└── Aggregate(Final)
    ├── group items: [orders.o_orderkey (#18) AS (#18)]
    ├── aggregate functions: [sum(sum(revenue) * _eager_count (#33)) AS (#32)]
    └── Aggregate(Partial)
        ├── group items: [orders.o_orderkey (#18) AS (#18)]
        ├── aggregate functions: [sum(sum(revenue) * _eager_count (#33)) AS (#32)]
        └── EvalScalar
            ├── scalars: [multiply(sum(revenue) (#27), CAST(count(*) (#31) AS UInt64)) AS (#33)]
            └── Join(Inner)
                ├── build keys: [orders.o_orderkey (#18)]
                ├── probe keys: [lineitem.l_orderkey (#0)]
                ├── other filters: []
                ├── Aggregate(Final)
                │   ├── group items: [orders.o_orderkey (#18) AS (#18)]
                │   ├── aggregate functions: [count() AS (#31)]
                │   └── Aggregate(Partial)
                │       ├── group items: [orders.o_orderkey (#18) AS (#18)]
                │       ├── aggregate functions: [count() AS (#31)]
                │       └── Scan
                │           ├── table: default.orders (#1)
                │           ├── filters: [gte(orders.o_orderdate (#22), '1995-05-01'), lte(orders.o_orderdate (#22), '1995-05-31')]
                │           ├── order by: []
                │           └── limit: NONE
                └── Aggregate(Final)
                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                    ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
                    └── Aggregate(Partial)
                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                        ├── aggregate functions: [sum(sum(l_extendedprice * (1 - l_discount)) (#17)) AS (#27)]
                        └── EvalScalar
                            ├── scalars: [sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17), lineitem.l_orderkey (#0) AS (#29)]
                            └── EvalScalar
                                ├── scalars: [lineitem.l_orderkey (#0) AS (#0), sum(l_extendedprice * (1 - l_discount)) (#17) AS (#17)]
                                └── Aggregate(Final)
                                    ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                                    ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                                    └── Aggregate(Partial)
                                        ├── group items: [lineitem.l_orderkey (#0) AS (#0)]
                                        ├── aggregate functions: [sum(sum_arg_0 (#16)) AS (#17)]
                                        └── EvalScalar
                                            ├── scalars: [lineitem.l_orderkey (#0) AS (#0), multiply(lineitem.l_extendedprice (#5), minus(1, lineitem.l_discount (#6))) AS (#16), lineitem.l_returnflag (#8) AS (#28)]
                                            └── Scan
                                                ├── table: default.lineitem (#0)
                                                ├── filters: [eq(lineitem.l_returnflag (#8), 'R')]
                                                ├── order by: []
                                                └── limit: NONE


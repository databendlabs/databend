ast: count(1)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([2, 2])              |
+--------+-----------------------------+


ast: count(const_int)
evaluation (internal):
+-----------+----------------------------------------+
| Column    | Data                                   |
+-----------+----------------------------------------+
| const_int | Const(Number(5_i32), Number(Int32), 4) |
| Output    | UInt64([2, 2])                         |
+-----------+----------------------------------------+


ast: count(const_int_null)
evaluation (internal):
+----------------+-----------------------------------------+
| Column         | Data                                    |
+----------------+-----------------------------------------+
| const_int_null | Const(Null, Nullable(Number(Int32)), 4) |
| Output         | UInt64([0, 0])                          |
+----------------+-----------------------------------------+


ast: count()
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([2, 2])              |
+--------+-----------------------------+


ast: count(a)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([2, 2])              |
+--------+-----------------------------+


ast: count(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 1])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: sum0(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 2])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: count(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | UInt64([0, 0])                                                                  |
+----------+---------------------------------------------------------------------------------+


ast: count_distinct(null)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([0, 0])              |
+--------+-----------------------------+


ast: count_distinct(null,null)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([0, 0])              |
+--------+-----------------------------+


ast: count_distinct(1)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([1, 1])              |
+--------+-----------------------------+


ast: count_distinct(a)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([2, 2])              |
+--------+-----------------------------+


ast: count_distinct(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 1])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: count_distinct(x_null,a)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 1])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: count_distinct(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | UInt64([0, 0])                                                                  |
+----------+---------------------------------------------------------------------------------+


ast: count_distinct(all_null,s)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| s        | Column(StringColumn[abc, def, opq, xyz])                                        |
| Output   | UInt64([0, 0])                                                                  |
+----------+---------------------------------------------------------------------------------+


ast: count_distinct(s_null,s)
evaluation (internal):
+--------+------------------------------------------------------------------------------------+
| Column | Data                                                                               |
+--------+------------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                           |
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] }) |
| Output | UInt64([2, 1])                                                                     |
+--------+------------------------------------------------------------------------------------+


ast: sum(1)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                       |
| Output | NullableColumn { column: UInt64([2, 2]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: sum(a)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: Int64([6, 4]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: sum(const_int)
evaluation (internal):
+-----------+--------------------------------------------------------------------+
| Column    | Data                                                               |
+-----------+--------------------------------------------------------------------+
| const_int | Const(Number(5_i32), Number(Int32), 4)                             |
| Output    | NullableColumn { column: Int64([10, 10]), validity: [0b______11] } |
+-----------+--------------------------------------------------------------------+


ast: sum(const_int_null)
evaluation (internal):
+----------------+------------------------------------------------------------------+
| Column         | Data                                                             |
+----------------+------------------------------------------------------------------+
| const_int_null | Const(Null, Nullable(Number(Int32)), 4)                          |
| Output         | NullableColumn { column: Int64([0, 0]), validity: [0b______00] } |
+----------------+------------------------------------------------------------------+


ast: sum(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: sum(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: avg(1)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([1, 1]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: avg(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([3, 2]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: avg(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | NullableColumn { column: Decimal64([1.1000, 2.7500]), validity: [0b______11] }                 |
+--------+------------------------------------------------------------------------------------------------+


ast: avg(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: avg(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: Float64([0, 0]), validity: [0b______00] }              |
+----------+---------------------------------------------------------------------------------+


ast: uniq(1)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([1, 1])              |
+--------+-----------------------------+


ast: uniq(c)
evaluation (internal):
+--------+------------------------------+
| Column | Data                         |
+--------+------------------------------+
| c      | Column(UInt64([1, 2, 1, 3])) |
| Output | UInt64([1, 2])               |
+--------+------------------------------+


ast: uniq(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 1])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: uniq(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | UInt64([0, 0])                                                                  |
+----------+---------------------------------------------------------------------------------+


ast: count_if(1, x_null is null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | UInt64([1, 1])                                                                  |
+--------+---------------------------------------------------------------------------------+


ast: count_if(1, false)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([0, 0])              |
+--------+-----------------------------+


ast: sum_if(a, x_null is null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Int64([2, 1]), validity: [0b______11] }                |
+--------+---------------------------------------------------------------------------------+


ast: sum_if(b, x_null is null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                                    |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: sum_distinct(a)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: Int64([6, 4]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: sum_distinct(c)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| c      | Column(UInt64([1, 2, 1, 3]))                                      |
| Output | NullableColumn { column: UInt64([1, 5]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: sum_distinct(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: sum_distinct(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: max(1)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: UInt8([1, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: max(NULL)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | Null { len: 2 }             |
+--------+-----------------------------+


ast: max(a)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: Int64([4, 3]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: max(b)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                      |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: max(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: max(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: min(1)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: UInt8([1, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: min(NULL)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | Null { len: 2 }             |
+--------+-----------------------------+


ast: min(const_int)
evaluation (internal):
+-----------+------------------------------------------------------------------+
| Column    | Data                                                             |
+-----------+------------------------------------------------------------------+
| const_int | Const(Number(5_i32), Number(Int32), 4)                           |
| Output    | NullableColumn { column: Int32([5, 5]), validity: [0b______11] } |
+-----------+------------------------------------------------------------------+


ast: min(const_int_null)
evaluation (internal):
+----------------+------------------------------------------------------------------+
| Column         | Data                                                             |
+----------------+------------------------------------------------------------------+
| const_int_null | Const(Null, Nullable(Number(Int32)), 4)                          |
| Output         | NullableColumn { column: Int32([0, 0]), validity: [0b______00] } |
+----------------+------------------------------------------------------------------+


ast: min(a)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: Int64([2, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: min(b)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                      |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: min(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: min(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: any(1)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: UInt8([1, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: any(NULL)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | Null { len: 2 }             |
+--------+-----------------------------+


ast: any(a)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: Int64([4, 3]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: any(b)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                      |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: any(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: any(y_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: any(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: arg_min(a, b)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| b      | Column(UInt64([1, 2, 3, 4]))                                     |
| Output | NullableColumn { column: Int64([4, 3]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: arg_min(b, a)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                       |
| b      | Column(UInt64([1, 2, 3, 4]))                                      |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: arg_min(y_null, a)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: arg_min(a, y_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | NullableColumn { column: Int64([2, 1]), validity: [0b______11] }                |
+--------+---------------------------------------------------------------------------------+


ast: arg_min(all_null, a)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: arg_min(a, all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: Int64([0, 0]), validity: [0b______00] }                |
+----------+---------------------------------------------------------------------------------+


ast: arg_max(a, b)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| b      | Column(UInt64([1, 2, 3, 4]))                                     |
| Output | NullableColumn { column: Int64([2, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: arg_max(b, a)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                       |
| b      | Column(UInt64([1, 2, 3, 4]))                                      |
| Output | NullableColumn { column: UInt64([1, 2]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: arg_max(const_int, a)
evaluation (internal):
+-----------+------------------------------------------------------------------+
| Column    | Data                                                             |
+-----------+------------------------------------------------------------------+
| a         | Column(Int64([4, 3, 2, 1]))                                      |
| const_int | Const(Number(5_i32), Number(Int32), 4)                           |
| Output    | NullableColumn { column: Int32([5, 5]), validity: [0b______11] } |
+-----------+------------------------------------------------------------------+


ast: arg_max(const_int_null, a)
evaluation (internal):
+----------------+------------------------------------------------------------------+
| Column         | Data                                                             |
+----------------+------------------------------------------------------------------+
| a              | Column(Int64([4, 3, 2, 1]))                                      |
| const_int_null | Const(Null, Nullable(Number(Int32)), 4)                          |
| Output         | NullableColumn { column: Int32([0, 0]), validity: [0b______00] } |
+----------------+------------------------------------------------------------------+


ast: arg_max(a, const_int)
evaluation (internal):
+-----------+------------------------------------------------------------------+
| Column    | Data                                                             |
+-----------+------------------------------------------------------------------+
| a         | Column(Int64([4, 3, 2, 1]))                                      |
| const_int | Const(Number(5_i32), Number(Int32), 4)                           |
| Output    | NullableColumn { column: Int64([4, 3]), validity: [0b______11] } |
+-----------+------------------------------------------------------------------+


ast: arg_max(a, const_int_null)
evaluation (internal):
+----------------+------------------------------------------------------------------+
| Column         | Data                                                             |
+----------------+------------------------------------------------------------------+
| a              | Column(Int64([4, 3, 2, 1]))                                      |
| const_int_null | Const(Null, Nullable(Number(Int32)), 4)                          |
| Output         | NullableColumn { column: Int64([0, 0]), validity: [0b______00] } |
+----------------+------------------------------------------------------------------+


ast: arg_max(y_null, a)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | NullableColumn { column: UInt64([3, 4]), validity: [0b______11] }               |
+--------+---------------------------------------------------------------------------------+


ast: arg_max(a, y_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | NullableColumn { column: Int64([2, 1]), validity: [0b______11] }                |
+--------+---------------------------------------------------------------------------------+


ast: arg_max(all_null, a)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: arg_max(a, all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: Int64([0, 0]), validity: [0b______00] }                |
+----------+---------------------------------------------------------------------------------+


ast: covar_samp(a, b)
evaluation (internal):
+--------+----------------------------------------------------------------------+
| Column | Data                                                                 |
+--------+----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                          |
| b      | Column(UInt64([1, 2, 3, 4]))                                         |
| Output | NullableColumn { column: Float64([-2, -2]), validity: [0b______11] } |
+--------+----------------------------------------------------------------------+


ast: covar_samp(a, x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([inf, inf]), validity: [0b______11] }          |
+--------+---------------------------------------------------------------------------------+


ast: covar_samp(a, all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: Float64([0, 0]), validity: [0b______00] }              |
+----------+---------------------------------------------------------------------------------+


ast: covar_pop(a, b)
evaluation (internal):
+--------+----------------------------------------------------------------------+
| Column | Data                                                                 |
+--------+----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                          |
| b      | Column(UInt64([1, 2, 3, 4]))                                         |
| Output | NullableColumn { column: Float64([-1, -1]), validity: [0b______11] } |
+--------+----------------------------------------------------------------------+


ast: covar_pop(a, x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                     |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: covar_pop(a, all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                     |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: Float64([0, 0]), validity: [0b______00] }              |
+----------+---------------------------------------------------------------------------------+


ast: retention(a > 1, b > 1)
evaluation (internal):
+--------+--------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                               |
+--------+--------------------------------------------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                                                        |
| b      | Column(UInt64([1, 2, 3, 4]))                                                                                       |
| Output | NullableColumn { column: ArrayColumn { values: UInt8([1, 1, 1, 1]), offsets: [0, 2, 4] }, validity: [0b______11] } |
+--------+--------------------------------------------------------------------------------------------------------------------+


ast: retention(a > 1, b > 1, x_null > 1)
evaluation (internal):
+--------+--------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                     |
+--------+--------------------------------------------------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                                                              |
| b      | Column(UInt64([1, 2, 3, 4]))                                                                                             |
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] })                                          |
| Output | NullableColumn { column: ArrayColumn { values: UInt8([1, 0, 0, 1, 1, 1]), offsets: [0, 3, 6] }, validity: [0b______11] } |
+--------+--------------------------------------------------------------------------------------------------------------------------+


ast: retention(a > 1, b > 1, x_null > 1, all_null > 1)
evaluation (internal):
+----------+----------------------------------------------------------------------------------------------------------+
| Column   | Data                                                                                                     |
+----------+----------------------------------------------------------------------------------------------------------+
| a        | Column(Int64([4, 3, 2, 1]))                                                                              |
| b        | Column(UInt64([1, 2, 3, 4]))                                                                             |
| x_null   | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] })                          |
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] })                          |
| Output   | NullableColumn { column: ArrayColumn { values: UInt8([]), offsets: [0, 0, 0] }, validity: [0b______00] } |
+----------+----------------------------------------------------------------------------------------------------------+


ast: stddev_pop(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([1, 1]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: stddev(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______00] }              |
+--------+---------------------------------------------------------------------------------+


ast: stddev_samp(a)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------+
| Column | Data                                                                                     |
+--------+------------------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                              |
| Output | NullableColumn { column: Float64([1.4142135623, 1.4142135623]), validity: [0b______11] } |
+--------+------------------------------------------------------------------------------------------+


ast: stddev_samp(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | NullableColumn { column: Float64([0, 0.7778174593]), validity: [0b______10] }                  |
+--------+------------------------------------------------------------------------------------------------+


ast: stddev_samp(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______00] }              |
+--------+---------------------------------------------------------------------------------+


ast: kurtosis(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: kurtosis(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: skewness(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: skewness(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([0, 0]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: quantile_cont(0.8)(a)
evaluation (internal):
+--------+------------------------------------------------------------------------+
| Column | Data                                                                   |
+--------+------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                            |
| Output | NullableColumn { column: Float64([3.6, 2.6]), validity: [0b______11] } |
+--------+------------------------------------------------------------------------+


ast: quantile_cont(0.8)(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: quantile_cont(0.8)(a)
evaluation (internal):
+--------+------------------------------------------------------------------------+
| Column | Data                                                                   |
+--------+------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                            |
| Output | NullableColumn { column: Float64([3.6, 2.6]), validity: [0b______11] } |
+--------+------------------------------------------------------------------------+


ast: quantile_cont(0.8)(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: quantile_tdigest(0.8)(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([4, 3]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: quantile_tdigest(0.8)(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: median(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([3, 2]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: median(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: median_tdigest(a)
evaluation (internal):
+--------+--------------------------------------------------------------------+
| Column | Data                                                               |
+--------+--------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                        |
| Output | NullableColumn { column: Float64([4, 3]), validity: [0b______11] } |
+--------+--------------------------------------------------------------------+


ast: median_tdigest(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | NullableColumn { column: Float64([1, 2]), validity: [0b______11] }              |
+--------+---------------------------------------------------------------------------------+


ast: window_funnel(2)(dt, event1, event2, event3)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| dt     | Column(Timestamp([1, 0, 2, 3]))                                  |
| event1 | Column(Boolean([0b____0001]))                                    |
| event2 | Column(Boolean([0b____0000]))                                    |
| event3 | Column(Boolean([0b____0000]))                                    |
| Output | NullableColumn { column: UInt8([1, 0]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: approx_count_distinct(a)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([2, 2])              |
+--------+-----------------------------+


ast: approx_count_distinct(b)
evaluation (internal):
+--------+------------------------------+
| Column | Data                         |
+--------+------------------------------+
| b      | Column(UInt64([1, 2, 3, 4])) |
| Output | UInt64([2, 2])               |
+--------+------------------------------+


ast: approx_count_distinct(null)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | UInt64([0, 0])              |
+--------+-----------------------------+


ast: array_agg(1)
evaluation (internal):
+--------+-----------------------------------------------------------------+
| Column | Data                                                            |
+--------+-----------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                     |
| Output | ArrayColumn { values: UInt8([1, 1, 1, 1]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------+


ast: array_agg(const_int)
evaluation (internal):
+-----------+-----------------------------------------------------------------+
| Column    | Data                                                            |
+-----------+-----------------------------------------------------------------+
| const_int | Const(Number(5_i32), Number(Int32), 4)                          |
| Output    | ArrayColumn { values: Int32([5, 5, 5, 5]), offsets: [0, 2, 4] } |
+-----------+-----------------------------------------------------------------+


ast: array_agg(const_int_null)
evaluation (internal):
+----------------+-------------------------------------------------------+
| Column         | Data                                                  |
+----------------+-------------------------------------------------------+
| const_int_null | Const(Null, Nullable(Number(Int32)), 4)               |
| Output         | ArrayColumn { values: Int32([]), offsets: [0, 0, 0] } |
+----------------+-------------------------------------------------------+


ast: array_agg('a')
evaluation (internal):
+--------+----------------------------------------------------------------------+
| Column | Data                                                                 |
+--------+----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                          |
| Output | ArrayColumn { values: StringColumn[a, a, a, a], offsets: [0, 2, 4] } |
+--------+----------------------------------------------------------------------+


ast: array_agg(NULL)
evaluation (internal):
+--------+-------------------------------------------------------------+
| Column | Data                                                        |
+--------+-------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                 |
| Output | ArrayColumn { values: Null { len: 0 }, offsets: [0, 0, 0] } |
+--------+-------------------------------------------------------------+


ast: array_agg(a)
evaluation (internal):
+--------+-----------------------------------------------------------------+
| Column | Data                                                            |
+--------+-----------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                     |
| Output | ArrayColumn { values: Int64([4, 2, 3, 1]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------+


ast: array_agg(b)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                     |
| Output | ArrayColumn { values: UInt64([1, 3, 2, 4]), offsets: [0, 2, 4] } |
+--------+------------------------------------------------------------------+


ast: array_agg(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | ArrayColumn { values: UInt64([1, 2]), offsets: [0, 1, 2] }                      |
+--------+---------------------------------------------------------------------------------+


ast: array_agg(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | ArrayColumn { values: UInt64([]), offsets: [0, 0, 0] }                          |
+----------+---------------------------------------------------------------------------------+


ast: array_agg(dt)
evaluation (internal):
+--------+---------------------------------------------------------------------+
| Column | Data                                                                |
+--------+---------------------------------------------------------------------+
| dt     | Column(Timestamp([1, 0, 2, 3]))                                     |
| Output | ArrayColumn { values: Timestamp([1, 2, 0, 3]), offsets: [0, 2, 4] } |
+--------+---------------------------------------------------------------------+


ast: array_agg(event1)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| event1 | Column(Boolean([0b____0001]))                                     |
| Output | ArrayColumn { values: Boolean([0b____0001]), offsets: [0, 2, 4] } |
+--------+-------------------------------------------------------------------+


ast: array_agg(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | ArrayColumn { values: Decimal64([1.10, 2.20, 3.30]), offsets: [0, 1, 3] }                      |
+--------+------------------------------------------------------------------------------------------------+


ast: array_agg(s)
evaluation (internal):
+--------+------------------------------------------------------------------------------+
| Column | Data                                                                         |
+--------+------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                     |
| Output | ArrayColumn { values: StringColumn[abc, opq, def, xyz], offsets: [0, 2, 4] } |
+--------+------------------------------------------------------------------------------+


ast: array_agg(parse_json(json))
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                    |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| json   | Column(StringColumn[{"k1":"v1","k2":"v2"}, [1,2,3,"abc"], 99999, "xyz"])                                                                                                                                                                |
| Output | ArrayColumn { values: Variant([0x40000002100000021000000210000002100000026b316b3276317632, 0x2000000020000005500001869f, 0x8000000420000002200000022000000210000003500150025003616263, 0x200000001000000378797a]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: string_agg(s)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                        |
| Output | NullableColumn { column: StringColumn[abcopq, defxyz], validity: [0b______11] } |
+--------+---------------------------------------------------------------------------------+


ast: string_agg(s_null)
evaluation (internal):
+--------+------------------------------------------------------------------------------------+
| Column | Data                                                                               |
+--------+------------------------------------------------------------------------------------+
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] }) |
| Output | NullableColumn { column: StringColumn[ac, d], validity: [0b______11] }             |
+--------+------------------------------------------------------------------------------------+


ast: string_agg(s, '|')
evaluation (internal):
+--------+-----------------------------------------------------------------------------------+
| Column | Data                                                                              |
+--------+-----------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                          |
| Output | NullableColumn { column: StringColumn[abc|opq, def|xyz], validity: [0b______11] } |
+--------+-----------------------------------------------------------------------------------+


ast: string_agg(s_null, '-')
evaluation (internal):
+--------+------------------------------------------------------------------------------------+
| Column | Data                                                                               |
+--------+------------------------------------------------------------------------------------+
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] }) |
| Output | NullableColumn { column: StringColumn[a-c, d], validity: [0b______11] }            |
+--------+------------------------------------------------------------------------------------+


ast: listagg(s)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                        |
| Output | NullableColumn { column: StringColumn[abcopq, defxyz], validity: [0b______11] } |
+--------+---------------------------------------------------------------------------------+


ast: listagg(s_null)
evaluation (internal):
+--------+------------------------------------------------------------------------------------+
| Column | Data                                                                               |
+--------+------------------------------------------------------------------------------------+
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] }) |
| Output | NullableColumn { column: StringColumn[ac, d], validity: [0b______11] }             |
+--------+------------------------------------------------------------------------------------+


ast: listagg(s, '|')
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                        |
| Output | NullableColumn { column: StringColumn[abcopq, defxyz], validity: [0b______11] } |
+--------+---------------------------------------------------------------------------------+


ast: listagg(s_null, '-')
evaluation (internal):
+--------+------------------------------------------------------------------------------------+
| Column | Data                                                                               |
+--------+------------------------------------------------------------------------------------+
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] }) |
| Output | NullableColumn { column: StringColumn[ac, d], validity: [0b______11] }             |
+--------+------------------------------------------------------------------------------------+


ast: bitmap_and_count(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([3, 3]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: bitmap_or_count(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([7, 7]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: bitmap_xor_count(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([4, 4]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: bitmap_not_count(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([2, 2]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: intersect_count(1, 2, 3, 4)(bm, b)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                                                                                                                                                                                                                                                                                                                                                             |
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([3, 3]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: intersect_count(1, 2)(bm, b)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                                                                                                                                                                                                                                                                                                                                                             |
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: UInt64([5, 5]), validity: [0b______11] }                                                                                                                                                                                                                                                                                                                                        |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: bitmap_union(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: Bitmap([0x48420100070000000000000000010000000000000002000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x48420100070100000000000000020000000000000003000000000000000400000000000000050000000000000006000000000000000700000000000000]), validity: [0b______11] }                                                                                  |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: bitmap_intersect(bm)
evaluation (internal):
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                     |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| bm     | Column(Bitmap([0x484201000500000000000000000100000000000000020000000000000003000000000000000400000000000000, 0x484201000501000000000000000200000000000000030000000000000004000000000000000500000000000000, 0x484201000502000000000000000300000000000000040000000000000005000000000000000600000000000000, 0x484201000503000000000000000400000000000000050000000000000006000000000000000700000000000000])) |
| Output | NullableColumn { column: Bitmap([0x4842010003020000000000000003000000000000000400000000000000, 0x4842010003030000000000000004000000000000000500000000000000]), validity: [0b______11] }                                                                                                                                                                                                                  |
+--------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: group_array_moving_avg(1)
evaluation (internal):
+--------+-----------------------------------------------------------------------+
| Column | Data                                                                  |
+--------+-----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                           |
| Output | ArrayColumn { values: Float64([0.5, 1, 0.5, 1]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------------+


error: AggregateArrayMovingAvgFunction does not support type 'String'

ast: group_array_moving_avg(NULL)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                       |
| Output | ArrayColumn { values: Float64([0, 0, 0, 0]), offsets: [0, 2, 4] } |
+--------+-------------------------------------------------------------------+


ast: group_array_moving_avg(a)
evaluation (internal):
+--------+---------------------------------------------------------------------+
| Column | Data                                                                |
+--------+---------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                         |
| Output | ArrayColumn { values: Float64([2, 3, 1.5, 2]), offsets: [0, 2, 4] } |
+--------+---------------------------------------------------------------------+


ast: group_array_moving_avg(2)(b)
evaluation (internal):
+--------+---------------------------------------------------------------------+
| Column | Data                                                                |
+--------+---------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                        |
| Output | ArrayColumn { values: Float64([0.5, 2, 1, 3]), offsets: [0, 2, 4] } |
+--------+---------------------------------------------------------------------+


ast: group_array_moving_avg(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | ArrayColumn { values: Float64([0.5, 0.5, 1, 1]), offsets: [0, 2, 4] }           |
+--------+---------------------------------------------------------------------------------+


ast: group_array_moving_avg(1)(y_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | ArrayColumn { values: Float64([0, 3, 0, 4]), offsets: [0, 2, 4] }               |
+--------+---------------------------------------------------------------------------------+


ast: group_array_moving_avg(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | ArrayColumn { values: Decimal64([0.5500, 0.5500, 1.1000, 2.7500]), offsets: [0, 2, 4] }        |
+--------+------------------------------------------------------------------------------------------------+


ast: group_array_moving_avg(2)(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | ArrayColumn { values: Decimal64([0.5500, 0.5500, 1.1000, 2.7500]), offsets: [0, 2, 4] }        |
+--------+------------------------------------------------------------------------------------------------+


ast: group_array_moving_sum(1)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | ArrayColumn { values: UInt64([1, 2, 1, 2]), offsets: [0, 2, 4] } |
+--------+------------------------------------------------------------------+


error: AggregateArrayMovingSumFunction does not support type 'String'

ast: group_array_moving_sum(NULL)
evaluation (internal):
+--------+-----------------------------------------------------------------+
| Column | Data                                                            |
+--------+-----------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                     |
| Output | ArrayColumn { values: Int64([0, 0, 0, 0]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------+


ast: group_array_moving_sum(a)
evaluation (internal):
+--------+-----------------------------------------------------------------+
| Column | Data                                                            |
+--------+-----------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                     |
| Output | ArrayColumn { values: Int64([4, 6, 3, 4]), offsets: [0, 2, 4] } |
+--------+-----------------------------------------------------------------+


ast: group_array_moving_sum(2)(b)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                     |
| Output | ArrayColumn { values: UInt64([1, 4, 2, 6]), offsets: [0, 2, 4] } |
+--------+------------------------------------------------------------------+


ast: group_array_moving_sum(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | ArrayColumn { values: UInt64([1, 1, 2, 2]), offsets: [0, 2, 4] }                |
+--------+---------------------------------------------------------------------------------+


ast: group_array_moving_sum(1)(y_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| y_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____1100] }) |
| Output | ArrayColumn { values: UInt64([0, 3, 0, 4]), offsets: [0, 2, 4] }                |
+--------+---------------------------------------------------------------------------------+


ast: group_array_moving_sum(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | ArrayColumn { values: Decimal64([1.10, 1.10, 2.20, 5.50]), offsets: [0, 2, 4] }                |
+--------+------------------------------------------------------------------------------------------------+


ast: group_array_moving_sum(2)(dec)
evaluation (internal):
+--------+------------------------------------------------------------------------------------------------+
| Column | Data                                                                                           |
+--------+------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] }) |
| Output | ArrayColumn { values: Decimal64([1.10, 1.10, 2.20, 5.50]), offsets: [0, 2, 4] }                |
+--------+------------------------------------------------------------------------------------------------+


ast: json_agg(a)
evaluation (internal):
+--------+-----------------------------------------------------------------------+
| Column | Data                                                                  |
+--------+-----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                           |
| Output | Variant([0x80000004200000022000000220000002200000024004400340024001]) |
+--------+-----------------------------------------------------------------------+


ast: json_agg(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | Variant([0x80000002200000022000000250015002])                                   |
+--------+---------------------------------------------------------------------------------+


ast: json_agg(dec)
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                      |
+--------+-----------------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] })            |
| Output | Variant([0x800000032000000a2000000a2000000a70000000000000006e027000000000000000dc0270000000000000014a02]) |
+--------+-----------------------------------------------------------------------------------------------------------+


ast: json_array_agg(1)
evaluation (internal):
+--------+-----------------------------------------------------------------------+
| Column | Data                                                                  |
+--------+-----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                           |
| Output | Variant([0x80000004200000022000000220000002200000025001500150015001]) |
+--------+-----------------------------------------------------------------------+


ast: json_array_agg('a')
evaluation (internal):
+--------+---------------------------------------------------------------+
| Column | Data                                                          |
+--------+---------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                   |
| Output | Variant([0x800000041000000110000001100000011000000161616161]) |
+--------+---------------------------------------------------------------+


ast: json_array_agg(NULL)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | Variant([0x80000000])       |
+--------+-----------------------------+


ast: json_array_agg(a)
evaluation (internal):
+--------+-----------------------------------------------------------------------+
| Column | Data                                                                  |
+--------+-----------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                           |
| Output | Variant([0x80000004200000022000000220000002200000024004400340024001]) |
+--------+-----------------------------------------------------------------------+


ast: json_array_agg(b)
evaluation (internal):
+--------+-----------------------------------------------------------------------+
| Column | Data                                                                  |
+--------+-----------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                          |
| Output | Variant([0x80000004200000022000000220000002200000025001500250035004]) |
+--------+-----------------------------------------------------------------------+


ast: json_array_agg(x_null)
evaluation (internal):
+--------+---------------------------------------------------------------------------------+
| Column | Data                                                                            |
+--------+---------------------------------------------------------------------------------+
| x_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0011] }) |
| Output | Variant([0x80000002200000022000000250015002])                                   |
+--------+---------------------------------------------------------------------------------+


ast: json_array_agg(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | Variant([0x80000000])                                                           |
+----------+---------------------------------------------------------------------------------+


ast: json_array_agg(dt)
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                          |
+--------+-------------------------------------------------------------------------------------------------------------------------------+
| dt     | Column(Timestamp([1, 0, 2, 3]))                                                                                               |
| Output | Variant([0x8000000460000009600000096000000960000009200000000000000001200000000000000000200000000000000002200000000000000003]) |
+--------+-------------------------------------------------------------------------------------------------------------------------------+


ast: json_array_agg(event1)
evaluation (internal):
+--------+-------------------------------------------------------+
| Column | Data                                                  |
+--------+-------------------------------------------------------+
| event1 | Column(Boolean([0b____0001]))                         |
| Output | Variant([0x8000000440000000300000003000000030000000]) |
+--------+-------------------------------------------------------+


ast: json_array_agg(dec)
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                      |
+--------+-----------------------------------------------------------------------------------------------------------+
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] })            |
| Output | Variant([0x800000032000000a2000000a2000000a70000000000000006e027000000000000000dc0270000000000000014a02]) |
+--------+-----------------------------------------------------------------------------------------------------------+


error: Json object have duplicate key 'k'

ast: json_object_agg(s, a)
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                          |
+--------+-------------------------------------------------------------------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                                                                                   |
| s      | Column(StringColumn[abc, def, opq, xyz])                                                                                      |
| Output | Variant([0x4000000410000003100000031000000310000003200000022000000220000002200000026162636465666f707178797a4004400340024001]) |
+--------+-------------------------------------------------------------------------------------------------------------------------------+


ast: json_object_agg(s_null, b)
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------+
| Column | Data                                                                                    |
+--------+-----------------------------------------------------------------------------------------+
| b      | Column(UInt64([1, 2, 3, 4]))                                                            |
| s_null | Column(NullableColumn { column: StringColumn[a, , c, d], validity: [0b____1101] })      |
| Output | Variant([0x40000003100000011000000110000001200000022000000220000002616364500150035004]) |
+--------+-----------------------------------------------------------------------------------------+


error: json_object_agg does not support key type 'Number(Int64)'

ast: json_object_agg(s, dec)
evaluation (internal):
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+
| s      | Column(StringColumn[abc, def, opq, xyz])                                                                                                            |
| dec    | Column(NullableColumn { column: Decimal64([1.10, 2.20, 0.00, 3.30]), validity: [0b____1011] })                                                      |
| Output | Variant([0x400000031000000310000003100000032000000a2000000a2000000a61626364656678797a70000000000000006e027000000000000000dc0270000000000000014a02]) |
+--------+-----------------------------------------------------------------------------------------------------------------------------------------------------+


ast: mode(1)
evaluation (internal):
+--------+------------------------------------------------------------------+
| Column | Data                                                             |
+--------+------------------------------------------------------------------+
| a      | Column(Int64([4, 3, 2, 1]))                                      |
| Output | NullableColumn { column: UInt8([1, 1]), validity: [0b______11] } |
+--------+------------------------------------------------------------------+


ast: mode(NULL)
evaluation (internal):
+--------+-----------------------------+
| Column | Data                        |
+--------+-----------------------------+
| a      | Column(Int64([4, 3, 2, 1])) |
| Output | Null { len: 2 }             |
+--------+-----------------------------+


ast: mode(d)
evaluation (internal):
+--------+-------------------------------------------------------------------+
| Column | Data                                                              |
+--------+-------------------------------------------------------------------+
| d      | Column(UInt64([1, 1, 1, 1]))                                      |
| Output | NullableColumn { column: UInt64([1, 1]), validity: [0b______11] } |
+--------+-------------------------------------------------------------------+


ast: mode(all_null)
evaluation (internal):
+----------+---------------------------------------------------------------------------------+
| Column   | Data                                                                            |
+----------+---------------------------------------------------------------------------------+
| all_null | Column(NullableColumn { column: UInt64([1, 2, 3, 4]), validity: [0b____0000] }) |
| Output   | NullableColumn { column: UInt64([0, 0]), validity: [0b______00] }               |
+----------+---------------------------------------------------------------------------------+


ast: st_collect(to_geometry('point(10 20)'))
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                        |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| point  | Column(StringColumn[POINT(1 1), POINT(2 2), POINT(3 3), POINT(4 4)])                                                                                                                                                                                        |
| Output | NullableColumn { column: Geometry([0x010400000004000000010100000000000000000024400000000000003440010100000000000000000024400000000000003440010100000000000000000024400000000000003440010100000000000000000024400000000000003440]), validity: [0b_______1] } |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry('srid=4326;linestring(10 20, 40 50)'))
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| point  | Column(StringColumn[POINT(1 1), POINT(2 2), POINT(3 3), POINT(4 4)])                                                                                                                                                                                                                                                                                                                                                                |
| Output | NullableColumn { column: Geometry([0x0105000020e6100000040000000102000000020000000000000000002440000000000000344000000000000044400000000000004940010200000002000000000000000000244000000000000034400000000000004440000000000000494001020000000200000000000000000024400000000000003440000000000000444000000000000049400102000000020000000000000000002440000000000000344000000000000044400000000000004940]), validity: [0b_______1] } |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(NULL)
evaluation (internal):
+--------+----------------------------------------------------------------------+
| Column | Data                                                                 |
+--------+----------------------------------------------------------------------+
| point  | Column(StringColumn[POINT(1 1), POINT(2 2), POINT(3 3), POINT(4 4)]) |
| Output | NullableColumn { column: Geometry([0x]), validity: [0b_______0] }    |
+--------+----------------------------------------------------------------------+


ast: st_collect(to_geometry(point))
evaluation (internal):
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column | Data                                                                                                                                                                                                                                                        |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| point  | Column(StringColumn[POINT(1 1), POINT(2 2), POINT(3 3), POINT(4 4)])                                                                                                                                                                                        |
| Output | NullableColumn { column: Geometry([0x0104000000040000000101000000000000000000f03f000000000000f03f010100000000000000000000400000000000000040010100000000000000000008400000000000000840010100000000000000000010400000000000001040]), validity: [0b_______1] } |
+--------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(point_null))
evaluation (internal):
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column     | Data                                                                                                                                                                                                              |
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| point_null | Column(NullableColumn { column: StringColumn[POINT(1 1), , POINT(3 3), POINT(4 4)], validity: [0b____1101] })                                                                                                     |
| Output     | NullableColumn { column: Geometry([0x0104000000030000000101000000000000000000f03f000000000000f03f010100000000000000000008400000000000000840010100000000000000000010400000000000001040]), validity: [0b_______1] } |
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(line_string))
evaluation (internal):
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column      | Data                                                                                                                                                                                                                                                                                                                                                                                                                        |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| line_string | Column(StringColumn[LINESTRING(0 0, 1 1), LINESTRING(1 1, 2 2), LINESTRING(2 2, 3 3), LINESTRING(3 3, 4 4)])                                                                                                                                                                                                                                                                                                                |
| Output      | NullableColumn { column: Geometry([0x01050000000400000001020000000200000000000000000000000000000000000000000000000000f03f000000000000f03f010200000002000000000000000000f03f000000000000f03f0000000000000040000000000000004001020000000200000000000000000000400000000000000040000000000000084000000000000008400102000000020000000000000000000840000000000000084000000000000010400000000000001040]), validity: [0b_______1] } |
+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(line_string_null))
evaluation (internal):
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column           | Data                                                                                                                                                                                                                                                                                                                                      |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| line_string_null | Column(NullableColumn { column: StringColumn[LINESTRING(0 0, 1 1), , LINESTRING(2 2, 3 3), LINESTRING(3 3, 4 4)], validity: [0b____1101] })                                                                                                                                                                                               |
| Output           | NullableColumn { column: Geometry([0x01050000000300000001020000000200000000000000000000000000000000000000000000000000f03f000000000000f03f01020000000200000000000000000000400000000000000040000000000000084000000000000008400102000000020000000000000000000840000000000000084000000000000010400000000000001040]), validity: [0b_______1] } |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(polygon))
evaluation (internal):
+---------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column  | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+---------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| polygon | Column(StringColumn[POLYGON((0 0, 1 0, 1 1, 0 1, 0 0)), POLYGON((1 1, 2 1, 2 2, 1 2, 1 1)), POLYGON((2 2, 3 2, 3 3, 2 3, 2 2)), POLYGON((3 3, 4 3, 4 4, 3 4, 3 3))])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Output  | NullableColumn { column: Geometry([0x0106000000040000000103000000010000000500000000000000000000000000000000000000000000000000f03f0000000000000000000000000000f03f000000000000f03f0000000000000000000000000000f03f0000000000000000000000000000000001030000000100000005000000000000000000f03f000000000000f03f0000000000000040000000000000f03f00000000000000400000000000000040000000000000f03f0000000000000040000000000000f03f000000000000f03f010300000001000000050000000000000000000040000000000000004000000000000008400000000000000040000000000000084000000000000008400000000000000040000000000000084000000000000000400000000000000040010300000001000000050000000000000000000840000000000000084000000000000010400000000000000840000000000000104000000000000010400000000000000840000000000000104000000000000008400000000000000840]), validity: [0b_______1] } |
+---------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(mixed_geom))
evaluation (internal):
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column     | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mixed_geom | Column(StringColumn[POINT(0 0), LINESTRING(1 1, 2 2), POLYGON((2 2, 3 2, 3 3, 2 3, 2 2)), POINT(4 4)])                                                                                                                                                                                                                                                                                                                                              |
| Output     | NullableColumn { column: Geometry([0x010700000004000000010100000000000000000000000000000000000000010200000002000000000000000000f03f000000000000f03f00000000000000400000000000000040010300000001000000050000000000000000000040000000000000004000000000000008400000000000000040000000000000084000000000000008400000000000000040000000000000084000000000000000400000000000000040010100000000000000000010400000000000001040]), validity: [0b_______1] } |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(mixed_geom_null))
evaluation (internal):
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column          | Data                                                                                                                                                                                                                                                                                                                                                              |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mixed_geom_null | Column(NullableColumn { column: StringColumn[POINT(0 0), , POLYGON((2 2, 3 2, 3 3, 2 3, 2 2)), POINT(4 4)], validity: [0b____1101] })                                                                                                                                                                                                                             |
| Output          | NullableColumn { column: Geometry([0x010700000003000000010100000000000000000000000000000000000000010300000001000000050000000000000000000040000000000000004000000000000008400000000000000040000000000000084000000000000008400000000000000040000000000000084000000000000000400000000000000040010100000000000000000010400000000000001040]), validity: [0b_______1] } |
+-----------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(point_4326))
evaluation (internal):
+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column     | Data                                                                                                                                                                                                                                                                |
+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| point_4326 | Column(StringColumn[SRID=4326;POINT(116.3 39.9), SRID=4326;POINT(121.4 31.2), SRID=4326;POINT(113.2 23.1), SRID=4326;POINT(114.1 22.5)])                                                                                                                            |
| Output     | NullableColumn { column: Geometry([0x0104000020e61000000400000001010000003333333333135d403333333333f3434001010000009a99999999595e403333333333333f400101000000cdcccccccc4c5c409a9999999919374001010000006666666666865c400000000000803640]), validity: [0b_______1] } |
+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(line_string_4326))
evaluation (internal):
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column           | Data                                                                                                                                                                                                                                                                                                                                                                                                                                |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| line_string_4326 | Column(StringColumn[SRID=4326;LINESTRING(116.3 39.9, 121.4 31.2), SRID=4326;LINESTRING(121.4 31.2, 113.2 23.1), SRID=4326;LINESTRING(113.2 23.1, 114.1 22.5), SRID=4326;LINESTRING(114.1 22.5, 116.3 39.9)])                                                                                                                                                                                                                        |
| Output           | NullableColumn { column: Geometry([0x0105000020e6100000040000000102000000020000003333333333135d403333333333f343409a99999999595e403333333333333f400102000000020000009a99999999595e403333333333333f40cdcccccccc4c5c409a99999999193740010200000002000000cdcccccccc4c5c409a999999991937406666666666865c4000000000008036400102000000020000006666666666865c4000000000008036403333333333135d403333333333f34340]), validity: [0b_______1] } |
+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(polygon_4326))
evaluation (internal):
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column       | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| polygon_4326 | Column(StringColumn[SRID=4326;POLYGON((116 39, 117 39, 117 40, 116 40, 116 39)), SRID=4326;POLYGON((121 31, 122 31, 122 32, 121 32, 121 31)), SRID=4326;POLYGON((113 23, 114 23, 114 24, 113 24, 113 23)), SRID=4326;POLYGON((114 22, 115 22, 115 23, 114 23, 114 22))])                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Output       | NullableColumn { column: Geometry([0x0106000020e610000004000000010300000001000000050000000000000000005d4000000000008043400000000000405d4000000000008043400000000000405d4000000000000044400000000000005d4000000000000044400000000000005d400000000000804340010300000001000000050000000000000000405e400000000000003f400000000000805e400000000000003f400000000000805e4000000000000040400000000000405e4000000000000040400000000000405e400000000000003f40010300000001000000050000000000000000405c4000000000000037400000000000805c4000000000000037400000000000805c4000000000000038400000000000405c4000000000000038400000000000405c400000000000003740010300000001000000050000000000000000805c4000000000000036400000000000c05c4000000000000036400000000000c05c4000000000000037400000000000805c4000000000000037400000000000805c400000000000003640]), validity: [0b_______1] } |
+--------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


ast: st_collect(to_geometry(mixed_3857))
evaluation (internal):
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Column     | Data                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| mixed_3857 | Column(StringColumn[SRID=3857;POINT(12947889.3 4852834.1), SRID=3857;LINESTRING(13515330.8 3642091.4, 12600089.2 2632873.5), SRID=3857;POLYGON((12700000 2600000, 12800000 2600000, 12800000 2700000, 12700000 2700000, 12700000 2600000)), SRID=3857;POINT(12959772.9 2551529.8)])                                                                                                                                                                         |
| Output     | NullableColumn { column: Geometry([0x0107000020110f00000400000001010000009a99992936b2684166666686188352410102000000020000009a99995948c76941333333b375c94b416666662663086841000000c05416444101030000000100000005000000000000002c3968410000000020d6434100000000006a68410000000020d6434100000000006a68410000000070994441000000002c3968410000000070994441000000002c3968410000000020d643410101000000cdcccc9c03b86841666666e674774341]), validity: [0b_______1] } |
+------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+


error: Incompatible SRID: 4326 and 3857

error: Incompatible SRID: 4326 and 3857


---------- Input ----------
select * from a limit 3 offset 4 format csv
---------- Output ---------
SELECT * FROM a LIMIT 3 OFFSET 4 FORMAT csv
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..15),
        LIMIT(16..21),
        LiteralInteger(22..23),
        OFFSET(24..30),
        LiteralInteger(31..32),
        FORMAT(33..39),
        CSV(40..43),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..15),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Table {
                    span: [
                        Ident(14..15),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "a",
                        quote: None,
                        span: Ident(14..15),
                    },
                    alias: None,
                    travel_point: None,
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [
        Literal {
            span: [
                LiteralInteger(22..23),
            ],
            lit: Integer(
                3,
            ),
        },
    ],
    offset: Some(
        Literal {
            span: [
                LiteralInteger(31..32),
            ],
            lit: Integer(
                4,
            ),
        },
    ),
    format: Some(
        "csv",
    ),
}


---------- Input ----------
select * from customer inner join orders
---------- Output ---------
SELECT * FROM customer INNER JOIN orders
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        INNER(23..28),
        JOIN(29..33),
        Ident(34..40),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                INNER(23..28),
                JOIN(29..33),
                Ident(34..40),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        INNER(23..28),
                        JOIN(29..33),
                    ],
                    join: Join {
                        op: Inner,
                        condition: None,
                        left: Table {
                            span: [
                                Ident(14..22),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                            travel_point: None,
                        },
                        right: Table {
                            span: [
                                Ident(34..40),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from customer cross join orders
---------- Output ---------
SELECT * FROM customer CROSS JOIN orders
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        CROSS(23..28),
        JOIN(29..33),
        Ident(34..40),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                CROSS(23..28),
                JOIN(29..33),
                Ident(34..40),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        CROSS(23..28),
                        JOIN(29..33),
                    ],
                    join: Join {
                        op: CrossJoin,
                        condition: None,
                        left: Table {
                            span: [
                                Ident(14..22),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                            travel_point: None,
                        },
                        right: Table {
                            span: [
                                Ident(34..40),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from customer inner join orders on a = b limit 1
---------- Output ---------
SELECT * FROM customer INNER JOIN orders ON a = b LIMIT 1
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        INNER(23..28),
        JOIN(29..33),
        Ident(34..40),
        ON(41..43),
        Ident(44..45),
        Eq(46..47),
        Ident(48..49),
        LIMIT(50..55),
        LiteralInteger(56..57),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                INNER(23..28),
                JOIN(29..33),
                Ident(34..40),
                ON(41..43),
                Ident(44..45),
                Eq(46..47),
                Ident(48..49),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        INNER(23..28),
                        JOIN(29..33),
                    ],
                    join: Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                span: [
                                    Eq(46..47),
                                ],
                                op: Eq,
                                left: ColumnRef {
                                    span: [
                                        Ident(44..45),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                        span: Ident(44..45),
                                    },
                                },
                                right: ColumnRef {
                                    span: [
                                        Ident(48..49),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "b",
                                        quote: None,
                                        span: Ident(48..49),
                                    },
                                },
                            },
                        ),
                        left: Table {
                            span: [
                                Ident(14..22),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                            travel_point: None,
                        },
                        right: Table {
                            span: [
                                Ident(34..40),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [
        Literal {
            span: [
                LiteralInteger(56..57),
            ],
            lit: Integer(
                1,
            ),
        },
    ],
    offset: None,
    format: None,
}


---------- Input ----------
select * from customer inner join orders on a = b limit 2 offset 3
---------- Output ---------
SELECT * FROM customer INNER JOIN orders ON a = b LIMIT 2 OFFSET 3
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        INNER(23..28),
        JOIN(29..33),
        Ident(34..40),
        ON(41..43),
        Ident(44..45),
        Eq(46..47),
        Ident(48..49),
        LIMIT(50..55),
        LiteralInteger(56..57),
        OFFSET(58..64),
        LiteralInteger(65..66),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                INNER(23..28),
                JOIN(29..33),
                Ident(34..40),
                ON(41..43),
                Ident(44..45),
                Eq(46..47),
                Ident(48..49),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        INNER(23..28),
                        JOIN(29..33),
                    ],
                    join: Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                span: [
                                    Eq(46..47),
                                ],
                                op: Eq,
                                left: ColumnRef {
                                    span: [
                                        Ident(44..45),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                        span: Ident(44..45),
                                    },
                                },
                                right: ColumnRef {
                                    span: [
                                        Ident(48..49),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "b",
                                        quote: None,
                                        span: Ident(48..49),
                                    },
                                },
                            },
                        ),
                        left: Table {
                            span: [
                                Ident(14..22),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                            travel_point: None,
                        },
                        right: Table {
                            span: [
                                Ident(34..40),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [
        Literal {
            span: [
                LiteralInteger(56..57),
            ],
            lit: Integer(
                2,
            ),
        },
    ],
    offset: Some(
        Literal {
            span: [
                LiteralInteger(65..66),
            ],
            lit: Integer(
                3,
            ),
        },
    ),
    format: None,
}


---------- Input ----------
select * from customer natural full join orders
---------- Output ---------
SELECT * FROM customer NATURAL FULL OUTER JOIN orders
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        NATURAL(23..30),
        FULL(31..35),
        JOIN(36..40),
        Ident(41..47),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                NATURAL(23..30),
                FULL(31..35),
                JOIN(36..40),
                Ident(41..47),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        NATURAL(23..30),
                        FULL(31..35),
                        JOIN(36..40),
                    ],
                    join: Join {
                        op: FullOuter,
                        condition: Natural,
                        left: Table {
                            span: [
                                Ident(14..22),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                            travel_point: None,
                        },
                        right: Table {
                            span: [
                                Ident(41..47),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(41..47),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from customer natural join orders left outer join detail using (id)
---------- Output ---------
SELECT * FROM customer NATURAL INNER JOIN orders LEFT OUTER JOIN detail USING(id)
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        NATURAL(23..30),
        JOIN(31..35),
        Ident(36..42),
        LEFT(43..47),
        OUTER(48..53),
        JOIN(54..58),
        Ident(59..65),
        USING(66..71),
        LParen(72..73),
        Ident(73..75),
        RParen(75..76),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                NATURAL(23..30),
                JOIN(31..35),
                Ident(36..42),
                LEFT(43..47),
                OUTER(48..53),
                JOIN(54..58),
                Ident(59..65),
                USING(66..71),
                LParen(72..73),
                Ident(73..75),
                RParen(75..76),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: [
                Join {
                    span: [
                        LEFT(43..47),
                        OUTER(48..53),
                        JOIN(54..58),
                    ],
                    join: Join {
                        op: LeftOuter,
                        condition: Using(
                            [
                                Identifier {
                                    name: "id",
                                    quote: None,
                                    span: Ident(73..75),
                                },
                            ],
                        ),
                        left: Join {
                            span: [
                                NATURAL(23..30),
                                JOIN(31..35),
                            ],
                            join: Join {
                                op: Inner,
                                condition: Natural,
                                left: Table {
                                    span: [
                                        Ident(14..22),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "customer",
                                        quote: None,
                                        span: Ident(14..22),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                                right: Table {
                                    span: [
                                        Ident(36..42),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "orders",
                                        quote: None,
                                        span: Ident(36..42),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            },
                        },
                        right: Table {
                            span: [
                                Ident(59..65),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "detail",
                                quote: None,
                                span: Ident(59..65),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    },
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
with t2(tt) as (select a from t) select t2.tt from t2  where t2.tt > 1
---------- Output ---------
WITH t2(tt) AS (SELECT a FROM t) SELECT t2.tt FROM t2 WHERE t2.tt > 1
---------- AST ------------
Query {
    span: [
        WITH(0..4),
        Ident(5..7),
        LParen(7..8),
        Ident(8..10),
        RParen(10..11),
        AS(12..14),
        LParen(15..16),
        SELECT(16..22),
        Ident(23..24),
        FROM(25..29),
        Ident(30..31),
        RParen(31..32),
        SELECT(33..39),
        Ident(40..42),
        Period(42..43),
        Ident(43..45),
        FROM(46..50),
        Ident(51..53),
        WHERE(55..60),
        Ident(61..63),
        Period(63..64),
        Ident(64..66),
        Gt(67..68),
        LiteralInteger(69..70),
    ],
    with: Some(
        With {
            span: [
                WITH(0..4),
                Ident(5..7),
                LParen(7..8),
                Ident(8..10),
                RParen(10..11),
                AS(12..14),
                LParen(15..16),
                SELECT(16..22),
                Ident(23..24),
                FROM(25..29),
                Ident(30..31),
                RParen(31..32),
            ],
            recursive: false,
            ctes: [
                CTE {
                    span: [
                        Ident(5..7),
                        LParen(7..8),
                        Ident(8..10),
                        RParen(10..11),
                        AS(12..14),
                        LParen(15..16),
                        SELECT(16..22),
                        Ident(23..24),
                        FROM(25..29),
                        Ident(30..31),
                        RParen(31..32),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t2",
                            quote: None,
                            span: Ident(5..7),
                        },
                        columns: [
                            Identifier {
                                name: "tt",
                                quote: None,
                                span: Ident(8..10),
                            },
                        ],
                    },
                    query: Query {
                        span: [
                            SELECT(16..22),
                            Ident(23..24),
                            FROM(25..29),
                            Ident(30..31),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(16..22),
                                    Ident(23..24),
                                    FROM(25..29),
                                    Ident(30..31),
                                ],
                                distinct: false,
                                select_list: [
                                    AliasedExpr {
                                        expr: ColumnRef {
                                            span: [
                                                Ident(23..24),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "a",
                                                quote: None,
                                                span: Ident(23..24),
                                            },
                                        },
                                        alias: None,
                                    },
                                ],
                                from: [
                                    Table {
                                        span: [
                                            Ident(30..31),
                                        ],
                                        catalog: None,
                                        database: None,
                                        table: Identifier {
                                            name: "t",
                                            quote: None,
                                            span: Ident(30..31),
                                        },
                                        alias: None,
                                        travel_point: None,
                                    },
                                ],
                                selection: None,
                                group_by: [],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
            ],
        },
    ),
    body: Select(
        SelectStmt {
            span: [
                SELECT(33..39),
                Ident(40..42),
                Period(42..43),
                Ident(43..45),
                FROM(46..50),
                Ident(51..53),
                WHERE(55..60),
                Ident(61..63),
                Period(63..64),
                Ident(64..66),
                Gt(67..68),
                LiteralInteger(69..70),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(40..42),
                            Period(42..43),
                            Ident(43..45),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(40..42),
                            },
                        ),
                        column: Identifier {
                            name: "tt",
                            quote: None,
                            span: Ident(43..45),
                        },
                    },
                    alias: None,
                },
            ],
            from: [
                Table {
                    span: [
                        Ident(51..53),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t2",
                        quote: None,
                        span: Ident(51..53),
                    },
                    alias: None,
                    travel_point: None,
                },
            ],
            selection: Some(
                BinaryOp {
                    span: [
                        Gt(67..68),
                    ],
                    op: Gt,
                    left: ColumnRef {
                        span: [
                            Ident(61..63),
                            Period(63..64),
                            Ident(64..66),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(61..63),
                            },
                        ),
                        column: Identifier {
                            name: "tt",
                            quote: None,
                            span: Ident(64..66),
                        },
                    },
                    right: Literal {
                        span: [
                            LiteralInteger(69..70),
                        ],
                        lit: Integer(
                            1,
                        ),
                    },
                },
            ),
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
with t2 as (select a from t) select t2.a from t2  where t2.a > 1
---------- Output ---------
WITH t2 AS (SELECT a FROM t) SELECT t2.a FROM t2 WHERE t2.a > 1
---------- AST ------------
Query {
    span: [
        WITH(0..4),
        Ident(5..7),
        AS(8..10),
        LParen(11..12),
        SELECT(12..18),
        Ident(19..20),
        FROM(21..25),
        Ident(26..27),
        RParen(27..28),
        SELECT(29..35),
        Ident(36..38),
        Period(38..39),
        Ident(39..40),
        FROM(41..45),
        Ident(46..48),
        WHERE(50..55),
        Ident(56..58),
        Period(58..59),
        Ident(59..60),
        Gt(61..62),
        LiteralInteger(63..64),
    ],
    with: Some(
        With {
            span: [
                WITH(0..4),
                Ident(5..7),
                AS(8..10),
                LParen(11..12),
                SELECT(12..18),
                Ident(19..20),
                FROM(21..25),
                Ident(26..27),
                RParen(27..28),
            ],
            recursive: false,
            ctes: [
                CTE {
                    span: [
                        Ident(5..7),
                        AS(8..10),
                        LParen(11..12),
                        SELECT(12..18),
                        Ident(19..20),
                        FROM(21..25),
                        Ident(26..27),
                        RParen(27..28),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t2",
                            quote: None,
                            span: Ident(5..7),
                        },
                        columns: [],
                    },
                    query: Query {
                        span: [
                            SELECT(12..18),
                            Ident(19..20),
                            FROM(21..25),
                            Ident(26..27),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(12..18),
                                    Ident(19..20),
                                    FROM(21..25),
                                    Ident(26..27),
                                ],
                                distinct: false,
                                select_list: [
                                    AliasedExpr {
                                        expr: ColumnRef {
                                            span: [
                                                Ident(19..20),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "a",
                                                quote: None,
                                                span: Ident(19..20),
                                            },
                                        },
                                        alias: None,
                                    },
                                ],
                                from: [
                                    Table {
                                        span: [
                                            Ident(26..27),
                                        ],
                                        catalog: None,
                                        database: None,
                                        table: Identifier {
                                            name: "t",
                                            quote: None,
                                            span: Ident(26..27),
                                        },
                                        alias: None,
                                        travel_point: None,
                                    },
                                ],
                                selection: None,
                                group_by: [],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
            ],
        },
    ),
    body: Select(
        SelectStmt {
            span: [
                SELECT(29..35),
                Ident(36..38),
                Period(38..39),
                Ident(39..40),
                FROM(41..45),
                Ident(46..48),
                WHERE(50..55),
                Ident(56..58),
                Period(58..59),
                Ident(59..60),
                Gt(61..62),
                LiteralInteger(63..64),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(36..38),
                            Period(38..39),
                            Ident(39..40),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(36..38),
                            },
                        ),
                        column: Identifier {
                            name: "a",
                            quote: None,
                            span: Ident(39..40),
                        },
                    },
                    alias: None,
                },
            ],
            from: [
                Table {
                    span: [
                        Ident(46..48),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t2",
                        quote: None,
                        span: Ident(46..48),
                    },
                    alias: None,
                    travel_point: None,
                },
            ],
            selection: Some(
                BinaryOp {
                    span: [
                        Gt(61..62),
                    ],
                    op: Gt,
                    left: ColumnRef {
                        span: [
                            Ident(56..58),
                            Period(58..59),
                            Ident(59..60),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(56..58),
                            },
                        ),
                        column: Identifier {
                            name: "a",
                            quote: None,
                            span: Ident(59..60),
                        },
                    },
                    right: Literal {
                        span: [
                            LiteralInteger(63..64),
                        ],
                        lit: Integer(
                            1,
                        ),
                    },
                },
            ),
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
with t2(tt) as (select a from t), t3 as (select * from t), t4 as (select a from t where a > 1) select t2.tt, t3.a, t4.a from t2, t3, t4 where t2.tt > 1
---------- Output ---------
WITH t2(tt) AS (SELECT a FROM t), t3 AS (SELECT * FROM t), t4 AS (SELECT a FROM t WHERE a > 1) SELECT t2.tt, t3.a, t4.a FROM t2, t3, t4 WHERE t2.tt > 1
---------- AST ------------
Query {
    span: [
        WITH(0..4),
        Ident(5..7),
        LParen(7..8),
        Ident(8..10),
        RParen(10..11),
        AS(12..14),
        LParen(15..16),
        SELECT(16..22),
        Ident(23..24),
        FROM(25..29),
        Ident(30..31),
        RParen(31..32),
        Comma(32..33),
        Ident(34..36),
        AS(37..39),
        LParen(40..41),
        SELECT(41..47),
        Multiply(48..49),
        FROM(50..54),
        Ident(55..56),
        RParen(56..57),
        Comma(57..58),
        Ident(59..61),
        AS(62..64),
        LParen(65..66),
        SELECT(66..72),
        Ident(73..74),
        FROM(75..79),
        Ident(80..81),
        WHERE(82..87),
        Ident(88..89),
        Gt(90..91),
        LiteralInteger(92..93),
        RParen(93..94),
        SELECT(95..101),
        Ident(102..104),
        Period(104..105),
        Ident(105..107),
        Comma(107..108),
        Ident(109..111),
        Period(111..112),
        Ident(112..113),
        Comma(113..114),
        Ident(115..117),
        Period(117..118),
        Ident(118..119),
        FROM(120..124),
        Ident(125..127),
        Comma(127..128),
        Ident(129..131),
        Comma(131..132),
        Ident(133..135),
        WHERE(136..141),
        Ident(142..144),
        Period(144..145),
        Ident(145..147),
        Gt(148..149),
        LiteralInteger(150..151),
    ],
    with: Some(
        With {
            span: [
                WITH(0..4),
                Ident(5..7),
                LParen(7..8),
                Ident(8..10),
                RParen(10..11),
                AS(12..14),
                LParen(15..16),
                SELECT(16..22),
                Ident(23..24),
                FROM(25..29),
                Ident(30..31),
                RParen(31..32),
                Comma(32..33),
                Ident(34..36),
                AS(37..39),
                LParen(40..41),
                SELECT(41..47),
                Multiply(48..49),
                FROM(50..54),
                Ident(55..56),
                RParen(56..57),
                Comma(57..58),
                Ident(59..61),
                AS(62..64),
                LParen(65..66),
                SELECT(66..72),
                Ident(73..74),
                FROM(75..79),
                Ident(80..81),
                WHERE(82..87),
                Ident(88..89),
                Gt(90..91),
                LiteralInteger(92..93),
                RParen(93..94),
            ],
            recursive: false,
            ctes: [
                CTE {
                    span: [
                        Ident(5..7),
                        LParen(7..8),
                        Ident(8..10),
                        RParen(10..11),
                        AS(12..14),
                        LParen(15..16),
                        SELECT(16..22),
                        Ident(23..24),
                        FROM(25..29),
                        Ident(30..31),
                        RParen(31..32),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t2",
                            quote: None,
                            span: Ident(5..7),
                        },
                        columns: [
                            Identifier {
                                name: "tt",
                                quote: None,
                                span: Ident(8..10),
                            },
                        ],
                    },
                    query: Query {
                        span: [
                            SELECT(16..22),
                            Ident(23..24),
                            FROM(25..29),
                            Ident(30..31),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(16..22),
                                    Ident(23..24),
                                    FROM(25..29),
                                    Ident(30..31),
                                ],
                                distinct: false,
                                select_list: [
                                    AliasedExpr {
                                        expr: ColumnRef {
                                            span: [
                                                Ident(23..24),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "a",
                                                quote: None,
                                                span: Ident(23..24),
                                            },
                                        },
                                        alias: None,
                                    },
                                ],
                                from: [
                                    Table {
                                        span: [
                                            Ident(30..31),
                                        ],
                                        catalog: None,
                                        database: None,
                                        table: Identifier {
                                            name: "t",
                                            quote: None,
                                            span: Ident(30..31),
                                        },
                                        alias: None,
                                        travel_point: None,
                                    },
                                ],
                                selection: None,
                                group_by: [],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
                CTE {
                    span: [
                        Ident(34..36),
                        AS(37..39),
                        LParen(40..41),
                        SELECT(41..47),
                        Multiply(48..49),
                        FROM(50..54),
                        Ident(55..56),
                        RParen(56..57),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t3",
                            quote: None,
                            span: Ident(34..36),
                        },
                        columns: [],
                    },
                    query: Query {
                        span: [
                            SELECT(41..47),
                            Multiply(48..49),
                            FROM(50..54),
                            Ident(55..56),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(41..47),
                                    Multiply(48..49),
                                    FROM(50..54),
                                    Ident(55..56),
                                ],
                                distinct: false,
                                select_list: [
                                    QualifiedName(
                                        [
                                            Star,
                                        ],
                                    ),
                                ],
                                from: [
                                    Table {
                                        span: [
                                            Ident(55..56),
                                        ],
                                        catalog: None,
                                        database: None,
                                        table: Identifier {
                                            name: "t",
                                            quote: None,
                                            span: Ident(55..56),
                                        },
                                        alias: None,
                                        travel_point: None,
                                    },
                                ],
                                selection: None,
                                group_by: [],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
                CTE {
                    span: [
                        Ident(59..61),
                        AS(62..64),
                        LParen(65..66),
                        SELECT(66..72),
                        Ident(73..74),
                        FROM(75..79),
                        Ident(80..81),
                        WHERE(82..87),
                        Ident(88..89),
                        Gt(90..91),
                        LiteralInteger(92..93),
                        RParen(93..94),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t4",
                            quote: None,
                            span: Ident(59..61),
                        },
                        columns: [],
                    },
                    query: Query {
                        span: [
                            SELECT(66..72),
                            Ident(73..74),
                            FROM(75..79),
                            Ident(80..81),
                            WHERE(82..87),
                            Ident(88..89),
                            Gt(90..91),
                            LiteralInteger(92..93),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(66..72),
                                    Ident(73..74),
                                    FROM(75..79),
                                    Ident(80..81),
                                    WHERE(82..87),
                                    Ident(88..89),
                                    Gt(90..91),
                                    LiteralInteger(92..93),
                                ],
                                distinct: false,
                                select_list: [
                                    AliasedExpr {
                                        expr: ColumnRef {
                                            span: [
                                                Ident(73..74),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "a",
                                                quote: None,
                                                span: Ident(73..74),
                                            },
                                        },
                                        alias: None,
                                    },
                                ],
                                from: [
                                    Table {
                                        span: [
                                            Ident(80..81),
                                        ],
                                        catalog: None,
                                        database: None,
                                        table: Identifier {
                                            name: "t",
                                            quote: None,
                                            span: Ident(80..81),
                                        },
                                        alias: None,
                                        travel_point: None,
                                    },
                                ],
                                selection: Some(
                                    BinaryOp {
                                        span: [
                                            Gt(90..91),
                                        ],
                                        op: Gt,
                                        left: ColumnRef {
                                            span: [
                                                Ident(88..89),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "a",
                                                quote: None,
                                                span: Ident(88..89),
                                            },
                                        },
                                        right: Literal {
                                            span: [
                                                LiteralInteger(92..93),
                                            ],
                                            lit: Integer(
                                                1,
                                            ),
                                        },
                                    },
                                ),
                                group_by: [],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
            ],
        },
    ),
    body: Select(
        SelectStmt {
            span: [
                SELECT(95..101),
                Ident(102..104),
                Period(104..105),
                Ident(105..107),
                Comma(107..108),
                Ident(109..111),
                Period(111..112),
                Ident(112..113),
                Comma(113..114),
                Ident(115..117),
                Period(117..118),
                Ident(118..119),
                FROM(120..124),
                Ident(125..127),
                Comma(127..128),
                Ident(129..131),
                Comma(131..132),
                Ident(133..135),
                WHERE(136..141),
                Ident(142..144),
                Period(144..145),
                Ident(145..147),
                Gt(148..149),
                LiteralInteger(150..151),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(102..104),
                            Period(104..105),
                            Ident(105..107),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(102..104),
                            },
                        ),
                        column: Identifier {
                            name: "tt",
                            quote: None,
                            span: Ident(105..107),
                        },
                    },
                    alias: None,
                },
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(109..111),
                            Period(111..112),
                            Ident(112..113),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t3",
                                quote: None,
                                span: Ident(109..111),
                            },
                        ),
                        column: Identifier {
                            name: "a",
                            quote: None,
                            span: Ident(112..113),
                        },
                    },
                    alias: None,
                },
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(115..117),
                            Period(117..118),
                            Ident(118..119),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t4",
                                quote: None,
                                span: Ident(115..117),
                            },
                        ),
                        column: Identifier {
                            name: "a",
                            quote: None,
                            span: Ident(118..119),
                        },
                    },
                    alias: None,
                },
            ],
            from: [
                Table {
                    span: [
                        Ident(125..127),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t2",
                        quote: None,
                        span: Ident(125..127),
                    },
                    alias: None,
                    travel_point: None,
                },
                Table {
                    span: [
                        Ident(129..131),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t3",
                        quote: None,
                        span: Ident(129..131),
                    },
                    alias: None,
                    travel_point: None,
                },
                Table {
                    span: [
                        Ident(133..135),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t4",
                        quote: None,
                        span: Ident(133..135),
                    },
                    alias: None,
                    travel_point: None,
                },
            ],
            selection: Some(
                BinaryOp {
                    span: [
                        Gt(148..149),
                    ],
                    op: Gt,
                    left: ColumnRef {
                        span: [
                            Ident(142..144),
                            Period(144..145),
                            Ident(145..147),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(142..144),
                            },
                        ),
                        column: Identifier {
                            name: "tt",
                            quote: None,
                            span: Ident(145..147),
                        },
                    },
                    right: Literal {
                        span: [
                            LiteralInteger(150..151),
                        ],
                        lit: Integer(
                            1,
                        ),
                    },
                },
            ),
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
with recursive t2(tt) as (select a from t1 union select tt from t2) select t2.tt from t2
---------- Output ---------
WITH RECURSIVE t2(tt) AS (SELECT a FROM t1 UNION SELECT tt FROM t2) SELECT t2.tt FROM t2
---------- AST ------------
Query {
    span: [
        WITH(0..4),
        RECURSIVE(5..14),
        Ident(15..17),
        LParen(17..18),
        Ident(18..20),
        RParen(20..21),
        AS(22..24),
        LParen(25..26),
        SELECT(26..32),
        Ident(33..34),
        FROM(35..39),
        Ident(40..42),
        UNION(43..48),
        SELECT(49..55),
        Ident(56..58),
        FROM(59..63),
        Ident(64..66),
        RParen(66..67),
        SELECT(68..74),
        Ident(75..77),
        Period(77..78),
        Ident(78..80),
        FROM(81..85),
        Ident(86..88),
    ],
    with: Some(
        With {
            span: [
                WITH(0..4),
                RECURSIVE(5..14),
                Ident(15..17),
                LParen(17..18),
                Ident(18..20),
                RParen(20..21),
                AS(22..24),
                LParen(25..26),
                SELECT(26..32),
                Ident(33..34),
                FROM(35..39),
                Ident(40..42),
                UNION(43..48),
                SELECT(49..55),
                Ident(56..58),
                FROM(59..63),
                Ident(64..66),
                RParen(66..67),
            ],
            recursive: true,
            ctes: [
                CTE {
                    span: [
                        Ident(15..17),
                        LParen(17..18),
                        Ident(18..20),
                        RParen(20..21),
                        AS(22..24),
                        LParen(25..26),
                        SELECT(26..32),
                        Ident(33..34),
                        FROM(35..39),
                        Ident(40..42),
                        UNION(43..48),
                        SELECT(49..55),
                        Ident(56..58),
                        FROM(59..63),
                        Ident(64..66),
                        RParen(66..67),
                    ],
                    alias: TableAlias {
                        name: Identifier {
                            name: "t2",
                            quote: None,
                            span: Ident(15..17),
                        },
                        columns: [
                            Identifier {
                                name: "tt",
                                quote: None,
                                span: Ident(18..20),
                            },
                        ],
                    },
                    query: Query {
                        span: [
                            SELECT(26..32),
                            Ident(33..34),
                            FROM(35..39),
                            Ident(40..42),
                            UNION(43..48),
                            SELECT(49..55),
                            Ident(56..58),
                            FROM(59..63),
                            Ident(64..66),
                        ],
                        with: None,
                        body: SetOperation(
                            SetOperation {
                                span: [
                                    UNION(43..48),
                                ],
                                op: Union,
                                all: false,
                                left: Select(
                                    SelectStmt {
                                        span: [
                                            SELECT(26..32),
                                            Ident(33..34),
                                            FROM(35..39),
                                            Ident(40..42),
                                        ],
                                        distinct: false,
                                        select_list: [
                                            AliasedExpr {
                                                expr: ColumnRef {
                                                    span: [
                                                        Ident(33..34),
                                                    ],
                                                    database: None,
                                                    table: None,
                                                    column: Identifier {
                                                        name: "a",
                                                        quote: None,
                                                        span: Ident(33..34),
                                                    },
                                                },
                                                alias: None,
                                            },
                                        ],
                                        from: [
                                            Table {
                                                span: [
                                                    Ident(40..42),
                                                ],
                                                catalog: None,
                                                database: None,
                                                table: Identifier {
                                                    name: "t1",
                                                    quote: None,
                                                    span: Ident(40..42),
                                                },
                                                alias: None,
                                                travel_point: None,
                                            },
                                        ],
                                        selection: None,
                                        group_by: [],
                                        having: None,
                                    },
                                ),
                                right: Select(
                                    SelectStmt {
                                        span: [
                                            SELECT(49..55),
                                            Ident(56..58),
                                            FROM(59..63),
                                            Ident(64..66),
                                        ],
                                        distinct: false,
                                        select_list: [
                                            AliasedExpr {
                                                expr: ColumnRef {
                                                    span: [
                                                        Ident(56..58),
                                                    ],
                                                    database: None,
                                                    table: None,
                                                    column: Identifier {
                                                        name: "tt",
                                                        quote: None,
                                                        span: Ident(56..58),
                                                    },
                                                },
                                                alias: None,
                                            },
                                        ],
                                        from: [
                                            Table {
                                                span: [
                                                    Ident(64..66),
                                                ],
                                                catalog: None,
                                                database: None,
                                                table: Identifier {
                                                    name: "t2",
                                                    quote: None,
                                                    span: Ident(64..66),
                                                },
                                                alias: None,
                                                travel_point: None,
                                            },
                                        ],
                                        selection: None,
                                        group_by: [],
                                        having: None,
                                    },
                                ),
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                },
            ],
        },
    ),
    body: Select(
        SelectStmt {
            span: [
                SELECT(68..74),
                Ident(75..77),
                Period(77..78),
                Ident(78..80),
                FROM(81..85),
                Ident(86..88),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(75..77),
                            Period(77..78),
                            Ident(78..80),
                        ],
                        database: None,
                        table: Some(
                            Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(75..77),
                            },
                        ),
                        column: Identifier {
                            name: "tt",
                            quote: None,
                            span: Ident(78..80),
                        },
                    },
                    alias: None,
                },
            ],
            from: [
                Table {
                    span: [
                        Ident(86..88),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "t2",
                        quote: None,
                        span: Ident(86..88),
                    },
                    alias: None,
                    travel_point: None,
                },
            ],
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select c_count cc, count(*) as custdist, sum(c_acctbal) as totacctbal
            from customer, orders ODS,
                (
                    select
                        c_custkey,
                        count(o_orderkey)
                    from
                        customer left outer join orders on
                            c_custkey = o_custkey
                            and o_comment not like '%:1%:2%'
                    group by
                        c_custkey
                ) as c_orders
            group by c_count
            order by custdist desc nulls first, c_count asc, totacctbal nulls last
            limit 10, totacctbal
---------- Output ---------
SELECT c_count AS cc, COUNT(*) AS custdist, sum(c_acctbal) AS totacctbal FROM customer, orders AS ODS, (SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%:1%:2%' GROUP BY c_custkey) AS c_orders GROUP BY c_count ORDER BY custdist DESC NULLS FIRST, c_count ASC, totacctbal NULLS LAST LIMIT 10, totacctbal
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Ident(7..14),
        Ident(15..17),
        Comma(17..18),
        COUNT(19..24),
        LParen(24..25),
        Multiply(25..26),
        RParen(26..27),
        AS(28..30),
        Ident(31..39),
        Comma(39..40),
        Ident(41..44),
        LParen(44..45),
        Ident(45..54),
        RParen(54..55),
        AS(56..58),
        Ident(59..69),
        FROM(82..86),
        Ident(87..95),
        Comma(95..96),
        Ident(97..103),
        Ident(104..107),
        Comma(107..108),
        LParen(125..126),
        SELECT(147..153),
        Ident(178..187),
        Comma(187..188),
        COUNT(213..218),
        LParen(218..219),
        Ident(219..229),
        RParen(229..230),
        FROM(251..255),
        Ident(280..288),
        LEFT(289..293),
        OUTER(294..299),
        JOIN(300..304),
        Ident(305..311),
        ON(312..314),
        Ident(343..352),
        Eq(353..354),
        Ident(355..364),
        AND(393..396),
        Ident(397..406),
        NOT(407..410),
        LIKE(411..415),
        QuotedString(416..425),
        GROUP(446..451),
        BY(452..454),
        Ident(479..488),
        RParen(505..506),
        AS(507..509),
        Ident(510..518),
        GROUP(531..536),
        BY(537..539),
        Ident(540..547),
        ORDER(560..565),
        BY(566..568),
        Ident(569..577),
        DESC(578..582),
        NULLS(583..588),
        FIRST(589..594),
        Comma(594..595),
        Ident(596..603),
        ASC(604..607),
        Comma(607..608),
        Ident(609..619),
        NULLS(620..625),
        LAST(626..630),
        LIMIT(643..648),
        LiteralInteger(649..651),
        Comma(651..652),
        Ident(653..663),
    ],
    with: None,
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Ident(7..14),
                Ident(15..17),
                Comma(17..18),
                COUNT(19..24),
                LParen(24..25),
                Multiply(25..26),
                RParen(26..27),
                AS(28..30),
                Ident(31..39),
                Comma(39..40),
                Ident(41..44),
                LParen(44..45),
                Ident(45..54),
                RParen(54..55),
                AS(56..58),
                Ident(59..69),
                FROM(82..86),
                Ident(87..95),
                Comma(95..96),
                Ident(97..103),
                Ident(104..107),
                Comma(107..108),
                LParen(125..126),
                SELECT(147..153),
                Ident(178..187),
                Comma(187..188),
                COUNT(213..218),
                LParen(218..219),
                Ident(219..229),
                RParen(229..230),
                FROM(251..255),
                Ident(280..288),
                LEFT(289..293),
                OUTER(294..299),
                JOIN(300..304),
                Ident(305..311),
                ON(312..314),
                Ident(343..352),
                Eq(353..354),
                Ident(355..364),
                AND(393..396),
                Ident(397..406),
                NOT(407..410),
                LIKE(411..415),
                QuotedString(416..425),
                GROUP(446..451),
                BY(452..454),
                Ident(479..488),
                RParen(505..506),
                AS(507..509),
                Ident(510..518),
                GROUP(531..536),
                BY(537..539),
                Ident(540..547),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(7..14),
                        ],
                        database: None,
                        table: None,
                        column: Identifier {
                            name: "c_count",
                            quote: None,
                            span: Ident(7..14),
                        },
                    },
                    alias: Some(
                        Identifier {
                            name: "cc",
                            quote: None,
                            span: Ident(15..17),
                        },
                    ),
                },
                AliasedExpr {
                    expr: CountAll {
                        span: [
                            COUNT(19..24),
                            LParen(24..25),
                            Multiply(25..26),
                            RParen(26..27),
                        ],
                    },
                    alias: Some(
                        Identifier {
                            name: "custdist",
                            quote: None,
                            span: Ident(31..39),
                        },
                    ),
                },
                AliasedExpr {
                    expr: FunctionCall {
                        span: [
                            Ident(41..44),
                            LParen(44..45),
                            Ident(45..54),
                            RParen(54..55),
                        ],
                        distinct: false,
                        name: Identifier {
                            name: "sum",
                            quote: None,
                            span: Ident(41..44),
                        },
                        args: [
                            ColumnRef {
                                span: [
                                    Ident(45..54),
                                ],
                                database: None,
                                table: None,
                                column: Identifier {
                                    name: "c_acctbal",
                                    quote: None,
                                    span: Ident(45..54),
                                },
                            },
                        ],
                        params: [],
                    },
                    alias: Some(
                        Identifier {
                            name: "totacctbal",
                            quote: None,
                            span: Ident(59..69),
                        },
                    ),
                },
            ],
            from: [
                Table {
                    span: [
                        Ident(87..95),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "customer",
                        quote: None,
                        span: Ident(87..95),
                    },
                    alias: None,
                    travel_point: None,
                },
                Table {
                    span: [
                        Ident(97..103),
                        Ident(104..107),
                    ],
                    catalog: None,
                    database: None,
                    table: Identifier {
                        name: "orders",
                        quote: None,
                        span: Ident(97..103),
                    },
                    alias: Some(
                        TableAlias {
                            name: Identifier {
                                name: "ODS",
                                quote: None,
                                span: Ident(104..107),
                            },
                            columns: [],
                        },
                    ),
                    travel_point: None,
                },
                Subquery {
                    span: [
                        LParen(125..126),
                        SELECT(147..153),
                        Ident(178..187),
                        Comma(187..188),
                        COUNT(213..218),
                        LParen(218..219),
                        Ident(219..229),
                        RParen(229..230),
                        FROM(251..255),
                        Ident(280..288),
                        LEFT(289..293),
                        OUTER(294..299),
                        JOIN(300..304),
                        Ident(305..311),
                        ON(312..314),
                        Ident(343..352),
                        Eq(353..354),
                        Ident(355..364),
                        AND(393..396),
                        Ident(397..406),
                        NOT(407..410),
                        LIKE(411..415),
                        QuotedString(416..425),
                        GROUP(446..451),
                        BY(452..454),
                        Ident(479..488),
                        RParen(505..506),
                        AS(507..509),
                        Ident(510..518),
                    ],
                    subquery: Query {
                        span: [
                            SELECT(147..153),
                            Ident(178..187),
                            Comma(187..188),
                            COUNT(213..218),
                            LParen(218..219),
                            Ident(219..229),
                            RParen(229..230),
                            FROM(251..255),
                            Ident(280..288),
                            LEFT(289..293),
                            OUTER(294..299),
                            JOIN(300..304),
                            Ident(305..311),
                            ON(312..314),
                            Ident(343..352),
                            Eq(353..354),
                            Ident(355..364),
                            AND(393..396),
                            Ident(397..406),
                            NOT(407..410),
                            LIKE(411..415),
                            QuotedString(416..425),
                            GROUP(446..451),
                            BY(452..454),
                            Ident(479..488),
                        ],
                        with: None,
                        body: Select(
                            SelectStmt {
                                span: [
                                    SELECT(147..153),
                                    Ident(178..187),
                                    Comma(187..188),
                                    COUNT(213..218),
                                    LParen(218..219),
                                    Ident(219..229),
                                    RParen(229..230),
                                    FROM(251..255),
                                    Ident(280..288),
                                    LEFT(289..293),
                                    OUTER(294..299),
                                    JOIN(300..304),
                                    Ident(305..311),
                                    ON(312..314),
                                    Ident(343..352),
                                    Eq(353..354),
                                    Ident(355..364),
                                    AND(393..396),
                                    Ident(397..406),
                                    NOT(407..410),
                                    LIKE(411..415),
                                    QuotedString(416..425),
                                    GROUP(446..451),
                                    BY(452..454),
                                    Ident(479..488),
                                ],
                                distinct: false,
                                select_list: [
                                    AliasedExpr {
                                        expr: ColumnRef {
                                            span: [
                                                Ident(178..187),
                                            ],
                                            database: None,
                                            table: None,
                                            column: Identifier {
                                                name: "c_custkey",
                                                quote: None,
                                                span: Ident(178..187),
                                            },
                                        },
                                        alias: None,
                                    },
                                    AliasedExpr {
                                        expr: FunctionCall {
                                            span: [
                                                COUNT(213..218),
                                                LParen(218..219),
                                                Ident(219..229),
                                                RParen(229..230),
                                            ],
                                            distinct: false,
                                            name: Identifier {
                                                name: "count",
                                                quote: None,
                                                span: COUNT(213..218),
                                            },
                                            args: [
                                                ColumnRef {
                                                    span: [
                                                        Ident(219..229),
                                                    ],
                                                    database: None,
                                                    table: None,
                                                    column: Identifier {
                                                        name: "o_orderkey",
                                                        quote: None,
                                                        span: Ident(219..229),
                                                    },
                                                },
                                            ],
                                            params: [],
                                        },
                                        alias: None,
                                    },
                                ],
                                from: [
                                    Join {
                                        span: [
                                            LEFT(289..293),
                                            OUTER(294..299),
                                            JOIN(300..304),
                                        ],
                                        join: Join {
                                            op: LeftOuter,
                                            condition: On(
                                                BinaryOp {
                                                    span: [
                                                        AND(393..396),
                                                    ],
                                                    op: And,
                                                    left: BinaryOp {
                                                        span: [
                                                            Eq(353..354),
                                                        ],
                                                        op: Eq,
                                                        left: ColumnRef {
                                                            span: [
                                                                Ident(343..352),
                                                            ],
                                                            database: None,
                                                            table: None,
                                                            column: Identifier {
                                                                name: "c_custkey",
                                                                quote: None,
                                                                span: Ident(343..352),
                                                            },
                                                        },
                                                        right: ColumnRef {
                                                            span: [
                                                                Ident(355..364),
                                                            ],
                                                            database: None,
                                                            table: None,
                                                            column: Identifier {
                                                                name: "o_custkey",
                                                                quote: None,
                                                                span: Ident(355..364),
                                                            },
                                                        },
                                                    },
                                                    right: BinaryOp {
                                                        span: [
                                                            NOT(407..410),
                                                            LIKE(411..415),
                                                        ],
                                                        op: NotLike,
                                                        left: ColumnRef {
                                                            span: [
                                                                Ident(397..406),
                                                            ],
                                                            database: None,
                                                            table: None,
                                                            column: Identifier {
                                                                name: "o_comment",
                                                                quote: None,
                                                                span: Ident(397..406),
                                                            },
                                                        },
                                                        right: Literal {
                                                            span: [
                                                                QuotedString(416..425),
                                                            ],
                                                            lit: String(
                                                                "%:1%:2%",
                                                            ),
                                                        },
                                                    },
                                                },
                                            ),
                                            left: Table {
                                                span: [
                                                    Ident(280..288),
                                                ],
                                                catalog: None,
                                                database: None,
                                                table: Identifier {
                                                    name: "customer",
                                                    quote: None,
                                                    span: Ident(280..288),
                                                },
                                                alias: None,
                                                travel_point: None,
                                            },
                                            right: Table {
                                                span: [
                                                    Ident(305..311),
                                                ],
                                                catalog: None,
                                                database: None,
                                                table: Identifier {
                                                    name: "orders",
                                                    quote: None,
                                                    span: Ident(305..311),
                                                },
                                                alias: None,
                                                travel_point: None,
                                            },
                                        },
                                    },
                                ],
                                selection: None,
                                group_by: [
                                    ColumnRef {
                                        span: [
                                            Ident(479..488),
                                        ],
                                        database: None,
                                        table: None,
                                        column: Identifier {
                                            name: "c_custkey",
                                            quote: None,
                                            span: Ident(479..488),
                                        },
                                    },
                                ],
                                having: None,
                            },
                        ),
                        order_by: [],
                        limit: [],
                        offset: None,
                        format: None,
                    },
                    alias: Some(
                        TableAlias {
                            name: Identifier {
                                name: "c_orders",
                                quote: None,
                                span: Ident(510..518),
                            },
                            columns: [],
                        },
                    ),
                },
            ],
            selection: None,
            group_by: [
                ColumnRef {
                    span: [
                        Ident(540..547),
                    ],
                    database: None,
                    table: None,
                    column: Identifier {
                        name: "c_count",
                        quote: None,
                        span: Ident(540..547),
                    },
                },
            ],
            having: None,
        },
    ),
    order_by: [
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(569..577),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "custdist",
                    quote: None,
                    span: Ident(569..577),
                },
            },
            asc: Some(
                false,
            ),
            nulls_first: Some(
                true,
            ),
        },
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(596..603),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "c_count",
                    quote: None,
                    span: Ident(596..603),
                },
            },
            asc: Some(
                true,
            ),
            nulls_first: None,
        },
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(609..619),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "totacctbal",
                    quote: None,
                    span: Ident(609..619),
                },
            },
            asc: None,
            nulls_first: Some(
                false,
            ),
        },
    ],
    limit: [
        Literal {
            span: [
                LiteralInteger(649..651),
            ],
            lit: Integer(
                10,
            ),
        },
        ColumnRef {
            span: [
                Ident(653..663),
            ],
            database: None,
            table: None,
            column: Identifier {
                name: "totacctbal",
                quote: None,
                span: Ident(653..663),
            },
        },
    ],
    offset: None,
    format: None,
}


---------- Input ----------
select * from t1 union select * from t2
---------- Output ---------
SELECT * FROM t1 UNION SELECT * FROM t2
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..16),
        UNION(17..22),
        SELECT(23..29),
        Multiply(30..31),
        FROM(32..36),
        Ident(37..39),
    ],
    with: None,
    body: SetOperation(
        SetOperation {
            span: [
                UNION(17..22),
            ],
            op: Union,
            all: false,
            left: Select(
                SelectStmt {
                    span: [
                        SELECT(0..6),
                        Multiply(7..8),
                        FROM(9..13),
                        Ident(14..16),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(14..16),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t1",
                                quote: None,
                                span: Ident(14..16),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
            right: Select(
                SelectStmt {
                    span: [
                        SELECT(23..29),
                        Multiply(30..31),
                        FROM(32..36),
                        Ident(37..39),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(37..39),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t2",
                                quote: None,
                                span: Ident(37..39),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from t1 union select * from t2 union select * from t3
---------- Output ---------
SELECT * FROM t1 UNION SELECT * FROM t2 UNION SELECT * FROM t3
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..16),
        UNION(17..22),
        SELECT(23..29),
        Multiply(30..31),
        FROM(32..36),
        Ident(37..39),
        UNION(40..45),
        SELECT(46..52),
        Multiply(53..54),
        FROM(55..59),
        Ident(60..62),
    ],
    with: None,
    body: SetOperation(
        SetOperation {
            span: [
                UNION(40..45),
            ],
            op: Union,
            all: false,
            left: SetOperation(
                SetOperation {
                    span: [
                        UNION(17..22),
                    ],
                    op: Union,
                    all: false,
                    left: Select(
                        SelectStmt {
                            span: [
                                SELECT(0..6),
                                Multiply(7..8),
                                FROM(9..13),
                                Ident(14..16),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(14..16),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t1",
                                        quote: None,
                                        span: Ident(14..16),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                    right: Select(
                        SelectStmt {
                            span: [
                                SELECT(23..29),
                                Multiply(30..31),
                                FROM(32..36),
                                Ident(37..39),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(37..39),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t2",
                                        quote: None,
                                        span: Ident(37..39),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                },
            ),
            right: Select(
                SelectStmt {
                    span: [
                        SELECT(46..52),
                        Multiply(53..54),
                        FROM(55..59),
                        Ident(60..62),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(60..62),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t3",
                                quote: None,
                                span: Ident(60..62),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from t1 union select * from t2 intersect select * from t3
---------- Output ---------
SELECT * FROM t1 UNION SELECT * FROM t2 INTERSECTSELECT * FROM t3
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..16),
        UNION(17..22),
        SELECT(23..29),
        Multiply(30..31),
        FROM(32..36),
        Ident(37..39),
        INTERSECT(40..49),
        SELECT(50..56),
        Multiply(57..58),
        FROM(59..63),
        Ident(64..66),
    ],
    with: None,
    body: SetOperation(
        SetOperation {
            span: [
                UNION(17..22),
            ],
            op: Union,
            all: false,
            left: Select(
                SelectStmt {
                    span: [
                        SELECT(0..6),
                        Multiply(7..8),
                        FROM(9..13),
                        Ident(14..16),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(14..16),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t1",
                                quote: None,
                                span: Ident(14..16),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
            right: SetOperation(
                SetOperation {
                    span: [
                        INTERSECT(40..49),
                    ],
                    op: Intersect,
                    all: false,
                    left: Select(
                        SelectStmt {
                            span: [
                                SELECT(23..29),
                                Multiply(30..31),
                                FROM(32..36),
                                Ident(37..39),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(37..39),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t2",
                                        quote: None,
                                        span: Ident(37..39),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                    right: Select(
                        SelectStmt {
                            span: [
                                SELECT(50..56),
                                Multiply(57..58),
                                FROM(59..63),
                                Ident(64..66),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(64..66),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t3",
                                        quote: None,
                                        span: Ident(64..66),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                },
            ),
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
(select * from t1 union select * from t2) union select * from t3
---------- Output ---------
SELECT * FROM t1 UNION SELECT * FROM t2 UNION SELECT * FROM t3
---------- AST ------------
Query {
    span: [
        LParen(0..1),
        SELECT(1..7),
        Multiply(8..9),
        FROM(10..14),
        Ident(15..17),
        UNION(18..23),
        SELECT(24..30),
        Multiply(31..32),
        FROM(33..37),
        Ident(38..40),
        RParen(40..41),
        UNION(42..47),
        SELECT(48..54),
        Multiply(55..56),
        FROM(57..61),
        Ident(62..64),
    ],
    with: None,
    body: SetOperation(
        SetOperation {
            span: [
                UNION(42..47),
            ],
            op: Union,
            all: false,
            left: SetOperation(
                SetOperation {
                    span: [
                        UNION(18..23),
                    ],
                    op: Union,
                    all: false,
                    left: Select(
                        SelectStmt {
                            span: [
                                SELECT(1..7),
                                Multiply(8..9),
                                FROM(10..14),
                                Ident(15..17),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(15..17),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t1",
                                        quote: None,
                                        span: Ident(15..17),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                    right: Select(
                        SelectStmt {
                            span: [
                                SELECT(24..30),
                                Multiply(31..32),
                                FROM(33..37),
                                Ident(38..40),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(38..40),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t2",
                                        quote: None,
                                        span: Ident(38..40),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                },
            ),
            right: Select(
                SelectStmt {
                    span: [
                        SELECT(48..54),
                        Multiply(55..56),
                        FROM(57..61),
                        Ident(62..64),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(62..64),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t3",
                                quote: None,
                                span: Ident(62..64),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}


---------- Input ----------
select * from t1 union (select * from t2 union select * from t3)
---------- Output ---------
SELECT * FROM t1 UNION SELECT * FROM t2 UNION SELECT * FROM t3
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..16),
        UNION(17..22),
        LParen(23..24),
        SELECT(24..30),
        Multiply(31..32),
        FROM(33..37),
        Ident(38..40),
        UNION(41..46),
        SELECT(47..53),
        Multiply(54..55),
        FROM(56..60),
        Ident(61..63),
        RParen(63..64),
    ],
    with: None,
    body: SetOperation(
        SetOperation {
            span: [
                UNION(17..22),
            ],
            op: Union,
            all: false,
            left: Select(
                SelectStmt {
                    span: [
                        SELECT(0..6),
                        Multiply(7..8),
                        FROM(9..13),
                        Ident(14..16),
                    ],
                    distinct: false,
                    select_list: [
                        QualifiedName(
                            [
                                Star,
                            ],
                        ),
                    ],
                    from: [
                        Table {
                            span: [
                                Ident(14..16),
                            ],
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "t1",
                                quote: None,
                                span: Ident(14..16),
                            },
                            alias: None,
                            travel_point: None,
                        },
                    ],
                    selection: None,
                    group_by: [],
                    having: None,
                },
            ),
            right: SetOperation(
                SetOperation {
                    span: [
                        UNION(41..46),
                    ],
                    op: Union,
                    all: false,
                    left: Select(
                        SelectStmt {
                            span: [
                                SELECT(24..30),
                                Multiply(31..32),
                                FROM(33..37),
                                Ident(38..40),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(38..40),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t2",
                                        quote: None,
                                        span: Ident(38..40),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                    right: Select(
                        SelectStmt {
                            span: [
                                SELECT(47..53),
                                Multiply(54..55),
                                FROM(56..60),
                                Ident(61..63),
                            ],
                            distinct: false,
                            select_list: [
                                QualifiedName(
                                    [
                                        Star,
                                    ],
                                ),
                            ],
                            from: [
                                Table {
                                    span: [
                                        Ident(61..63),
                                    ],
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "t3",
                                        quote: None,
                                        span: Ident(61..63),
                                    },
                                    alias: None,
                                    travel_point: None,
                                },
                            ],
                            selection: None,
                            group_by: [],
                            having: None,
                        },
                    ),
                },
            ),
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
    format: None,
}



---------- Input ----------
select * from customer inner join orders on a = b limit 1
---------- Output ---------
SELECT * FROM customer INNER JOIN orders ON a = b LIMIT 1
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        INNER(23..28),
        JOIN(29..33),
        Ident(34..40),
        ON(41..43),
        Ident(44..45),
        Eq(46..47),
        Ident(48..49),
        LIMIT(50..55),
        LiteralNumber(56..57),
    ],
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                INNER(23..28),
                JOIN(29..33),
                Ident(34..40),
                ON(41..43),
                Ident(44..45),
                Eq(46..47),
                Ident(48..49),
                LIMIT(50..55),
                LiteralNumber(56..57),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: Some(
                Join(
                    Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                span: [
                                    Eq(46..47),
                                ],
                                op: Eq,
                                left: ColumnRef {
                                    span: [
                                        Ident(44..45),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                        span: Ident(44..45),
                                    },
                                },
                                right: ColumnRef {
                                    span: [
                                        Ident(48..49),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "b",
                                        quote: None,
                                        span: Ident(48..49),
                                    },
                                },
                            },
                        ),
                        left: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                        },
                        right: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                        },
                    },
                ),
            ),
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [
        Literal {
            span: [
                LiteralNumber(56..57),
            ],
            lit: Number(
                "1",
            ),
        },
    ],
    offset: None,
}


---------- Input ----------
select * from customer inner join orders on a = b limit 2 offset 3
---------- Output ---------
SELECT * FROM customer INNER JOIN orders ON a = b LIMIT 2 OFFSET 3
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        INNER(23..28),
        JOIN(29..33),
        Ident(34..40),
        ON(41..43),
        Ident(44..45),
        Eq(46..47),
        Ident(48..49),
        LIMIT(50..55),
        LiteralNumber(56..57),
        OFFSET(58..64),
        LiteralNumber(65..66),
    ],
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                INNER(23..28),
                JOIN(29..33),
                Ident(34..40),
                ON(41..43),
                Ident(44..45),
                Eq(46..47),
                Ident(48..49),
                LIMIT(50..55),
                LiteralNumber(56..57),
                OFFSET(58..64),
                LiteralNumber(65..66),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: Some(
                Join(
                    Join {
                        op: Inner,
                        condition: On(
                            BinaryOp {
                                span: [
                                    Eq(46..47),
                                ],
                                op: Eq,
                                left: ColumnRef {
                                    span: [
                                        Ident(44..45),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "a",
                                        quote: None,
                                        span: Ident(44..45),
                                    },
                                },
                                right: ColumnRef {
                                    span: [
                                        Ident(48..49),
                                    ],
                                    database: None,
                                    table: None,
                                    column: Identifier {
                                        name: "b",
                                        quote: None,
                                        span: Ident(48..49),
                                    },
                                },
                            },
                        ),
                        left: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                        },
                        right: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(34..40),
                            },
                            alias: None,
                        },
                    },
                ),
            ),
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [
        Literal {
            span: [
                LiteralNumber(56..57),
            ],
            lit: Number(
                "2",
            ),
        },
    ],
    offset: Some(
        Literal {
            span: [
                LiteralNumber(65..66),
            ],
            lit: Number(
                "3",
            ),
        },
    ),
}


---------- Input ----------
select * from customer natural full join orders
---------- Output ---------
SELECT * FROM customer NATURAL FULL OUTER JOIN orders
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        NATURAL(23..30),
        FULL(31..35),
        JOIN(36..40),
        Ident(41..47),
    ],
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                NATURAL(23..30),
                FULL(31..35),
                JOIN(36..40),
                Ident(41..47),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: Some(
                Join(
                    Join {
                        op: FullOuter,
                        condition: Natural,
                        left: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "customer",
                                quote: None,
                                span: Ident(14..22),
                            },
                            alias: None,
                        },
                        right: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "orders",
                                quote: None,
                                span: Ident(41..47),
                            },
                            alias: None,
                        },
                    },
                ),
            ),
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
}


---------- Input ----------
select * from customer natural join orders left outer join detail using (id)
---------- Output ---------
SELECT * FROM customer NATURAL INNER JOIN orders LEFT OUTER JOIN detail USING(id)
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Multiply(7..8),
        FROM(9..13),
        Ident(14..22),
        NATURAL(23..30),
        JOIN(31..35),
        Ident(36..42),
        LEFT(43..47),
        OUTER(48..53),
        JOIN(54..58),
        Ident(59..65),
        USING(66..71),
        LParen(72..73),
        Ident(73..75),
        RParen(75..76),
    ],
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Multiply(7..8),
                FROM(9..13),
                Ident(14..22),
                NATURAL(23..30),
                JOIN(31..35),
                Ident(36..42),
                LEFT(43..47),
                OUTER(48..53),
                JOIN(54..58),
                Ident(59..65),
                USING(66..71),
                LParen(72..73),
                Ident(73..75),
                RParen(75..76),
            ],
            distinct: false,
            select_list: [
                QualifiedName(
                    [
                        Star,
                    ],
                ),
            ],
            from: Some(
                Join(
                    Join {
                        op: LeftOuter,
                        condition: Using(
                            [
                                Identifier {
                                    name: "id",
                                    quote: None,
                                    span: Ident(73..75),
                                },
                            ],
                        ),
                        left: Join(
                            Join {
                                op: Inner,
                                condition: Natural,
                                left: Table {
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "customer",
                                        quote: None,
                                        span: Ident(14..22),
                                    },
                                    alias: None,
                                },
                                right: Table {
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "orders",
                                        quote: None,
                                        span: Ident(36..42),
                                    },
                                    alias: None,
                                },
                            },
                        ),
                        right: Table {
                            catalog: None,
                            database: None,
                            table: Identifier {
                                name: "detail",
                                quote: None,
                                span: Ident(59..65),
                            },
                            alias: None,
                        },
                    },
                ),
            ),
            selection: None,
            group_by: [],
            having: None,
        },
    ),
    order_by: [],
    limit: [],
    offset: None,
}


---------- Input ----------
select c_count, count(*) as custdist, sum(c_acctbal) as totacctbal
            from customer, orders ODS,
                (
                    select
                        c_custkey,
                        count(o_orderkey)
                    from
                        customer left outer join orders on
                            c_custkey = o_custkey
                            and o_comment not like '%:1%:2%'
                    group by
                        c_custkey
                ) as c_orders
            group by c_count
            order by custdist desc, c_count asc, totacctbal
            limit 10, totacctbal
---------- Output ---------
SELECT c_count, COUNT(*) AS custdist, sum(c_acctbal) AS totacctbal FROM customer CROSS JOIN orders AS ODS CROSS JOIN (SELECT c_custkey, count(o_orderkey) FROM customer LEFT OUTER JOIN orders ON c_custkey = o_custkey AND o_comment NOT LIKE '%:1%:2%' GROUP BY c_custkey) AS c_orders GROUP BY c_count ORDER BY custdist DESC, c_count ASC, totacctbal LIMIT 10, totacctbal
---------- AST ------------
Query {
    span: [
        SELECT(0..6),
        Ident(7..14),
        Comma(14..15),
        COUNT(16..21),
        LParen(21..22),
        Multiply(22..23),
        RParen(23..24),
        AS(25..27),
        Ident(28..36),
        Comma(36..37),
        Ident(38..41),
        LParen(41..42),
        Ident(42..51),
        RParen(51..52),
        AS(53..55),
        Ident(56..66),
        FROM(79..83),
        Ident(84..92),
        Comma(92..93),
        Ident(94..100),
        Ident(101..104),
        Comma(104..105),
        LParen(122..123),
        SELECT(144..150),
        Ident(175..184),
        Comma(184..185),
        COUNT(210..215),
        LParen(215..216),
        Ident(216..226),
        RParen(226..227),
        FROM(248..252),
        Ident(277..285),
        LEFT(286..290),
        OUTER(291..296),
        JOIN(297..301),
        Ident(302..308),
        ON(309..311),
        Ident(340..349),
        Eq(350..351),
        Ident(352..361),
        AND(390..393),
        Ident(394..403),
        NOT(404..407),
        LIKE(408..412),
        QuotedIdent(413..422),
        GROUP(443..448),
        BY(449..451),
        Ident(476..485),
        RParen(502..503),
        AS(504..506),
        Ident(507..515),
        GROUP(528..533),
        BY(534..536),
        Ident(537..544),
        ORDER(557..562),
        BY(563..565),
        Ident(566..574),
        DESC(575..579),
        Comma(579..580),
        Ident(581..588),
        ASC(589..592),
        Comma(592..593),
        Ident(594..604),
        LIMIT(617..622),
        LiteralNumber(623..625),
        Comma(625..626),
        Ident(627..637),
    ],
    body: Select(
        SelectStmt {
            span: [
                SELECT(0..6),
                Ident(7..14),
                Comma(14..15),
                COUNT(16..21),
                LParen(21..22),
                Multiply(22..23),
                RParen(23..24),
                AS(25..27),
                Ident(28..36),
                Comma(36..37),
                Ident(38..41),
                LParen(41..42),
                Ident(42..51),
                RParen(51..52),
                AS(53..55),
                Ident(56..66),
                FROM(79..83),
                Ident(84..92),
                Comma(92..93),
                Ident(94..100),
                Ident(101..104),
                Comma(104..105),
                LParen(122..123),
                SELECT(144..150),
                Ident(175..184),
                Comma(184..185),
                COUNT(210..215),
                LParen(215..216),
                Ident(216..226),
                RParen(226..227),
                FROM(248..252),
                Ident(277..285),
                LEFT(286..290),
                OUTER(291..296),
                JOIN(297..301),
                Ident(302..308),
                ON(309..311),
                Ident(340..349),
                Eq(350..351),
                Ident(352..361),
                AND(390..393),
                Ident(394..403),
                NOT(404..407),
                LIKE(408..412),
                QuotedIdent(413..422),
                GROUP(443..448),
                BY(449..451),
                Ident(476..485),
                RParen(502..503),
                AS(504..506),
                Ident(507..515),
                GROUP(528..533),
                BY(534..536),
                Ident(537..544),
                ORDER(557..562),
                BY(563..565),
                Ident(566..574),
                DESC(575..579),
                Comma(579..580),
                Ident(581..588),
                ASC(589..592),
                Comma(592..593),
                Ident(594..604),
                LIMIT(617..622),
                LiteralNumber(623..625),
                Comma(625..626),
                Ident(627..637),
            ],
            distinct: false,
            select_list: [
                AliasedExpr {
                    expr: ColumnRef {
                        span: [
                            Ident(7..14),
                        ],
                        database: None,
                        table: None,
                        column: Identifier {
                            name: "c_count",
                            quote: None,
                            span: Ident(7..14),
                        },
                    },
                    alias: None,
                },
                AliasedExpr {
                    expr: CountAll {
                        span: [
                            COUNT(16..21),
                            LParen(21..22),
                            Multiply(22..23),
                            RParen(23..24),
                        ],
                    },
                    alias: Some(
                        Identifier {
                            name: "custdist",
                            quote: None,
                            span: Ident(28..36),
                        },
                    ),
                },
                AliasedExpr {
                    expr: FunctionCall {
                        span: [
                            Ident(38..41),
                            LParen(41..42),
                            Ident(42..51),
                            RParen(51..52),
                        ],
                        distinct: false,
                        name: Identifier {
                            name: "sum",
                            quote: None,
                            span: Ident(38..41),
                        },
                        args: [
                            ColumnRef {
                                span: [
                                    Ident(42..51),
                                ],
                                database: None,
                                table: None,
                                column: Identifier {
                                    name: "c_acctbal",
                                    quote: None,
                                    span: Ident(42..51),
                                },
                            },
                        ],
                        params: [],
                    },
                    alias: Some(
                        Identifier {
                            name: "totacctbal",
                            quote: None,
                            span: Ident(56..66),
                        },
                    ),
                },
            ],
            from: Some(
                Join(
                    Join {
                        op: CrossJoin,
                        condition: None,
                        left: Join(
                            Join {
                                op: CrossJoin,
                                condition: None,
                                left: Table {
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "customer",
                                        quote: None,
                                        span: Ident(84..92),
                                    },
                                    alias: None,
                                },
                                right: Table {
                                    catalog: None,
                                    database: None,
                                    table: Identifier {
                                        name: "orders",
                                        quote: None,
                                        span: Ident(94..100),
                                    },
                                    alias: Some(
                                        TableAlias {
                                            name: Identifier {
                                                name: "ODS",
                                                quote: None,
                                                span: Ident(101..104),
                                            },
                                            columns: [],
                                        },
                                    ),
                                },
                            },
                        ),
                        right: Subquery {
                            subquery: Query {
                                span: [
                                    SELECT(144..150),
                                    Ident(175..184),
                                    Comma(184..185),
                                    COUNT(210..215),
                                    LParen(215..216),
                                    Ident(216..226),
                                    RParen(226..227),
                                    FROM(248..252),
                                    Ident(277..285),
                                    LEFT(286..290),
                                    OUTER(291..296),
                                    JOIN(297..301),
                                    Ident(302..308),
                                    ON(309..311),
                                    Ident(340..349),
                                    Eq(350..351),
                                    Ident(352..361),
                                    AND(390..393),
                                    Ident(394..403),
                                    NOT(404..407),
                                    LIKE(408..412),
                                    QuotedIdent(413..422),
                                    GROUP(443..448),
                                    BY(449..451),
                                    Ident(476..485),
                                ],
                                body: Select(
                                    SelectStmt {
                                        span: [
                                            SELECT(144..150),
                                            Ident(175..184),
                                            Comma(184..185),
                                            COUNT(210..215),
                                            LParen(215..216),
                                            Ident(216..226),
                                            RParen(226..227),
                                            FROM(248..252),
                                            Ident(277..285),
                                            LEFT(286..290),
                                            OUTER(291..296),
                                            JOIN(297..301),
                                            Ident(302..308),
                                            ON(309..311),
                                            Ident(340..349),
                                            Eq(350..351),
                                            Ident(352..361),
                                            AND(390..393),
                                            Ident(394..403),
                                            NOT(404..407),
                                            LIKE(408..412),
                                            QuotedIdent(413..422),
                                            GROUP(443..448),
                                            BY(449..451),
                                            Ident(476..485),
                                        ],
                                        distinct: false,
                                        select_list: [
                                            AliasedExpr {
                                                expr: ColumnRef {
                                                    span: [
                                                        Ident(175..184),
                                                    ],
                                                    database: None,
                                                    table: None,
                                                    column: Identifier {
                                                        name: "c_custkey",
                                                        quote: None,
                                                        span: Ident(175..184),
                                                    },
                                                },
                                                alias: None,
                                            },
                                            AliasedExpr {
                                                expr: FunctionCall {
                                                    span: [
                                                        COUNT(210..215),
                                                        LParen(215..216),
                                                        Ident(216..226),
                                                        RParen(226..227),
                                                    ],
                                                    distinct: false,
                                                    name: Identifier {
                                                        name: "count",
                                                        quote: None,
                                                        span: COUNT(210..215),
                                                    },
                                                    args: [
                                                        ColumnRef {
                                                            span: [
                                                                Ident(216..226),
                                                            ],
                                                            database: None,
                                                            table: None,
                                                            column: Identifier {
                                                                name: "o_orderkey",
                                                                quote: None,
                                                                span: Ident(216..226),
                                                            },
                                                        },
                                                    ],
                                                    params: [],
                                                },
                                                alias: None,
                                            },
                                        ],
                                        from: Some(
                                            Join(
                                                Join {
                                                    op: LeftOuter,
                                                    condition: On(
                                                        BinaryOp {
                                                            span: [
                                                                AND(390..393),
                                                            ],
                                                            op: And,
                                                            left: BinaryOp {
                                                                span: [
                                                                    Eq(350..351),
                                                                ],
                                                                op: Eq,
                                                                left: ColumnRef {
                                                                    span: [
                                                                        Ident(340..349),
                                                                    ],
                                                                    database: None,
                                                                    table: None,
                                                                    column: Identifier {
                                                                        name: "c_custkey",
                                                                        quote: None,
                                                                        span: Ident(340..349),
                                                                    },
                                                                },
                                                                right: ColumnRef {
                                                                    span: [
                                                                        Ident(352..361),
                                                                    ],
                                                                    database: None,
                                                                    table: None,
                                                                    column: Identifier {
                                                                        name: "o_custkey",
                                                                        quote: None,
                                                                        span: Ident(352..361),
                                                                    },
                                                                },
                                                            },
                                                            right: BinaryOp {
                                                                span: [
                                                                    NOT(404..407),
                                                                    LIKE(408..412),
                                                                ],
                                                                op: NotLike,
                                                                left: ColumnRef {
                                                                    span: [
                                                                        Ident(394..403),
                                                                    ],
                                                                    database: None,
                                                                    table: None,
                                                                    column: Identifier {
                                                                        name: "o_comment",
                                                                        quote: None,
                                                                        span: Ident(394..403),
                                                                    },
                                                                },
                                                                right: Literal {
                                                                    span: [
                                                                        QuotedIdent(413..422),
                                                                    ],
                                                                    lit: String(
                                                                        "%:1%:2%",
                                                                    ),
                                                                },
                                                            },
                                                        },
                                                    ),
                                                    left: Table {
                                                        catalog: None,
                                                        database: None,
                                                        table: Identifier {
                                                            name: "customer",
                                                            quote: None,
                                                            span: Ident(277..285),
                                                        },
                                                        alias: None,
                                                    },
                                                    right: Table {
                                                        catalog: None,
                                                        database: None,
                                                        table: Identifier {
                                                            name: "orders",
                                                            quote: None,
                                                            span: Ident(302..308),
                                                        },
                                                        alias: None,
                                                    },
                                                },
                                            ),
                                        ),
                                        selection: None,
                                        group_by: [
                                            ColumnRef {
                                                span: [
                                                    Ident(476..485),
                                                ],
                                                database: None,
                                                table: None,
                                                column: Identifier {
                                                    name: "c_custkey",
                                                    quote: None,
                                                    span: Ident(476..485),
                                                },
                                            },
                                        ],
                                        having: None,
                                    },
                                ),
                                order_by: [],
                                limit: [],
                                offset: None,
                            },
                            alias: Some(
                                TableAlias {
                                    name: Identifier {
                                        name: "c_orders",
                                        quote: None,
                                        span: Ident(507..515),
                                    },
                                    columns: [],
                                },
                            ),
                        },
                    },
                ),
            ),
            selection: None,
            group_by: [
                ColumnRef {
                    span: [
                        Ident(537..544),
                    ],
                    database: None,
                    table: None,
                    column: Identifier {
                        name: "c_count",
                        quote: None,
                        span: Ident(537..544),
                    },
                },
            ],
            having: None,
        },
    ),
    order_by: [
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(566..574),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "custdist",
                    quote: None,
                    span: Ident(566..574),
                },
            },
            asc: Some(
                false,
            ),
            nulls_first: None,
        },
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(581..588),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "c_count",
                    quote: None,
                    span: Ident(581..588),
                },
            },
            asc: Some(
                true,
            ),
            nulls_first: None,
        },
        OrderByExpr {
            expr: ColumnRef {
                span: [
                    Ident(594..604),
                ],
                database: None,
                table: None,
                column: Identifier {
                    name: "totacctbal",
                    quote: None,
                    span: Ident(594..604),
                },
            },
            asc: None,
            nulls_first: None,
        },
    ],
    limit: [
        Literal {
            span: [
                LiteralNumber(623..625),
            ],
            lit: Number(
                "10",
            ),
        },
        ColumnRef {
            span: [
                Ident(627..637),
            ],
            database: None,
            table: None,
            column: Identifier {
                name: "totacctbal",
                quote: None,
                span: Ident(627..637),
            },
        },
    ],
    offset: None,
}



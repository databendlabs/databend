Error: APIError: QueryFailed: [1025]Unknown table 'tbnotexists'
Error: APIError: QueryFailed: [1003]Unknown database 'dbnotexists'
=== check list user's local stage ===
=== no err ===
information_schema
system
test -- insert
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Insert] is required on 'default'.'default'.'t20_0012' for user 'test-user'@'%' with roles [public]
2
1
2
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Delete] is required on 'default'.'default'.'t20_0012' for user 'test-user'@'%' with roles [public,test-role1,test-role2]
1
2
test -- update
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Update] is required on 'default'.'default'.'t20_0012' for user 'test-user'@'%' with roles [public,test-role1,test-role2]
1
2
3
test -- delete
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Delete] is required on 'default'.'default'.'t20_0012' for user 'test-user'@'%' with roles [public,test-role1,test-role2]
1
true
test -- insert overwrite
1
2
1
3
test -- optimize table
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Super] is required on 'default'.'default'.'t20_0012' for user 'test-user'@'%' with roles [public,test-role1,test-role2]
true
=== NETWORK_POLICY SETTING ===
Error: APIError: QueryFailed: [1063]Permission Denied: Setting of network_policy is restricted to account_admin role
Error: APIError: QueryFailed: [1063]Permission Denied: Setting of network_policy is restricted to account_admin role
test -- select
1
1
1
1
1
1
test -- select view
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Select] is required on 'default'.'default2'.'v_t20_0012' for user 'test-user'@'%' with roles [public,test-role1,test-role2]
1
test -- clustering_information
true
true
true
true
SELECT default  USER a GRANT SELECT ON 'default'.'default'.* TO 'a'@'%'
SELECT default.grant_db.t  USER a GRANT SELECT ON 'default'.'grant_db'.'t' TO 'a'@'%'
default
grant_db
information_schema
system
test -- show tables from system
Error: APIError: QueryFailed: [1063]Permission denied: User 'a'@'%' does not have the required privileges for database 'system'
test -- show tables from grant_db
t
Error: APIError: QueryFailed: [1063]Permission denied: User 'a'@'%' does not have the required privileges for database 'system'
test -- show columns from one from system
dummy	tinyint unsigned	NO		NULL	NULL
c1	int	NO		NULL	NULL
0
Error: APIError: QueryFailed: [1063]Permission denied: User 'a'@'%' does not have the required privileges for table 'system.tasks'
bloom_index_size	bigint unsigned	YES		NULL	NULL
catalog	varchar(16382)	NO		NULL	NULL
cluster_by	varchar(16382)	NO		NULL	NULL
comment	varchar(16382)	NO		NULL	NULL
created_on	timestamp	NO		NULL	NULL
data_compressed_size	bigint unsigned	YES		NULL	NULL
data_size	bigint unsigned	YES		NULL	NULL
database	varchar(16382)	NO		NULL	NULL
database_id	bigint unsigned	NO		NULL	NULL
dropped_on	timestamp	YES		NULL	NULL
engine	varchar(16382)	NO		NULL	NULL
engine_full	varchar(16382)	NO		NULL	NULL
index_size	bigint unsigned	YES		NULL	NULL
inverted_index_size	bigint unsigned	YES		NULL	NULL
is_attach	varchar(16382)	NO		NULL	NULL
is_external	boolean	NO		NULL	NULL
is_transient	varchar(16382)	NO		NULL	NULL
name	varchar(16382)	NO		NULL	NULL
ngram_index_size	bigint unsigned	YES		NULL	NULL
num_rows	bigint unsigned	YES		NULL	NULL
number_of_blocks	bigint unsigned	YES		NULL	NULL
number_of_segments	bigint unsigned	YES		NULL	NULL
owner	varchar(16382)	YES		NULL	NULL
storage_param	varchar(16382)	NO		NULL	NULL
table_id	bigint unsigned	NO		NULL	NULL
table_option	varchar(16382)	NO		NULL	NULL
table_type	varchar(16382)	NO		NULL	NULL
total_columns	bigint unsigned	NO		NULL	NULL
updated_on	timestamp	NO		NULL	NULL
vector_index_size	bigint unsigned	YES		NULL	NULL
virtual_column_size	bigint unsigned	YES		NULL	NULL
Error: APIError: QueryFailed: [1063]Permission denied: User 'a'@'%' does not have the required privileges for database 'nogrant'
1
0
0
0
=== Test: show grants on privilege check ===
Error: APIError: QueryFailed: [1063]Permission denied: privilege USAGE is required on udf root_func for user b.
Error: APIError: QueryFailed: [1063]Permission denied: privilege READ is required on stage root_stage for user b. Or no need to show the stage privilege
Error: APIError: QueryFailed: [1063]Permission denied: No privilege on database root_db for user b.
Error: APIError: QueryFailed: [1063]Permission denied: No privilege on table root_table for user b.
Error: APIError: QueryFailed: [1063]Permission denied: No privilege on table root_table for user b.
1	1
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Select] is required on 'default'.'default'.'t1' for user 'b'@'%' with roles [public,role_test_b]
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Read] is required on STAGE s3 for user 'b'@'%' with roles [public,role_test_b]. Note: Please ensure that your current role have the appropriate permissions to create a new Object
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Select] is required on 'default'.'default'.'t' for user 'b'@'%' with roles [public,role_test_b]
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Read] is required on STAGE s3 for user 'b'@'%' with roles [public,role_test_b]. Note: Please ensure that your current role have the appropriate permissions to create a new Object
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Read] is required on STAGE s3 for user 'b'@'%' with roles [public,role_test_b]. Note: Please ensure that your current role have the appropriate permissions to create a new Object
Error: APIError: QueryFailed: [1063]Permission denied: privilege [Select] is required on 'default'.'default'.'t1' for user 'b'@'%' with roles [public,role_test_b]
0
1
a b/data_UUID_0000_00000000.parquet	1	0	NULL	NULL
=== check db/table_id ===
Read s3  USER b GRANT Read ON STAGE s3 TO 'b'@'%'
SELECT system  USER b GRANT SELECT ON 'default'.'system'.* TO 'b'@'%'
CREATE default  USER b GRANT CREATE ON 'default'.'default'.* TO 'b'@'%'
SELECT,INSERT,DELETE default.default.t  USER b GRANT SELECT,INSERT,DELETE ON 'default'.'default'.'t' TO 'b'@'%'
SELECT default.default.t1  USER b GRANT SELECT ON 'default'.'default'.'t1' TO 'b'@'%'
SELECT,INSERT default.c.t  USER b GRANT SELECT,INSERT ON 'default'.'c'.'t' TO 'b'@'%'
OWNERSHIP default.default.t2  USER b GRANT OWNERSHIP ON 'default'.'default'.'t2' TO 'b'@'%'
1
1
Read s3  USER b GRANT Read ON STAGE s3 TO 'b'@'%'
SELECT system  USER b GRANT SELECT ON 'default'.'system'.* TO 'b'@'%'
CREATE default  USER b GRANT CREATE ON 'default'.'default'.* TO 'b'@'%'
SELECT,INSERT,DELETE default.default.t  USER b GRANT SELECT,INSERT,DELETE ON 'default'.'default'.'t' TO 'b'@'%'
SELECT default.default.t1  USER b GRANT SELECT ON 'default'.'default'.'t1' TO 'b'@'%'
SELECT,INSERT default.c.t1  USER b GRANT SELECT,INSERT ON 'default'.'c'.'t1' TO 'b'@'%'
OWNERSHIP default.default.t2  USER b GRANT OWNERSHIP ON 'default'.'default'.'t2' TO 'b'@'%'
1
1
2
Read s3  USER b GRANT Read ON STAGE s3 TO 'b'@'%'
SELECT system  USER b GRANT SELECT ON 'default'.'system'.* TO 'b'@'%'
CREATE default  USER b GRANT CREATE ON 'default'.'default'.* TO 'b'@'%'
SELECT,INSERT,DELETE default.default.t  USER b GRANT SELECT,INSERT,DELETE ON 'default'.'default'.'t' TO 'b'@'%'
SELECT default.default.t1  USER b GRANT SELECT ON 'default'.'default'.'t1' TO 'b'@'%'
SELECT,INSERT default.d.t1  USER b GRANT SELECT,INSERT ON 'default'.'d'.'t1' TO 'b'@'%'
OWNERSHIP default.default.t2  USER b GRANT OWNERSHIP ON 'default'.'default'.'t2' TO 'b'@'%'
1
1
2
3
=== set privilege check ===
100
100
1
1
=== set privilege check succ ===

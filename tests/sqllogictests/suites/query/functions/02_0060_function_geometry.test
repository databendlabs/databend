statement ok
DROP TABLE IF EXISTS t1

query T
SELECT ST_CONTAINS(poly, poly_inside),
      ST_CONTAINS(poly, poly),
      ST_CONTAINS(poly, line_on_boundary),
      ST_CONTAINS(poly, line_inside)
FROM (SELECT
    TO_GEOMETRY('POLYGON((-2 0, 0 2, 2 0, -2 0))') AS poly,
    TO_GEOMETRY('POLYGON((-1 0, 0 1, 1 0, -1 0))') AS poly_inside,
    TO_GEOMETRY('LINESTRING(-1 1, 0 2, 1 1)') AS line_on_boundary,
    TO_GEOMETRY('LINESTRING(-2 0, 0 0, 0 1)') AS line_inside);
----
1 1 0 1

query T
SELECT haversine(40.7127, -74.0059, 34.0500, -118.2500);
----
3936.390533556

query T
SELECT st_distance(to_geometry('POINT(0 0)'), to_geometry('POINT(1 1)'));
----
1.414213562

query T
SELECT st_length(to_geometry('POINT(1 1)'));
----
0.0

query T
SELECT st_length(to_geometry('LINESTRING(0 0, 1 1)'));
----
1.414213562

query T
SELECT st_length(to_geometry('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'));
----
0.0

statement ok
SET geometry_output_format='EWKT'

query T
SELECT TO_STRING(ST_SETSRID(TO_GEOMETRY('POINT(13 51)'), 4326));
----
SRID=4326;POINT(13 51)

query T
SELECT to_string(st_makeline(ST_GEOMFROMWKT('POINT(33.0 44.2)', 32633), ST_GEOMFROMWKT('POINT(224.5 41.5)', 32633)));
----
SRID=32633;LINESTRING(33 44.2,224.5 41.5)

statement ok
CREATE TABLE t1 (x Float64, y Float64) ENGINE=Memory

statement ok
INSERT INTO t1 VALUES(55.77922738, 37.63098076), (5.77922738, 7.63098076)

query T
SELECT to_string(st_makegeompoint(x, y)) FROM t1
----
POINT(55.77922738 37.63098076)
POINT(5.77922738 7.63098076)

query T
SELECT st_makegeompoint(x, y)::String FROM t1
----
POINT(55.77922738 37.63098076)
POINT(5.77922738 7.63098076)

statement ok
DROP TABLE IF EXISTS t1

statement error 1801
CREATE TABLE t1 (a int, g geometry)

statement ok
SET enable_geo_create_table=1

statement ok
CREATE TABLE t1 (a int, g geometry)

statement ok
INSERT INTO t1 VALUES(1, ST_GEOMFROMWKT('POINT(389866.35 5819003.03)', 32633)), (2, ST_GEOMFROMWKT('POINT(4.500212 52.161170)', 4326))

query T
SELECT a, to_string(g) FROM t1
----
1 SRID=32633;POINT(389866.35 5819003.03)
2 SRID=4326;POINT(4.500212 52.16117)

query T
SELECT to_string(ST_TRANSFORM(g, 3857)) AS transformed_geom FROM t1
----
SRID=3857;POINT(1489140.093766 6892872.19868)
SRID=3857;POINT(500961.308302 6829319.683153)

query T
SELECT to_string(ST_TRANSFORM(ST_GEOMFROMWKT('POINT(389866.35 5819003.03)', 32633), 32633, 3857));
----
SRID=3857;POINT(1489140.093766 6892872.19868)

query T
SELECT to_string(ST_TRANSFORM(ST_GEOMFROMWKT('POINT(4.500212 52.161170)', 4326), 4326, 3857));
----
SRID=3857;POINT(500961.308302 6829319.683153)

statement ok
DROP TABLE IF EXISTS t1

statement ok
CREATE TABLE t1 (a geometry)

statement ok
INSERT INTO t1 VALUES(ST_GEOMETRYFROMWKT('LINESTRING(0.0 0.0, 1.0 0.0, 1.0 2.0, 0.0 2.0, 0.0 0.0)')),(ST_GEOMETRYFROMWKT('LINESTRING(0.0 0.2, 1.4 5, 1.9 2, 0 2, 0.0 0.2)'))

statement ok
SET geometry_output_format='GeoJSON'

query T
SELECT to_string(st_makepolygon(a)) FROM t1
----
{"type": "Polygon", "coordinates": [[[0,0],[1,0],[1,2],[0,2],[0,0]]]}
{"type": "Polygon", "coordinates": [[[0,0.2],[1.4,5],[1.9,2],[0,2],[0,0.2]]]}

statement ok
DROP TABLE IF EXISTS t1

statement ok
CREATE TABLE t1 (g1 geometry, g2 geometry)

statement ok
INSERT INTO t1 VALUES(ST_GEOMFROMWKT('POINT(1.0 2.0)', 32633), ST_GEOMFROMWKT('POINT(3.5 4.5)', 32633)),
(ST_GEOMFROMWKT('POINT(1.0 2.0)', 4326), ST_GEOMFROMWKT('LINESTRING(1.0 2.0, 10.1 5.5)', 4326)),
(ST_GEOMFROMWKT('LINESTRING(1.0 2.0, 10.1 5.5)'), ST_GEOMFROMWKT('MULTIPOINT(3.5 4.5, 6.1 7.9)'))

statement ok
SET geometry_output_format='EWKT'

query T
SELECT to_string(st_makeline(g1, g2)) FROM t1
----
SRID=32633;LINESTRING(1 2,3.5 4.5)
SRID=4326;LINESTRING(1 2,1 2,10.1 5.5)
LINESTRING(1 2,10.1 5.5,3.5 4.5,6.1 7.9)

statement ok
DROP TABLE IF EXISTS t1;

statement ok
CREATE TABLE t1 (b binary);

statement ok
INSERT INTO t1 VALUES(UNHEX('0101000020797f000066666666a9cb17411f85ebc19e325641'));

statement ok
SET geometry_output_format='EWKT'

query T
SELECT TO_STRING(ST_GEOMETRYFROMWKB(b)) FROM t1;
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(ST_GEOMETRYFROMWKB(b, 4326)) FROM t1;
----
SRID=4326;POINT(389866.35 5819003.03)

query T
SELECT ST_ASGEOJSON(ST_GEOMETRYFROMWKB(b)) FROM t1
----
{"coordinates":[389866.35,5819003.03],"type":"Point"}

statement ok
DROP TABLE IF EXISTS t1;

statement ok
CREATE TABLE t1 (b STRING);

statement ok
INSERT INTO t1 VALUES('0101000020797f000066666666a9cb17411f85ebc19e325641');

query T
SELECT TO_STRING(ST_GEOMETRYFROMWKB(b)) FROM t1;
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(ST_GEOMETRYFROMWKB(b, 4326)) FROM t1;
----
SRID=4326;POINT(389866.35 5819003.03)

statement ok
DROP TABLE IF EXISTS t1;

query T
SELECT TO_STRING(ST_ASGEOJSON(ST_GEOMETRYFROMWKT('SRID=4326;LINESTRING(389866 5819003, 390000 5830000)')))
----
 {"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}

statement ok
SET geometry_output_format = 'GeoJSON'

query T
SELECT TO_STRING(ST_GEOMPOINTFROMGEOHASH('s02equ0'))
----
{"type": "Point", "coordinates": [1.0004425048828125,2.0001983642578125]}

statement ok
CREATE TABLE t1 (s varchar);

statement ok
INSERT INTO t1 VALUES('9q60y60rhs');

query T
SELECT TO_STRING(ST_GEOMFROMGEOHASH(s)) FROM t1;
----
{"type": "Polygon", "coordinates": [[[-120.66230535507202,35.30029535293579],[-120.66230535507202,35.30030071735382],[-120.66229462623596,35.30030071735382],[-120.66229462623596,35.30029535293579],[-120.66230535507202,35.30029535293579]]]}

statement ok
SET geometry_output_format = 'EWKT';

query T
SELECT TO_STRING(TO_GEOMETRY('POINT(1820.12 890.56)'));
----
POINT(1820.12 890.56)

query T
SELECT TO_STRING(TO_GEOMETRY('SRID=4326;POINT(1820.12 890.56)'))
----
SRID=4326;POINT(1820.12 890.56)

query T
SELECT TO_STRING(TO_GEOMETRY('POINT(1820.12 890.56)', 4326))
----
SRID=4326;POINT(1820.12 890.56)

query T
SELECT TO_STRING(TO_GEOMETRY('0101000020797f000066666666a9cb17411f85ebc19e325641'))
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TO_GEOMETRY('0101000020797f000066666666a9cb17411f85ebc19e325641', 4326))
----
SRID=4326;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TO_GEOMETRY(UNHEX('0101000020797f000066666666a9cb17411f85ebc19e325641')))
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TO_GEOMETRY(UNHEX('0101000020797f000066666666a9cb17411f85ebc19e325641'), 4326))
----
SRID=4326;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TO_GEOMETRY('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}'))
----
LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TO_GEOMETRY('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}', 4326))
----
SRID=4326;LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TO_GEOMETRY(PARSE_JSON('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}')))
----
LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TO_GEOMETRY(PARSE_JSON('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}'), 4326))
----
SRID=4326;LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('POINT(1820.12 890.56)'));
----
POINT(1820.12 890.56)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('SRID=4326;POINT(1820.12 890.56)'))
----
SRID=4326;POINT(1820.12 890.56)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('POINT(1820.12 890.56)', 4326))
----
SRID=4326;POINT(1820.12 890.56)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('0101000020797f000066666666a9cb17411f85ebc19e325641'))
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('0101000020797f000066666666a9cb17411f85ebc19e325641', 4326))
----
SRID=4326;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(UNHEX('0101000020797f000066666666a9cb17411f85ebc19e325641')))
----
SRID=32633;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(UNHEX('0101000020797f000066666666a9cb17411f85ebc19e325641'), 4326))
----
SRID=4326;POINT(389866.35 5819003.03)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}'))
----
LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}', 4326))
----
SRID=4326;LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(PARSE_JSON('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}')))
----
LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(PARSE_JSON('{"coordinates":[[389866,5819003],[390000,5830000]],"type":"LineString"}'), 4326))
----
SRID=4326;LINESTRING(389866 5819003,390000 5830000)

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('abc'));
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(UNHEX('1234')))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(UNHEX('1234'), 4326))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('{}'))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('{"coordinates":[]', 4326))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(PARSE_JSON('{}')))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(PARSE_JSON('{"coordinates":[],"type":"aaa"}'), 4326))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY(NULL))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('nuLL'))
----
NULL

query T
SELECT TO_STRING(TRY_TO_GEOMETRY('null'))
----
NULL

statement ok
DROP TABLE IF EXISTS t1;

statement ok
CREATE OR REPLACE TABLE t1 (g geometry)

statement ok
INSERT INTO t1 VALUES
  ('POINT(-122.35 37.55)'), ('LINESTRING(0.75 0.75, -10 20)')

query T
SELECT UPPER(TO_HEX(ST_ASWKB(g))) FROM t1
----
01010000006666666666965EC06666666666C64240
010200000002000000000000000000E83F000000000000E83F00000000000024C00000000000003440

query T
SELECT ST_ASWKT(g) FROM t1
----
POINT(-122.35 37.55)
LINESTRING(0.75 0.75,-10 20)

statement ok
CREATE OR REPLACE TABLE t1 (g GEOMETRY)

statement ok
INSERT INTO t1 VALUES('SRID=4326;POINT(-122.35 37.55)'), ('SRID=0;LINESTRING(0.75 0.75, -10 20)')

query T
SELECT UPPER(TO_HEX(ST_ASEWKB(g))) FROM t1
----
0101000020E61000006666666666965EC06666666666C64240
01020000200000000002000000000000000000E83F000000000000E83F00000000000024C00000000000003440

# srid=0 has't supported by geozero crate.See also: https://github.com/georust/geozero/pull/210/files
query T
SELECT ST_ASEWKT(g) FROM t1
----
SRID=4326;POINT(-122.35 37.55)
LINESTRING(0.75 0.75,-10 20)

query T
SELECT ST_GEOHASH(TO_GEOMETRY('POINT(-122.306100 37.554162)', 4326))
----
9q9j8ue2v71y

query T
SELECT ST_GEOHASH(TO_GEOMETRY('POINT(-122.306100 37.554162)', 4326), 10)
----
9q9j8ue2v7

statement ok
SET geometry_output_format='WKT'

query T
SELECT TO_STRING(ST_ENDPOINT(TO_GEOMETRY('LINESTRING(1 1, 2 2, 3 3, 4 4)')));
----
POINT(4 4)

statement ok
CREATE OR REPLACE TABLE t1 (g GEOMETRY)

statement ok
INSERT INTO t1 VALUES
    ('POINT(66 12)'),
    ('MULTIPOINT((45 21), (12 54))'),
    ('LINESTRING(40 60, 50 50, 60 40)'),
    ('MULTILINESTRING((1 1, 32 17), (33 12, 73 49, 87.1 6.1))'),
    ('POLYGON((17 17, 17 30, 30 30, 30 17, 17 17))'),
    ('MULTIPOLYGON(((-10 0,0 10,10 0,-10 0)),((-10 40,10 40,0 20,-10 40)))'),
    ('GEOMETRYCOLLECTION(POLYGON((-10 0,0 10,10 0,-10 0)),LINESTRING(40 60, 50 50, 60 40), POINT(99 11))')

query T
SELECT ST_DIMENSION(g) FROM t1;
----
0
0
1
1
2
2
2

query T
SELECT TO_STRING(ST_POINTN(TO_GEOMETRY('LINESTRING(1 1, 2 2, 3 3, 4 4)'), 2))
----
POINT(2 2)

query T
SELECT TO_STRING(ST_POINTN(TO_GEOMETRY('LINESTRING(1 1, 2 2, 3 3, 4 4)'), -2))
----
POINT(3 3)


query T
SELECT ST_SRID(TO_GEOMETRY('POINT(-122.306100 37.554162)', 1234))
----
1234

query T
SELECT ST_SRID(ST_MAKEGEOMPOINT(37.5, 45.5))
----
4326

query T
SELECT ST_SRID(ST_MAKEGEOMPOINT(NULL, NULL))
----
NULL

query T
SELECT ST_SRID(NULL)
----
NULL

query T
SELECT ST_STARTPOINT(TO_GEOMETRY('LINESTRING(1 1, 2 2, 3 3, 4 4)'))
----
POINT(1 1)

query T
SELECT ST_X(ST_MAKEGEOMPOINT(37.5, 45.5)), ST_Y(ST_MAKEGEOMPOINT(37.5, 45.5))
----
37.5 45.5

query T
SELECT ST_X(ST_MAKEGEOMPOINT(NULL, NULL)), ST_Y(ST_MAKEGEOMPOINT(NULL, NULL)),ST_X(NULL),ST_Y(NULL)
----
NULL NULL NULL NULL

query T
SELECT ST_XMAX(TO_GEOMETRY('POINT(-180 0)'))
----
-180.0

query T
SELECT ST_XMAX(TO_GEOMETRY('LINESTRING(-179 0, 179 0)'))
----
179.0

query T
SELECT ST_XMAX(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POLYGON((40 40,20 45,45 30,40 40)))'))
----
45.0

query T
SELECT ST_XMAX(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POINT EMPTY)'))
----
40.0

query T
SELECT ST_XMAX(TO_GEOMETRY('MULTILINESTRING ((10 10, 20 20, 10 40), EMPTY)'))
----
20.0

query T
SELECT ST_XMIN(TO_GEOMETRY('POINT(-180 0)'))
----
-180.0

query T
SELECT ST_XMIN(TO_GEOMETRY('LINESTRING(-179 0, 179 0)'))
----
-179.0

query T
SELECT ST_XMIN(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POLYGON((40 40,20 45,45 30,40 40)))'))
----
10.0

query T
SELECT ST_XMIN(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POINT EMPTY)'))
----
10.0

query T
SELECT ST_XMIN(TO_GEOMETRY('MULTILINESTRING ((10 10, 20 20, 10 40), EMPTY)'))
----
10.0

query T
SELECT ST_YMAX(TO_GEOMETRY('POINT(-180 0)'))
----
0.0

query T
SELECT ST_YMAX(TO_GEOMETRY('LINESTRING(-179 10, 179 22)'))
----
22.0

query T
SELECT ST_YMAX(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POLYGON((40 40,20 45,45 30,40 40)))'))
----
45.0

query T
SELECT ST_YMAX(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POINT EMPTY)'))
----
40.0

query T
SELECT ST_YMAX(TO_GEOMETRY('MULTILINESTRING ((10 10, 20 20, 10 40), EMPTY)'))
----
40.0

query T
SELECT ST_YMIN(TO_GEOMETRY('POINT(-180 0)'))
----
0.0

query T
SELECT ST_YMIN(TO_GEOMETRY('LINESTRING(-179 10, 179 22)'))
----
10.0

query T
SELECT ST_YMIN(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POLYGON((40 40,20 45,45 30,40 40)))'))
----
10.0

query T
SELECT ST_YMIN(TO_GEOMETRY('GEOMETRYCOLLECTION(POINT(40 10),LINESTRING(10 10,20 20,10 40),POINT EMPTY)'))
----
10.0

query T
SELECT ST_YMIN(TO_GEOMETRY('MULTILINESTRING ((10 10, 20 20, 10 40), EMPTY)'))
----
10.0

statement ok
CREATE OR REPLACE TABLE geometry_shapes (g GEOMETRY);

statement ok
INSERT INTO geometry_shapes VALUES
    ('POINT(66 12)'),
    ('MULTIPOINT((45 21), (12 54))'),
    ('LINESTRING(40 60, 50 50, 60 40)'),
    ('MULTILINESTRING((1 1, 32 17), (33 12, 73 49, 87.1 6.1))'),
    ('POLYGON((17 17, 17 30, 30 30, 30 17, 17 17))'),
    ('MULTIPOLYGON(((-10 0,0 10,10 0,-10 0)),((-10 40,10 40,0 20,-10 40)))'),
    ('GEOMETRYCOLLECTION(POLYGON((-10 0,0 10,10 0,-10 0)),LINESTRING(40 60, 50 50, 60 40), POINT(99 11))')
    ;

query T
SELECT ST_NPOINTS(g), ST_ASWKT(g) FROM geometry_shapes;
----
1 POINT(66 12)
2 MULTIPOINT(45 21,12 54)
3 LINESTRING(40 60,50 50,60 40)
5 MULTILINESTRING((1 1,32 17),(33 12,73 49,87.1 6.1))
5 POLYGON((17 17,17 30,30 30,30 17,17 17))
8 MULTIPOLYGON(((-10 0,0 10,10 0,-10 0)),((-10 40,10 40,0 20,-10 40)))
8 GEOMETRYCOLLECTION(POLYGON((-10 0,0 10,10 0,-10 0)),LINESTRING(40 60,50 50,60 40),POINT(99 11))

query T
SELECT st_intersects(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'), st_geomfromtext('SRID=4326;POLYGON((-84.191605 39.758949, -75.165222 39.952583, -78.878738 42.880230, -84.191605 39.758949))'));
----
1

query T
SELECT st_intersects(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'), st_geomfromtext('SRID=4326;POLYGON((-79.995888 40.440624,-74.666728 40.358244, -76.5 42.443333, -79.995888 40.440624))'));
----
0

query T
SELECT st_disjoint(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902), (-87.623177 41.881832, -90.199402 38.627003, -82.446732 38.413651, -87.623177 41.881832))'), st_geomfromtext('SRID=4326;POLYGON((-87.356934 41.595161, -84.512016 39.103119, -86.529167 39.162222, -87.356934 41.595161))'));
----
1

query T
SELECT st_disjoint(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'), st_geomfromtext('SRID=4326;POLYGON((-84.191605 39.758949, -75.165222 39.952583, -78.878738 42.880230, -84.191605 39.758949))'));
----
0

query T
SELECT ST_Within(st_geomfromtext('SRID=4326;POLYGON((-87.623177 41.881832, -90.199402 38.627003, -82.446732 38.413651, -87.623177 41.881832))'), st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'));
----
1

query T
SELECT ST_Within(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902), (-87.623177 41.881832, -90.199402 38.627003, -82.446732 38.413651, -87.623177 41.881832))'), st_geomfromtext('SRID=4326;POLYGON((-87.356934 41.595161, -84.512016 39.103119, -86.529167 39.162222, -87.356934 41.595161))'));
----
0

query T
SELECT st_equals(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'), st_geomfromtext('SRID=4326;POLYGON((-95.992775 36.153980, -87.906471 43.038902, -75.704722 36.076944, -95.992775 36.153980))'));
----
1

query T
SELECT st_equals(st_geomfromtext('SRID=4326;POLYGON((-87.906471 43.038902, -95.992775 36.153980, -75.704722 36.076944, -87.906471 43.038902))'), st_geomfromtext('SRID=4326;POLYGON((-84.191605 39.758949, -75.165222 39.952583, -78.878738 42.880230, -84.191605 39.758949))'));
----
0

statement ok
CREATE OR REPLACE TABLE collect_test (g GEOMETRY);

statement ok
INSERT INTO collect_test VALUES
    ('POINT(1 2)'),
    ('POINT(3 4)'),
    ('LINESTRING(0 0, 1 1)'),
    ('POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))');

query T
SELECT ST_ASWKT(ST_COLLECT(g)) FROM collect_test;
----
GEOMETRYCOLLECTION(POINT(1 2),POINT(3 4),LINESTRING(0 0,1 1),POLYGON((0 0,1 0,1 1,0 1,0 0)))

query T
SELECT ST_AREA(TO_GEOMETRY('POLYGON((0 0, 0 1, 1 1, 1 0, 0 0))'));
----
1.0

query T
SELECT ST_AREA(TO_GEOMETRY('MULTIPOLYGON(((0 0, 0 1, 1 1, 1 0, 0 0)), ((2 2, 2 3, 3 3, 3 2, 2 2)))'));
----
2.0

query T
SELECT ST_AREA(TO_GEOMETRY('POINT(0 0)'));
----
0.0

query T
SELECT ST_AREA(g) FROM collect_test;
----
0.0
0.0
0.0
1.0

query T
SELECT ST_ASWKT(ST_CONVEXHULL(TO_GEOMETRY('MULTIPOINT(0 0, 1 0, 1 1, 0 1, 0.5 0.5)')));
----
POLYGON((1 0,1 1,0 1,0 0,1 0))

query T
SELECT ST_ASWKT(ST_CONVEXHULL(TO_GEOMETRY('LINESTRING(0 0, 1 1, 0 2)')));
----
POLYGON((0 0,1 1,0 2,0 0))

query T
SELECT ST_ASWKT(ST_CONVEXHULL(g)) FROM collect_test;
----
POLYGON((1 2,1 2))
POLYGON((3 4,3 4))
POLYGON((0 0,1 1,0 0))
POLYGON((1 0,1 1,0 1,0 0,1 0))

statement ok
DROP TABLE collect_test;

statement ok
SET enable_geo_create_table=0

statement ok
DROP TABLE IF EXISTS t1;

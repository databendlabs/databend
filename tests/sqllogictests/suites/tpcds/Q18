# Q18
query I
SELECT i_item_id,
       ca_country,
       ca_state,
       ca_county,
       avg(cast(cs_quantity AS decimal(12, 2)))      agg1,
       avg(cast(cs_list_price AS decimal(12, 2)))    agg2,
       avg(cast(cs_coupon_amt AS decimal(12, 2)))    agg3,
       avg(cast(cs_sales_price AS decimal(12, 2)))   agg4,
       avg(cast(cs_net_profit AS decimal(12, 2)))    agg5,
       avg(cast(c_birth_year AS decimal(12, 2)))     agg6,
       avg(cast(cd1.cd_dep_count AS decimal(12, 2))) agg7
FROM catalog_sales,
     customer_demographics cd1,
     customer_demographics cd2,
     customer,
     customer_address,
     date_dim,
     item
WHERE cs_sold_date_sk = d_date_sk
  AND cs_item_sk = i_item_sk
  AND cs_bill_cdemo_sk = cd1.cd_demo_sk
  AND cs_bill_customer_sk = c_customer_sk
  AND cd1.cd_gender = 'F'
  AND cd1.cd_education_status = 'Unknown'
  AND c_current_cdemo_sk = cd2.cd_demo_sk
  AND c_current_addr_sk = ca_address_sk
  AND c_birth_month IN (1,
                        6,
                        8,
                        9,
                        12,
                        2)
  AND d_year = 1998
  AND ca_state IN ('MS',
                   'IN',
                   'ND',
                   'OK',
                   'NM',
                   'VA',
                   'MS')
GROUP BY ROLLUP (i_item_id,
    ca_country,
    ca_state,
    ca_county)
ORDER BY ca_country NULLS FIRST,
    ca_state NULLS FIRST,
    ca_county NULLS FIRST,
    i_item_id NULLS FIRST
LIMIT 100;
----
NULL NULL NULL NULL 49.18873668 100.74353881 299.94699391 50.21814307 -351.58151446 1957.52696456 2.97792998
AAAAAAAAAABAAAAA NULL NULL NULL 64.00000000 146.03000000 0.00000000 106.60000000 1715.20000000 1930.00000000 0.00000000
AAAAAAAAAABDAAAA NULL NULL NULL 36.00000000 137.73500000 210.94000000 85.71000000 557.12000000 1953.50000000 3.00000000
AAAAAAAAAADBAAAA NULL NULL NULL 97.00000000 16.11000000 0.00000000 14.01000000 369.57000000 1949.00000000 6.00000000
AAAAAAAAAADCAAAA NULL NULL NULL 35.00000000 157.65000000 0.00000000 50.44000000 -1233.40000000 1925.00000000 5.00000000
AAAAAAAAAAJBAAAA NULL NULL NULL 65.00000000 47.30000000 0.00000000 35.94000000 155.35000000 1935.00000000 3.00000000
AAAAAAAAAAKDAAAA NULL NULL NULL 78.50000000 69.76500000 0.00000000 11.85500000 -1022.12500000 1948.50000000 5.00000000
AAAAAAAAAAMBAAAA NULL NULL NULL 99.00000000 201.10000000 0.00000000 176.96000000 8630.82000000 1962.00000000 0.00000000
AAAAAAAAAAODAAAA NULL NULL NULL 100.00000000 71.33000000 0.00000000 53.49000000 1936.00000000 1968.00000000 3.00000000
AAAAAAAAABADAAAA NULL NULL NULL 36.00000000 161.51000000 0.00000000 6.46000000 -3334.68000000 1968.00000000 3.00000000
AAAAAAAAABCBAAAA NULL NULL NULL 11.00000000 250.19000000 0.00000000 97.57000000 97.35000000 1937.00000000 0.00000000
AAAAAAAAABDAAAAA NULL NULL NULL 68.00000000 31.04000000 237.45000000 23.28000000 -539.37000000 1940.00000000 2.00000000
AAAAAAAAABEAAAAA NULL NULL NULL 96.00000000 70.97000000 0.00000000 18.45000000 -1152.96000000 1959.00000000 6.00000000
AAAAAAAAABFEAAAA NULL NULL NULL 66.00000000 78.52000000 0.00000000 51.82000000 1479.06000000 1935.00000000 6.00000000
AAAAAAAAABJBAAAA NULL NULL NULL 62.00000000 51.08000000 0.00000000 29.11000000 636.12000000 1980.00000000 5.00000000
AAAAAAAAABMDAAAA NULL NULL NULL 81.00000000 69.59000000 0.00000000 22.96000000 -1730.97000000 1943.00000000 0.00000000
AAAAAAAAABPBAAAA NULL NULL NULL 59.00000000 73.07000000 0.00000000 53.34000000 778.21000000 1940.00000000 2.00000000
AAAAAAAAACAAAAAA NULL NULL NULL 30.00000000 91.01000000 1908.81000000 69.16000000 -876.21000000 1961.00000000 5.00000000
AAAAAAAAACBCAAAA NULL NULL NULL 66.00000000 12.38000000 0.00000000 9.03000000 78.54000000 1982.00000000 0.00000000
AAAAAAAAACCAAAAA NULL NULL NULL 70.00000000 67.97000000 266.67000000 7.47000000 -2510.17000000 1960.00000000 3.00000000
AAAAAAAAACLAAAAA NULL NULL NULL 99.00000000 13.37000000 462.68000000 5.08000000 -516.14000000 1968.00000000 3.00000000
AAAAAAAAACLDAAAA NULL NULL NULL 62.00000000 3.04000000 0.00000000 0.30000000 -138.88000000 1936.00000000 1.00000000
AAAAAAAAACMDAAAA NULL NULL NULL 93.00000000 122.45000000 1052.05000000 34.28000000 -4808.32000000 1986.00000000 2.00000000
AAAAAAAAADBAAAAA NULL NULL NULL 49.00000000 132.21000000 0.00000000 116.34000000 2198.63000000 1949.00000000 6.00000000
AAAAAAAAADBDAAAA NULL NULL NULL 21.50000000 58.47500000 0.00000000 44.67000000 -6.51500000 1967.50000000 3.00000000
AAAAAAAAADGCAAAA NULL NULL NULL 88.00000000 93.31000000 0.00000000 35.45000000 -3899.28000000 1928.00000000 5.00000000
AAAAAAAAADHAAAAA NULL NULL NULL 44.00000000 47.12000000 127.70000000 36.28000000 728.10000000 1953.00000000 6.00000000
AAAAAAAAADICAAAA NULL NULL NULL 56.00000000 13.31000000 0.00000000 1.99000000 -285.04000000 1980.00000000 5.00000000
AAAAAAAAADODAAAA NULL NULL NULL 29.00000000 69.20000000 6.42000000 22.14000000 -684.73000000 1965.00000000 1.00000000
AAAAAAAAADPCAAAA NULL NULL NULL 13.00000000 93.04000000 0.00000000 24.19000000 -284.31000000 1979.00000000 4.00000000
AAAAAAAAAEABAAAA NULL NULL NULL 30.00000000 71.90000000 0.00000000 15.81000000 -1044.90000000 1932.00000000 5.00000000
AAAAAAAAAEBDAAAA NULL NULL NULL 87.00000000 93.06000000 2367.92000000 36.29000000 -2423.60000000 1939.00000000 1.00000000
AAAAAAAAAEDEAAAA NULL NULL NULL 78.00000000 51.73000000 179.51000000 46.03000000 -160.01000000 1940.00000000 2.00000000
AAAAAAAAAEECAAAA NULL NULL NULL 3.00000000 7.76000000 0.00000000 6.28000000 -3.57000000 1956.00000000 0.00000000
AAAAAAAAAEFBAAAA NULL NULL NULL 21.00000000 218.98000000 0.00000000 203.65000000 2585.94000000 1984.00000000 2.00000000
AAAAAAAAAEFCAAAA NULL NULL NULL 79.00000000 43.34000000 2620.67000000 38.13000000 -2638.84000000 1932.00000000 5.00000000
AAAAAAAAAEGDAAAA NULL NULL NULL 88.00000000 188.78000000 0.00000000 16.99000000 -6304.32000000 1985.00000000 1.00000000
AAAAAAAAAEJBAAAA NULL NULL NULL 81.00000000 153.24000000 0.00000000 96.54000000 3433.59000000 1985.00000000 2.00000000
AAAAAAAAAENDAAAA NULL NULL NULL 8.00000000 10.09000000 0.00000000 4.54000000 -39.84000000 1971.00000000 2.00000000
AAAAAAAAAFIBAAAA NULL NULL NULL 44.00000000 211.94000000 0.00000000 103.85000000 211.64000000 1965.00000000 1.00000000
AAAAAAAAAFLBAAAA NULL NULL NULL 91.00000000 78.69000000 0.00000000 11.80000000 -2488.85000000 1936.00000000 4.00000000
AAAAAAAAAGBBAAAA NULL NULL NULL 7.00000000 91.14000000 0.00000000 7.29000000 -476.28000000 1936.00000000 1.00000000
AAAAAAAAAGCDAAAA NULL NULL NULL 12.00000000 82.06000000 0.00000000 66.46000000 289.92000000 1963.00000000 5.00000000
AAAAAAAAAGEEAAAA NULL NULL NULL 29.00000000 88.51000000 297.71000000 17.70000000 -2055.98000000 1960.00000000 6.00000000
AAAAAAAAAGGCAAAA NULL NULL NULL 88.00000000 254.68000000 15091.56000000 231.75000000 -2907.08000000 1979.00000000 4.00000000
AAAAAAAAAGHBAAAA NULL NULL NULL 32.00000000 223.07000000 0.00000000 8.92000000 -2765.12000000 1947.00000000 2.00000000
AAAAAAAAAGIAAAAA NULL NULL NULL 69.00000000 61.15000000 0.00000000 42.80000000 1522.83000000 1936.00000000 4.00000000
AAAAAAAAAHADAAAA NULL NULL NULL 92.00000000 211.72000000 0.00000000 186.31000000 10281.92000000 1943.00000000 6.00000000
AAAAAAAAAHBDAAAA NULL NULL NULL 80.00000000 106.05000000 0.00000000 65.75000000 2384.00000000 1941.00000000 4.00000000
AAAAAAAAAHDAAAAA NULL NULL NULL 4.00000000 196.89000000 0.00000000 9.84000000 -356.40000000 1977.00000000 2.00000000
AAAAAAAAAHDEAAAA NULL NULL NULL 8.00000000 195.42000000 0.00000000 60.58000000 -308.96000000 1956.00000000 0.00000000
AAAAAAAAAHICAAAA NULL NULL NULL 73.00000000 81.08000000 0.00000000 41.35000000 -1365.83000000 1933.00000000 6.00000000
AAAAAAAAAHLBAAAA NULL NULL NULL 51.00000000 154.12000000 0.00000000 135.62000000 4089.18000000 1965.00000000 6.00000000
AAAAAAAAAIBBAAAA NULL NULL NULL 61.00000000 19.38000000 0.00000000 11.04000000 258.64000000 1935.00000000 6.00000000
AAAAAAAAAICBAAAA NULL NULL NULL 99.00000000 100.36000000 345.70000000 58.20000000 521.54000000 1924.00000000 2.00000000
AAAAAAAAAIDAAAAA NULL NULL NULL 14.00000000 8.12000000 0.00000000 6.73000000 54.88000000 1979.00000000 5.00000000
AAAAAAAAAIEBAAAA NULL NULL NULL 54.00000000 7.99000000 0.00000000 7.03000000 194.40000000 1960.00000000 0.00000000
AAAAAAAAAIECAAAA NULL NULL NULL 35.00000000 90.97000000 432.37000000 88.24000000 1139.83000000 1973.00000000 4.00000000
AAAAAAAAAIFDAAAA NULL NULL NULL 50.00000000 78.51000000 0.00000000 64.37000000 1195.00000000 1985.00000000 1.00000000
AAAAAAAAAIIBAAAA NULL NULL NULL 67.00000000 24.96000000 0.00000000 3.99000000 -375.87000000 1967.00000000 0.00000000
AAAAAAAAAIJCAAAA NULL NULL NULL 33.00000000 78.81000000 0.00000000 18.12000000 -455.07000000 1990.00000000 4.00000000
AAAAAAAAAJABAAAA NULL NULL NULL 62.00000000 183.69000000 0.00000000 73.47000000 -598.30000000 1942.00000000 3.00000000
AAAAAAAAAJAEAAAA NULL NULL NULL 80.00000000 181.55000000 0.00000000 148.87000000 4719.20000000 1975.00000000 4.00000000
AAAAAAAAAJCCAAAA NULL NULL NULL 93.00000000 172.60000000 0.00000000 165.69000000 6732.27000000 1952.00000000 4.00000000
AAAAAAAAAJGBAAAA NULL NULL NULL 68.00000000 12.40000000 0.00000000 11.90000000 303.96000000 1968.00000000 2.00000000
AAAAAAAAAJJBAAAA NULL NULL NULL 48.00000000 118.04000000 0.00000000 79.08000000 1425.12000000 1964.00000000 0.00000000
AAAAAAAAAJLDAAAA NULL NULL NULL 7.00000000 156.52000000 0.00000000 151.82000000 658.42000000 1948.00000000 6.00000000
AAAAAAAAAKAAAAAA NULL NULL NULL 59.00000000 66.68000000 0.00000000 14.66000000 -1227.79000000 1959.00000000 6.00000000
AAAAAAAAAKECAAAA NULL NULL NULL 51.00000000 36.59000000 0.00000000 26.34000000 -114.75000000 1986.00000000 4.00000000
AAAAAAAAAKJBAAAA NULL NULL NULL 34.00000000 43.95000000 222.76000000 31.20000000 16.94000000 1962.00000000 0.00000000
AAAAAAAAAKJDAAAA NULL NULL NULL 31.00000000 135.72000000 403.89000000 86.86000000 -357.39000000 1946.00000000 2.00000000
AAAAAAAAAKKCAAAA NULL NULL NULL 42.00000000 212.02000000 0.00000000 150.53000000 2564.94000000 1967.00000000 0.00000000
AAAAAAAAAKLCAAAA NULL NULL NULL 68.00000000 111.39000000 2787.18000000 102.47000000 -2293.50000000 1973.00000000 0.00000000
AAAAAAAAALBCAAAA NULL NULL NULL 7.00000000 155.49000000 0.00000000 71.52000000 5.88000000 1963.00000000 5.00000000
AAAAAAAAALCBAAAA NULL NULL NULL 64.00000000 13.76000000 108.71000000 8.94000000 -140.07000000 1975.00000000 4.00000000
AAAAAAAAALCDAAAA NULL NULL NULL 58.00000000 153.38000000 0.00000000 116.56000000 3465.50000000 1991.00000000 0.00000000
AAAAAAAAALIAAAAA NULL NULL NULL 16.00000000 235.58000000 1390.85000000 106.01000000 -1117.09000000 1928.00000000 3.00000000
AAAAAAAAALIBAAAA NULL NULL NULL 17.00000000 234.73000000 0.00000000 227.68000000 2503.93000000 1985.00000000 2.00000000
AAAAAAAAALMAAAAA NULL NULL NULL 89.00000000 175.42000000 6469.42000000 98.23000000 -3972.08000000 1959.00000000 6.00000000
AAAAAAAAALMCAAAA NULL NULL NULL 50.00000000 104.04000000 0.00000000 74.90000000 1336.50000000 1934.00000000 4.00000000
AAAAAAAAALMDAAAA NULL NULL NULL 91.00000000 154.84000000 157.72000000 12.38000000 -3957.88000000 1984.00000000 2.00000000
AAAAAAAAALNCAAAA NULL NULL NULL 50.00000000 16.96000000 0.00000000 4.07000000 -250.00000000 1946.00000000 5.00000000
AAAAAAAAALOBAAAA NULL NULL NULL 57.50000000 169.77500000 0.00000000 83.04500000 -425.17500000 1966.00000000 1.50000000
AAAAAAAAAMBBAAAA NULL NULL NULL 40.00000000 95.70000000 0.00000000 77.51000000 -616.40000000 1957.00000000 2.00000000
AAAAAAAAAMEBAAAA NULL NULL NULL 80.00000000 265.17000000 0.00000000 259.86000000 12813.60000000 1945.00000000 1.00000000
AAAAAAAAAMFAAAAA NULL NULL NULL 9.00000000 106.27000000 100.80000000 36.13000000 -186.12000000 1986.00000000 2.00000000
AAAAAAAAAMNDAAAA NULL NULL NULL 75.00000000 279.81000000 0.00000000 184.67000000 6855.00000000 1932.00000000 5.00000000
AAAAAAAAANBDAAAA NULL NULL NULL 72.00000000 153.82000000 0.00000000 15.38000000 -5185.44000000 1925.00000000 5.00000000
AAAAAAAAANDDAAAA NULL NULL NULL 1.00000000 39.81000000 0.00000000 21.89000000 -9.96000000 1948.00000000 1.00000000
AAAAAAAAANECAAAA NULL NULL NULL 88.00000000 81.66000000 1724.23000000 20.41000000 -4656.39000000 1979.00000000 5.00000000
AAAAAAAAANFEAAAA NULL NULL NULL 67.00000000 99.39500000 0.00000000 71.65500000 872.32500000 1930.50000000 2.50000000
AAAAAAAAANGDAAAA NULL NULL NULL 26.00000000 181.15000000 0.00000000 86.95000000 572.52000000 1941.00000000 1.00000000
AAAAAAAAANIBAAAA NULL NULL NULL 47.00000000 204.11000000 0.00000000 187.78000000 4321.65000000 1933.00000000 3.00000000
AAAAAAAAAOCAAAAA NULL NULL NULL 6.00000000 63.71000000 0.00000000 57.97000000 198.48000000 1964.00000000 0.00000000
AAAAAAAAAODAAAAA NULL NULL NULL 25.00000000 77.35000000 0.00000000 76.57000000 36.75000000 1959.00000000 3.00000000
AAAAAAAAAOFDAAAA NULL NULL NULL 27.00000000 80.65000000 0.00000000 64.52000000 414.18000000 1968.00000000 6.00000000
AAAAAAAAAOMCAAAA NULL NULL NULL 35.00000000 69.58000000 0.00000000 34.79000000 -71.05000000 1973.00000000 4.00000000
AAAAAAAAAPBEAAAA NULL NULL NULL 67.00000000 136.27000000 2218.43000000 36.79000000 -4341.66000000 1925.00000000 0.00000000
AAAAAAAAAPEDAAAA NULL NULL NULL 80.00000000 64.41000000 0.00000000 0.00000000 -3874.40000000 1928.00000000 3.00000000
AAAAAAAAAPFAAAAA NULL NULL NULL 60.00000000 105.50000000 0.00000000 15.82000000 -4197.60000000 1977.00000000 2.00000000



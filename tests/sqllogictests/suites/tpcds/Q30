# Q30
query I
WITH customer_total_return AS
  (SELECT wr_returning_customer_sk AS ctr_customer_sk,
          ca_state AS ctr_state,
          sum(wr_return_amt) AS ctr_total_return
   FROM web_returns,
        date_dim,
        customer_address
   WHERE wr_returned_date_sk = d_date_sk
     AND d_year = 2002
     AND wr_returning_addr_sk = ca_address_sk
   GROUP BY wr_returning_customer_sk,
            ca_state)
SELECT c_customer_id,
       c_salutation,
       c_first_name,
       c_last_name,
       c_preferred_cust_flag,
       c_birth_day,
       c_birth_month,
       c_birth_year,
       c_birth_country,
       c_login,
       c_email_address,
       c_last_review_date_sk,
       ctr_total_return
FROM customer_total_return ctr1,
     customer_address,
     customer
WHERE ctr1.ctr_total_return >
    (SELECT avg(ctr_total_return)*1.2
     FROM customer_total_return ctr2
     WHERE ctr1.ctr_state = ctr2.ctr_state)
  AND ca_address_sk = c_current_addr_sk
  AND ca_state = 'GA'
  AND ctr1.ctr_customer_sk = c_customer_sk
ORDER BY c_customer_id NULLS FIRST,
         c_salutation NULLS FIRST,
         c_first_name NULLS FIRST,
         c_last_name NULLS FIRST,
         c_preferred_cust_flag NULLS FIRST,
         c_birth_day NULLS FIRST,
         c_birth_month NULLS FIRST,
         c_birth_year NULLS FIRST,
         c_birth_country NULLS FIRST,
         c_login NULLS FIRST,
         c_email_address NULLS FIRST,
         c_last_review_date_sk NULLS FIRST,
         ctr_total_return NULLS FIRST
LIMIT 100;
----
AAAAAAAAADMABAAA Sir Rory Smiley N 9 8 1989 MONGOLIA NULL Rory.Smiley@xRmNvF3BSborAXB.com 2452636 3008.81
AAAAAAAAAEKBBAAA Dr. Loretta Bridges N 25 5 1958 SAN MARINO NULL Loretta.Bridges@UXaK1eg3Dcfo.edu 2452429 2250.18
AAAAAAAAAHIKAAAA Mr. Antwan Ward Y 21 1 1947 ESTONIA NULL Antwan.Ward@Ixq56KHO9.org 2452524 2517.51
AAAAAAAAAJKGBAAA Miss Anna Anderson Y 5 5 1966 BELIZE NULL Anna.Anderson@7.com 2452416 1473.92
AAAAAAAAANNNAAAA Ms. Cindy Julian N 4 8 1982 UGANDA NULL Cindy.Julian@ChEB5eyUCBe.org 2452368 1779.33
AAAAAAAAAPKEAAAA Mr. Glenn Valles Y 28 6 1955 ALBANIA NULL Glenn.Valles@Cj2vbPbx1xLdB.edu 2452371 3465.79
AAAAAAAABDJABAAA Mr. Kevin Franks Y 6 2 1961 BULGARIA NULL Kevin.Franks@iGE1sQRQGtQbamvdP.org 2452597 2905.92
AAAAAAAABEIEBAAA Sir Elmer James Y 16 4 1988 BELGIUM NULL Elmer.James@F1.com 2452429 1968.81
AAAAAAAABIKAAAAA Dr. Ted Griffin Y 13 8 1974 UNITED KINGDOM NULL Ted.Griffin@gLKPKl8cyF0l42ylb3.com 2452421 2570.68
AAAAAAAABKDGAAAA Mr. Michael Sanchez Y 11 2 1970 EQUATORIAL GUINEA NULL Michael.Sanchez@DjMMbvMBEyvRSZV.com 2452451 3265.58
AAAAAAAABMIKAAAA Sir Brandon Cox Y 19 8 1938 HONG KONG NULL Brandon.Cox@OF7btjVyXeMhFT.org 2452395 1907.74
AAAAAAAABMLBAAAA Ms. Rosemary Montano N 4 4 1924 ISRAEL NULL Rosemary.Montano@AtUPB5OVRdqC9D.com 2452414 1666.17
AAAAAAAABOBGAAAA Mr. Kevin NULL Y NULL NULL 1971 RUSSIAN FEDERATION NULL Kevin.Ferrell@Csy.com 2452490 1602.27
AAAAAAAABOOCAAAA Mrs. Regina Jenkins Y 13 9 1955 CYPRUS NULL Regina.Jenkins@nRUUGdD4fHhO.org 2452335 3656.03
AAAAAAAABPAHAAAA Mrs. Tamika King N 18 6 1925 PERU NULL Tamika.King@VHgBlGGOcnSl.edu 2452459 1989.96
AAAAAAAABPMFBAAA Dr. David Carpenter N 23 11 1956 BOUVET ISLAND NULL David.Carpenter@Esuy0KvlddbFfsE.edu 2452372 1493.50
AAAAAAAACAAABAAA Miss Wilma Thomas N 17 9 1972 HONDURAS NULL Wilma.Thomas@rYcd4ngxaOMkmYr.edu 2452538 2042.25
AAAAAAAACBOBAAAA Sir Douglas Robertson N 24 11 1937 HAITI NULL Douglas.Robertson@9815MMcaFa51KG.edu 2452420 6155.52
AAAAAAAACCHLAAAA Dr. Matthew Villanueva N 14 9 1952 ANGUILLA NULL Matthew.Villanueva@XVxD9jI18.com 2452451 2408.08
AAAAAAAACDHDBAAA Sir Joseph Nguyen Y 10 8 1971 PUERTO RICO NULL Joseph.Nguyen@MTmo4cvId3Q7nGXSJ.org 2452369 4859.76
AAAAAAAACECCAAAA Dr. Silvia Delarosa Y 20 10 1962 CHRISTMAS ISLAND NULL Silvia.Delarosa@f2cKXd2.edu 2452418 2354.48
AAAAAAAACGILAAAA Sir Nolan Mosley N 20 3 1980 KENYA NULL Nolan.Mosley@5E.org 2452317 2251.92
AAAAAAAACJNAAAAA Miss Amanda Jenkins Y 11 8 1992 NEW CALEDONIA NULL Amanda.Jenkins@RYY0.edu 2452328 7112.52
AAAAAAAACKBABAAA Mrs. Melba Murray Y 4 5 1972 GAMBIA NULL Melba.Murray@t.com 2452566 2918.81
AAAAAAAACKIAAAAA Dr. Gus Daniels Y 10 1 1959 MYANMAR NULL Gus.Daniels@tnsylH6LVcoNigpT.edu 2452442 2803.95
AAAAAAAACLLHAAAA Sir Mark Ortiz N 22 11 1948 MALI NULL Mark.Ortiz@LE04hhytdHH.edu 2452509 2971.47
AAAAAAAACNBBBAAA Sir Harry Fredericks N 30 7 1956 WESTERN SAHARA NULL Harry.Fredericks@X.edu 2452414 1680.15
AAAAAAAACNNIAAAA Dr. Catherine Hamilton Y 21 11 1931 UGANDA NULL Catherine.Hamilton@RQNQ76hUfhG.org 2452640 1929.90
AAAAAAAADAEABAAA Miss Inez Johnson N NULL 5 1944 THAILAND NULL NULL NULL 2318.16
AAAAAAAADEBFAAAA Dr. Lance Smith N 19 7 1987 NIUE NULL Lance.Smith@QJq6ZJL.org 2452540 1958.67
AAAAAAAADFIMAAAA Mr. Joel Patino N 15 10 1943 ICELAND NULL Joel.Patino@PDiG3QgFrc.org 2452476 1833.37
AAAAAAAADNHPAAAA Mr. John Mathews Y 23 2 1925 NICARAGUA NULL John.Mathews@UOtpEd.edu 2452543 4467.01
AAAAAAAADNLBAAAA Sir William Windsor N 13 11 1957 EGYPT NULL William.Windsor@hSEQd7xxYEtlDxSuO.org 2452423 8892.65
AAAAAAAAEAFJAAAA Mr. Gregory Quigley N 7 2 1945 LIECHTENSTEIN NULL Gregory.Quigley@igDNe2KaaZYCqc9.org 2452585 7594.26
AAAAAAAAEGJKAAAA Sir Jeffery Butler N 6 3 1942 PORTUGAL NULL Jeffery.Butler@gjnBrG.com 2452333 4483.36
AAAAAAAAEIBAAAAA Sir Kelly Lee N 5 1 1939 MONACO NULL Kelly.Lee@6sQsIKA.org 2452394 3174.60
AAAAAAAAEJOCAAAA Mrs. Beverley Bishop Y 28 2 1977 BHUTAN NULL Beverley.Bishop@fy.com 2452443 1514.95
AAAAAAAAEKBNAAAA Dr. Frank Downs N 12 1 1958 TAJIKISTAN NULL Frank.Downs@J2DP.org 2452633 5446.20
AAAAAAAAELNPAAAA Ms. Michelle Paige N 10 8 1962 JAMAICA NULL Michelle.Paige@9qK.com 2452336 1832.48
AAAAAAAAENNEAAAA Sir NULL Benjamin NULL 29 NULL NULL LUXEMBOURG NULL NULL 2452567 1905.60
AAAAAAAAFAACBAAA Mrs. Nella Watson Y 16 3 1978 WESTERN SAHARA NULL Nella.Watson@reTaRAGxI7.com 2452415 2103.12
AAAAAAAAFDAEAAAA Miss Judy Caro Y 21 7 1931 NAURU NULL Judy.Caro@YNTDmyDfMBc.org 2452311 3474.00
AAAAAAAAFFHGBAAA Mrs. Gwen Rouse N 24 8 1927 SURINAME NULL Gwen.Rouse@Rs3hZOm.edu 2452512 1732.77
AAAAAAAAFFNCBAAA Mr. Martin White Y 14 1 1981 GHANA NULL Martin.White@xF.org 2452459 11884.80
AAAAAAAAFJPIAAAA Dr. Ardell Fisher Y 2 2 1964 MALDIVES NULL Ardell.Fisher@KrN7K.edu 2452607 1902.32
AAAAAAAAGBMCBAAA Dr. William Mccall N 22 10 1961 KUWAIT NULL William.Mccall@gpoocaHj8ScbcX.edu 2452511 1689.45
AAAAAAAAGFECAAAA Dr. Pablo Hubbard N 28 6 1932 ESTONIA NULL Pablo.Hubbard@1z5fQdqQuDRJl8FopG.edu 2452501 2419.84
AAAAAAAAGGAGBAAA Dr. Min Paulsen N 16 7 1975 RÃ‰UNION NULL Min.Paulsen@jiZ2mZgEo.edu 2452539 1832.51
AAAAAAAAGIFEAAAA Dr. NULL NULL Y 12 NULL NULL NULL NULL NULL NULL 1647.38
AAAAAAAAGIFHBAAA Sir Joe Jackson Y 31 10 1969 FRENCH POLYNESIA NULL Joe.Jackson@eHmBJ4QqjNKJypF.com 2452534 6005.52
AAAAAAAAGKICBAAA Sir James Anthony N 25 7 1957 BOUVET ISLAND NULL James.Anthony@XKoCgT00ycNMY0m.org 2452322 1993.68
AAAAAAAAGNFPAAAA Dr. Jessica Hudson N 6 3 1964 SWEDEN NULL Jessica.Hudson@8.org 2452592 7876.70
AAAAAAAAGOMCBAAA Miss Catherine Caro Y 25 11 1942 HUNGARY NULL Catherine.Caro@TJgh.edu 2452356 3075.80
AAAAAAAAHGABAAAA NULL Tommie Rodriguez NULL NULL NULL NULL NULL NULL NULL NULL 2067.20
AAAAAAAAHGJHBAAA Sir Scott Jackson Y 17 3 1964 SEYCHELLES NULL Scott.Jackson@Vb4ptPa.org 2452376 4164.78
AAAAAAAAHIBJAAAA Dr. Lily Baker N 6 4 1952 MALAWI NULL Lily.Baker@oPX12I9iMgeUZ.org 2452397 4898.16
AAAAAAAAHIBJAAAA Dr. Lily Baker N 6 4 1952 MALAWI NULL Lily.Baker@oPX12I9iMgeUZ.org 2452397 7158.72
AAAAAAAAHIHDAAAA Miss Adrienne Edwards N 26 3 1976 BELARUS NULL Adrienne.Edwards@tAxcsF3mPGBa.org 2452480 2909.55
AAAAAAAAHKBBAAAA Ms. Linda Crawford N 13 2 1924 KIRIBATI NULL Linda.Crawford@xOf5kYDZapQmj.org 2452598 5318.88
AAAAAAAAHMBJAAAA Dr. Susan Kelly N 6 2 1932 GUINEA NULL Susan.Kelly@eIEoIUCAHKPAZF.com 2452415 2481.96
AAAAAAAAHMJNAAAA Sir Ryan Baptiste Y 4 7 1952 DENMARK NULL Ryan.Baptiste@tSsPxdJl.com 2452467 2700.00
AAAAAAAAIAOAAAAA Ms. Deborah Jackson Y 10 2 1946 NULL NULL NULL 2452578 3627.60
AAAAAAAAIBGJAAAA Dr. Angela Wells Y 3 1 1942 ARGENTINA NULL Angela.Wells@XH1JhO9ozvMSj3.edu 2452454 1951.56
AAAAAAAAICPIAAAA Sir Richard Thompson N 14 12 1990 UNITED KINGDOM NULL Richard.Thompson@D5m46t1.com 2452312 6165.95
AAAAAAAAIECMAAAA Dr. Juana Wagner N 2 10 1950 TRINIDAD AND TOBAGO NULL Juana.Wagner@xfBBhRVjVgVgoY.edu 2452322 4004.00
AAAAAAAAIEHGAAAA Mrs. Sharon Mays Y 5 8 1962 ESTONIA NULL Sharon.Mays@CLyHp2obU3A.org 2452636 6035.25
AAAAAAAAIELMAAAA Miss Francie Gordon N 19 10 1929 VENEZUELA NULL Francie.Gordon@tVIlZ3.org 2452423 5857.20
AAAAAAAAIFGABAAA Miss Tracie Crum Y 27 2 1933 ISLE OF MAN NULL Tracie.Crum@GtXbgfR8.org 2452631 8594.52
AAAAAAAAIHBPAAAA NULL NULL NULL NULL NULL NULL 1932 KIRIBATI NULL Martha.Mitchell@0Uh.edu NULL 1911.15
AAAAAAAAIHJDAAAA Dr. James Jackson Y 25 8 1957 MONTENEGRO NULL James.Jackson@p.com 2452408 1855.00
AAAAAAAAIIODAAAA Dr. Nellie Moore Y 11 3 1977 BULGARIA NULL Nellie.Moore@xkhqVhk5E9nXszC.edu 2452310 1925.59
AAAAAAAAIJLPAAAA Sir Jonathan Watson N 22 3 1930 GEORGIA NULL Jonathan.Watson@NUM3AzmvDR2pZKT.com 2452614 2423.50
AAAAAAAAIKFGAAAA Ms. Claudia Rivera N 3 8 1966 NEW CALEDONIA NULL Claudia.Rivera@nlnf5taGZIcSPU.org 2452527 2942.92
AAAAAAAAINFFAAAA Dr. NULL Dailey NULL NULL 7 1924 NULL NULL Ruth.Dailey@s9PpQ.org 2452316 3294.22
AAAAAAAAIOCCAAAA Dr. James Johnson N 25 11 1930 COSTA RICA NULL James.Johnson@RUsXaM.com 2452513 3315.76
AAAAAAAAIOECBAAA Dr. Ira Luther Y 4 2 1954 YEMEN NULL Ira.Luther@Ym4iUs5yxS34f.org 2452337 4632.73
AAAAAAAAIOIGAAAA Mrs. Jacqueline Thomas Y 1 10 1931 GERMANY NULL Jacqueline.Thomas@phbUiJs3bDLouyy.edu 2452445 2712.10
AAAAAAAAIPICAAAA Sir Elliott Reed Y 2 5 1981 SWAZILAND NULL Elliott.Reed@MspB.com 2452621 1628.43
AAAAAAAAJAKDBAAA Ms. Rhoda Hall Y 26 8 1928 AUSTRALIA NULL Rhoda.Hall@Y.edu 2452333 3830.22
AAAAAAAAJDJCAAAA Dr. Megan Jones Y 26 6 1959 SWITZERLAND NULL Megan.Jones@b.org 2452573 1798.50
AAAAAAAAJKDFAAAA Mr. Kevin Garcia Y 1 7 1956 TOGO NULL Kevin.Garcia@Dr6Fu6Lqv3GiVA.edu 2452554 7995.12
AAAAAAAAJMIIAAAA Ms. Lisa Allard Y 22 4 1927 HONDURAS NULL Lisa.Allard@g.edu 2452567 1730.08
AAAAAAAAJNKCBAAA Ms. NULL NULL Y 1 NULL NULL JAPAN NULL Deidre.Price@1D98ZZJSV1L4Jms.org NULL 2427.75
AAAAAAAAJOBCAAAA Mr. Russell Hernandez N 21 6 1945 BOTSWANA NULL Russell.Hernandez@qE151KR9LkpEt.org 2452449 2559.15
AAAAAAAAKCJKAAAA Ms. Lisa Battle Y 31 7 1976 ANDORRA NULL Lisa.Battle@31IJMXuC.com 2452387 7860.75
AAAAAAAAKCMFBAAA Miss NULL NULL N 16 12 1981 NULL NULL Helene.Miller@tfSsvu0BRUlz6ifO.edu 2452638 2110.05
AAAAAAAAKDNGBAAA Sir Loren Armstrong Y 11 4 1961 TONGA NULL Loren.Armstrong@ir.org 2452297 2771.25
AAAAAAAAKDPCAAAA Dr. Maurice Purdy Y 11 11 1948 GREENLAND NULL Maurice.Purdy@Itahx9Qp.org 2452609 1524.96
AAAAAAAAKFCBAAAA Ms. Jennifer Winter Y 8 4 1937 URUGUAY NULL Jennifer.Winter@L3OBxIRA9rLQr.com 2452329 4397.88
AAAAAAAAKGDMAAAA Sir Howard Ellis N 8 3 1943 BOLIVIA NULL Howard.Ellis@SY4B39dAmpqQ.com 2452618 2031.48
AAAAAAAAKGJEBAAA Dr. Paul Rowe N 26 8 1992 ECUADOR NULL Paul.Rowe@oMouzBdUFHEID.edu 2452393 3901.04
AAAAAAAAKGKEBAAA Dr. George Mccann N 8 4 1946 IRELAND NULL George.Mccann@M20e3mM2j3XgVEg.edu 2452399 5908.44
AAAAAAAAKJNBBAAA Mrs. Christine Guerra N 3 8 1973 FIJI NULL Christine.Guerra@Op0La1.edu 2452493 3243.26
AAAAAAAAKPAFBAAA Mr. Derek Williams N 20 1 1956 JAMAICA NULL Derek.Williams@nnsyNV0VxaoD.org 2452399 4867.52
AAAAAAAALBNGAAAA Sir Lewis Bates N 11 10 1984 MALTA NULL Lewis.Bates@NfK9CjJG3CAJDm.edu 2452496 2769.69
AAAAAAAALCJFAAAA Mr. Rudy Wright Y 8 3 1982 JORDAN NULL Rudy.Wright@0.com 2452425 3389.80
AAAAAAAALCOEAAAA Mrs. Esperanza Foret N 23 4 1944 BULGARIA NULL Esperanza.Foret@nC.com 2452374 3380.41
AAAAAAAALJHFAAAA Ms. Gloria Helm N 3 4 1936 CHILE NULL Gloria.Helm@3.edu 2452312 3216.85
AAAAAAAALJKCBAAA Miss Marietta Turley Y 23 10 1961 DOMINICA NULL Marietta.Turley@gEpUDfZRgx4A4V.com 2452398 4185.32
AAAAAAAALKEMAAAA Ms. Karen Amos N 7 2 1941 UZBEKISTAN NULL Karen.Amos@fGUJPbIL4c.edu 2452543 1879.91



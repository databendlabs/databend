# Q93
query I
SELECT ss_customer_sk,
       sum(act_sales) sumsales
FROM
  (SELECT ss_item_sk,
          ss_ticket_number,
          ss_customer_sk,
          CASE
              WHEN sr_return_quantity IS NOT NULL THEN (ss_quantity-sr_return_quantity)*ss_sales_price
              ELSE (ss_quantity*ss_sales_price)
          END act_sales
   FROM store_sales
   LEFT OUTER JOIN store_returns ON (sr_item_sk = ss_item_sk
                                     AND sr_ticket_number = ss_ticket_number) ,reason
   WHERE sr_reason_sk = r_reason_sk
     AND r_reason_desc = 'reason 28') t
GROUP BY ss_customer_sk
ORDER BY sumsales NULLS FIRST,
         ss_customer_sk NULLS FIRST
LIMIT 100;
----
693 NULL
893 NULL
2146 NULL
2243 NULL
2301 NULL
2757 NULL
2902 NULL
4088 NULL
4221 NULL
4392 NULL
4413 NULL
5772 NULL
6198 NULL
6512 NULL
6768 NULL
6825 NULL
6881 NULL
7561 NULL
7819 NULL
8112 NULL
8616 NULL
8796 NULL
8903 NULL
9101 NULL
9313 NULL
9391 NULL
9867 NULL
9921 NULL
10225 NULL
10317 NULL
10427 NULL
10540 NULL
10557 NULL
11766 NULL
11885 NULL
12609 NULL
13145 NULL
13197 NULL
13411 NULL
14246 NULL
14264 NULL
14316 NULL
15108 NULL
15383 NULL
15544 NULL
15699 NULL
15756 NULL
16609 NULL
16696 NULL
17074 NULL
17078 NULL
17392 NULL
18061 NULL
18267 NULL
18479 NULL
18650 NULL
18682 NULL
19361 NULL
20000 NULL
20025 NULL
20057 NULL
20533 NULL
21219 NULL
21684 NULL
22295 NULL
23758 NULL
24374 NULL
24476 NULL
24561 NULL
24682 NULL
24716 NULL
24725 NULL
25116 NULL
25557 NULL
26107 NULL
26154 NULL
26856 NULL
26962 NULL
27021 NULL
27257 NULL
27391 NULL
27753 NULL
27835 NULL
27957 NULL
29327 NULL
29911 NULL
29972 NULL
30588 NULL
31036 NULL
31178 NULL
31610 NULL
32029 NULL
32625 NULL
33494 NULL
33754 NULL
33908 NULL
34212 NULL
35466 NULL
35499 NULL
35653 NULL



# TPC-DS spill test
statement ok
set sandbox_tenant = 'test_tenant';

statement ok
use tpcds;

statement ok
set max_memory_usage = 1024*1024*200;

# TPC-DS TEST
include ./Q76
include ./Q77
include ./Q78
include ./Q79
include ./Q80
include ./Q81
include ./Q82
include ./Q83
include ./Q84
include ./Q85
include ./Q86
include ./Q87
include ./Q88
include ./Q89
include ./Q90
include ./Q91
include ./Q92
include ./Q93
include ./Q94
include ./Q95
include ./Q96
include ./Q97
include ./Q98
include ./Q99

statement ok
set max_block_size = 2;

statement ok
create or replace table t as select 0 AS c1, i_category as c2 from (select i_category, i_class from item group by i_category, i_class) limit 60;

query T
select sum(rank) from (select rank() over (partition by c1, c2) as rank FROM t);
----
60

statement ok
drop table if exists t;

statement ok
unset max_block_size;

statement ok
UNSET max_memory_usage;

# Q7
query I
SELECT i_item_id,
       avg(ss_quantity) agg1,
       avg(ss_list_price) agg2,
       avg(ss_coupon_amt) agg3,
       avg(ss_sales_price) agg4
FROM store_sales,
     customer_demographics,
     date_dim,
     item,
     promotion
WHERE ss_sold_date_sk = d_date_sk
  AND ss_item_sk = i_item_sk
  AND ss_cdemo_sk = cd_demo_sk
  AND ss_promo_sk = p_promo_sk
  AND cd_gender = 'M'
  AND cd_marital_status = 'S'
  AND cd_education_status = 'College'
  AND (p_channel_email = 'N'
       OR p_channel_event = 'N')
  AND d_year = 2000
GROUP BY i_item_id
ORDER BY i_item_id
LIMIT 100;
----
AAAAAAAAAAABAAAA 9.0 86.25000000 0.00000000 75.03000000
AAAAAAAAAAACAAAA 25.0 149.41000000 0.00000000 94.12000000
AAAAAAAAAAAEAAAA 16.0 127.87000000 0.00000000 26.85000000
AAAAAAAAAABBAAAA 18.0 23.43000000 0.00000000 3.98000000
AAAAAAAAAABEAAAA 20.5 85.01000000 0.00000000 42.05000000
AAAAAAAAAACAAAAA 69.0 46.44000000 0.00000000 33.04000000
AAAAAAAAAACCAAAA 44.0 96.28000000 0.00000000 17.32500000
AAAAAAAAAACDAAAA 6.0 91.86000000 0.00000000 65.22000000
AAAAAAAAAADBAAAA 4.0 6.81000000 0.00000000 1.29000000
AAAAAAAAAADCAAAA 33.0 14.31000000 0.00000000 5.15000000
AAAAAAAAAADEAAAA 41.0 143.37000000 0.00000000 53.04000000
AAAAAAAAAAEAAAAA 53.0 6.24000000 0.00000000 0.81000000
AAAAAAAAAAEBAAAA 8.0 130.54000000 166.65000000 54.82000000
AAAAAAAAAAEDAAAA 58.5 20.72500000 94.32000000 2.33500000
AAAAAAAAAAFDAAAA 34.0 63.64000000 0.00000000 57.91000000
AAAAAAAAAAGEAAAA 39.0 51.10500000 0.00000000 13.66500000
AAAAAAAAAAHDAAAA 41.0 114.77000000 0.00000000 19.51000000
AAAAAAAAAAICAAAA 33.0 57.62500000 0.00000000 31.98500000
AAAAAAAAAAIDAAAA 67.0 7.37000000 0.00000000 2.43000000
AAAAAAAAAAJCAAAA 78.0 138.16000000 0.00000000 64.93000000
AAAAAAAAAAKBAAAA 6.0 132.76000000 0.00000000 45.13000000
AAAAAAAAAALCAAAA 81.0 85.45000000 1685.64000000 23.92000000
AAAAAAAAAAMBAAAA 73.0 93.67000000 0.00000000 88.98000000
AAAAAAAAAAMCAAAA 72.0 74.92000000 0.00000000 52.44000000
AAAAAAAAAANAAAAA 42.0 12.40000000 0.00000000 4.09000000
AAAAAAAAAANBAAAA 96.0 101.48000000 0.00000000 33.48000000
AAAAAAAAAAOAAAAA 53.5 89.59500000 0.00000000 46.41500000
AAAAAAAAAAPBAAAA 42.0 157.66000000 0.00000000 141.89000000
AAAAAAAAAAPCAAAA 62.0 86.38500000 1130.30000000 24.99500000
AAAAAAAAABAAAAAA 60.5 40.89000000 0.00000000 19.50000000
AAAAAAAAABABAAAA 48.4 61.44800000 0.00000000 27.55200000
AAAAAAAAABADAAAA 24.0 39.48000000 0.00000000 7.50000000
AAAAAAAAABAEAAAA 19.0 134.54000000 0.00000000 9.41000000
AAAAAAAAABBCAAAA 64.5 95.83000000 942.16500000 63.67000000
AAAAAAAAABDEAAAA 70.0 23.54000000 0.00000000 15.77000000
AAAAAAAAABEAAAAA 49.0 103.24000000 163.61000000 53.29500000
AAAAAAAAABECAAAA 45.0 10.28000000 0.00000000 6.06000000
AAAAAAAAABEDAAAA 39.0 65.82000000 0.00000000 61.87000000
AAAAAAAAABFBAAAA 13.0 3.72000000 41.08000000 3.16000000
AAAAAAAAABFCAAAA 37.0 50.43000000 0.00000000 21.68000000
AAAAAAAAABFEAAAA 74.0 99.30000000 0.00000000 66.53000000
AAAAAAAAABGBAAAA 30.5 76.28000000 0.00000000 72.68500000
AAAAAAAAABGDAAAA 64.5 75.82000000 0.00000000 7.83500000
AAAAAAAAABHAAAAA 34.0 75.79500000 0.00000000 16.15000000
AAAAAAAAABHCAAAA 99.0 137.32000000 0.00000000 59.04000000
AAAAAAAAABHDAAAA 65.5 90.75500000 181.02000000 48.29500000
AAAAAAAAABJAAAAA 27.0 53.11000000 731.55000000 33.45000000
AAAAAAAAABJBAAAA 39.5 77.09000000 0.00000000 62.35500000
AAAAAAAAABJDAAAA 99.0 54.06000000 0.00000000 15.13000000
AAAAAAAAABKAAAAA 86.0 120.96000000 0.00000000 62.89000000
AAAAAAAAABKDAAAA 15.0 80.31000000 0.00000000 53.00000000
AAAAAAAAABMAAAAA 51.0 68.18000000 0.00000000 4.09000000
AAAAAAAAABMDAAAA 23.0 40.50000000 0.00000000 5.67000000
AAAAAAAAABNAAAAA 34.0 9.24000000 0.00000000 1.01000000
AAAAAAAAABNCAAAA 39.5 62.94500000 0.00000000 6.23500000
AAAAAAAAABOBAAAA 68.5 104.74500000 0.00000000 54.46500000
AAAAAAAAABOCAAAA 87.66666666666667 79.13666667 0.00000000 35.98333333
AAAAAAAAABPBAAAA 30.0 166.98000000 1178.10000000 93.50000000
AAAAAAAAACACAAAA 20.0 73.30000000 0.00000000 2.19000000
AAAAAAAAACADAAAA 94.0 59.07000000 310.57000000 4.72000000
AAAAAAAAACBBAAAA 77.5 40.59500000 101.86500000 31.78000000
AAAAAAAAACBEAAAA 100.0 29.26000000 0.00000000 21.35000000
AAAAAAAAACCDAAAA 34.666666666666664 48.54000000 8.89666667 20.20333333
AAAAAAAAACCEAAAA 52.0 90.90000000 0.00000000 82.71000000
AAAAAAAAACDAAAAA 71.0 96.50000000 0.00000000 59.83000000
AAAAAAAAACDCAAAA 18.0 74.08000000 0.00000000 22.22000000
AAAAAAAAACEBAAAA 11.0 74.91000000 0.00000000 29.96000000
AAAAAAAAACFBAAAA 14.0 100.82000000 0.00000000 14.11000000
AAAAAAAAACGAAAAA 27.0 102.07000000 264.51000000 40.82000000
AAAAAAAAACGDAAAA 44.0 80.40333333 35.06666667 11.29333333
AAAAAAAAACHBAAAA 51.0 43.48000000 0.00000000 7.39000000
AAAAAAAAACHCAAAA 31.5 69.50000000 39.30500000 50.23500000
AAAAAAAAACIAAAAA 47.0 115.42000000 0.00000000 49.63000000
AAAAAAAAACIBAAAA 71.0 40.76000000 0.00000000 13.04000000
AAAAAAAAACIDAAAA 32.0 144.04000000 0.00000000 0.00000000
AAAAAAAAACJAAAAA 31.0 63.82000000 0.00000000 26.16000000
AAAAAAAAACLAAAAA 67.0 110.90000000 0.00000000 66.54000000
AAAAAAAAACLDAAAA 15.333333333333334 74.35000000 183.17000000 33.98333333
AAAAAAAAACMDAAAA 14.0 110.41000000 153.01000000 60.72000000
AAAAAAAAACNCAAAA 13.0 134.29000000 0.00000000 106.08000000
AAAAAAAAACOAAAAA 30.5 118.67500000 1036.32000000 71.35000000
AAAAAAAAACPAAAAA 63.0 46.11000000 0.00000000 8.76000000
AAAAAAAAACPCAAAA 8.5 65.13500000 0.00000000 45.20000000
AAAAAAAAACPDAAAA 59.0 18.81000000 0.00000000 8.27000000
AAAAAAAAADABAAAA 24.5 77.53000000 0.00000000 29.44000000
AAAAAAAAADACAAAA 71.0 20.41000000 0.00000000 7.55000000
AAAAAAAAADAEAAAA 87.0 94.72000000 0.00000000 38.83000000
AAAAAAAAADBBAAAA 39.0 39.39000000 0.00000000 21.66000000
AAAAAAAAADBDAAAA 46.5 72.95500000 0.00000000 52.29500000
AAAAAAAAADBEAAAA 99.0 158.80000000 0.00000000 103.22000000
AAAAAAAAADCAAAAA 32.0 22.86000000 0.00000000 16.91000000
AAAAAAAAADCCAAAA 62.5 23.38500000 0.00000000 10.97500000
AAAAAAAAADDBAAAA 94.0 99.37000000 0.00000000 31.79000000
AAAAAAAAADDCAAAA 16.0 27.87000000 6.50000000 0.83000000
AAAAAAAAADDEAAAA 60.666666666666664 124.66333333 0.00000000 33.31000000
AAAAAAAAADEBAAAA 50.0 94.73500000 0.00000000 26.32500000
AAAAAAAAADEEAAAA 81.0 99.57000000 0.00000000 51.77000000
AAAAAAAAADFAAAAA 1.0 112.96000000 4.11000000 29.36000000
AAAAAAAAADGBAAAA 45.0 51.96500000 0.00000000 16.13000000
AAAAAAAAADGCAAAA 16.0 75.18000000 0.00000000 23.30000000



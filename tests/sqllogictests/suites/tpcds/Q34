# Q34
query I
SELECT c_last_name ,
       c_first_name ,
       c_salutation ,
       c_preferred_cust_flag ,
       ss_ticket_number ,
       cnt
FROM
  (SELECT ss_ticket_number ,
          ss_customer_sk ,
          count(*) cnt
   FROM store_sales,
        date_dim,
        store,
        household_demographics
   WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk
     AND store_sales.ss_store_sk = store.s_store_sk
     AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
     AND (date_dim.d_dom BETWEEN 1 AND 3
          OR date_dim.d_dom BETWEEN 25 AND 28)
     AND (household_demographics.hd_buy_potential = '>10000'
          OR household_demographics.hd_buy_potential = 'Unknown')
     AND household_demographics.hd_vehicle_count > 0
     AND (CASE
              WHEN household_demographics.hd_vehicle_count > 0 THEN (household_demographics.hd_dep_count*1.000)/ household_demographics.hd_vehicle_count
              ELSE NULL
          END) > 1.2
     AND date_dim.d_year IN (1999,
                             1999+1,
                             1999+2)
     AND store.s_county = 'Williamson County'
   GROUP BY ss_ticket_number,
            ss_customer_sk) dn,
     customer
WHERE ss_customer_sk = c_customer_sk
  AND cnt BETWEEN 15 AND 20
ORDER BY c_last_name NULLS FIRST,
         c_first_name NULLS FIRST,
         c_salutation NULLS FIRST,
         c_preferred_cust_flag DESC NULLS FIRST,
         ss_ticket_number NULLS FIRST;
----
NULL NULL NULL NULL 46266 15
NULL NULL NULL NULL 57507 16
NULL NULL NULL NULL 151297 15
NULL NULL NULL Y 96514 15
NULL NULL NULL Y 129227 15
NULL NULL NULL Y 134349 15
NULL NULL NULL N 1281 16
NULL NULL NULL N 37443 15
NULL NULL Mr. NULL 167512 15
NULL NULL Mr. Y 214003 15
NULL NULL Mr. N 171917 15
NULL NULL Ms. NULL 54536 15
NULL Brian Sir Y 147361 15
NULL Elizabeth NULL NULL 8949 16
NULL George Dr. Y 229713 15
NULL Grace NULL NULL 147095 15
NULL Joshua Sir Y 108357 15
NULL Judy Dr. NULL 234350 15
NULL Karen Dr. Y 121790 15
NULL Paul NULL NULL 158955 16
NULL Timothy Sir N 207936 16
Adams Willie Sir Y 88285 16
Akers Susan Miss N 239968 15
Alexander Annie Dr. N 72228 16
Alexander April Miss Y 180849 16
Alford Deborah Miss Y 97678 15
Allen David Sir Y 132301 15
Allen Kenneth Sir Y 89944 16
Alvarado Susan Ms. Y 35570 15
Alves Sam Dr. Y 129660 15
Anderson Cindy Miss N 90504 16
Anderson Eloise Mrs. N 59994 16
Anderson Martha Mrs. Y 74295 16
Anderson Norma Miss Y 132983 15
Anderson Rosemarie Mrs. Y 178489 15
Andrews Cindy Miss Y 132595 15
Andrews Robert Sir Y 30467 16
Anthony Steven Dr. Y 210849 15
Archibald Cindy Miss Y 87178 16
Arnold Kimberly Mrs. Y 233183 15
Arsenault Janet Mrs. N 169973 16
Bailey Anita Mrs. Y 212443 15
Bailey Lucille Mrs. Y 2490 15
Bailey Steve Mr. Y 91065 15
Baker Elijah Sir N 97264 16
Baker Erik Sir Y 69511 16
Baker Robert Dr. Y 28481 15
Ballard Eleanor Miss N 38446 16
Barnes Michael Mr. N 168802 15
Barnes Mikel Sir N 102567 16
Bates Beverly Miss N 122717 15
Battle Lashanda Dr. N 88515 15
Bear Tommy Sir N 27468 16
Bender Grover Dr. Y 152239 16
Benedict Bridget Dr. N 16544 15
Benson Mike Sir Y 53219 16
Bernard Eric Sir N 83015 15
Bernstein Stephen Sir N 177678 15
Berry Theresa Ms. Y 77257 15
Blake John Mr. N 193896 15
Blanchard Joanne Dr. Y 5917 16
Blanco John Sir Y 145319 15
Bohn Steven Mr. N 219031 16
Boles George Sir N 64282 15
Bourgeois Betty Miss Y 167229 15
Bowden Kathleen Ms. Y 106265 15
Boyd Mildred Miss N 190083 15
Boyle Timothy Dr. Y 21865 15
Broome Anthony Miss N 169148 15
Brower Ann Ms. N 230732 15
Brower Donald Dr. N 163579 15
Brown Charles Mr. Y 221610 15
Brown David Mr. Y 162755 15
Brown Janice Ms. N 138617 15
Brown Roderick Mr. Y 221290 16
Brown Will Mr. N 147392 15
Bruno Darren Mr. Y 198805 15
Bryant Marvin Dr. N 188014 15
Buckley Charles Dr. Y 17491 15
Burch Diana Mrs. Y 115522 16
Burgess Clark Dr. Y 124990 15
Burris Fred Mr. N 234453 15
Butcher Francine Mrs. Y 112093 15
Byrd Jose Dr. Y 144511 15
Cabrera Jaqueline Mrs. N 81629 15
Callahan Kenneth Mr. N 110667 16
Campbell Gordon Mr. N 196090 16
Carpenter Stephen Mr. N 174519 15
Carroll Frederick Mr. N 56635 16
Carson Angel Mrs. Y 94684 15
Carter Charlie Mr. Y 34411 15
Carter Eddie Dr. N 226103 16
Carter Johnny Dr. NULL 95699 15
Carter Olga Mrs. Y 84776 15
Cavazos Louise Ms. Y 213729 15
Chacon Cathy Miss N 81284 15
Chandler Lisa Dr. N 102461 15
Chase Daniel Dr. N 129179 16
Cheek Rebecca Mrs. N 82193 15
Chesser Constance Dr. N 47117 15
Christenson Allison Miss N 152842 16
Clark Charles Dr. N 194512 15
Clark Elisa Mrs. N 234445 16
Clark Elizabeth Dr. Y 58831 15
Clark Rosemary Miss N 31542 15
Cochran Dennis Sir Y 94375 15
Coker John Mr. Y 2730 15
Cole June Miss Y 206225 15
Coleman Evan Dr. N 139495 15
Coleman Nancy Ms. Y 39446 15
Collins Marguerite Mrs. N 202352 15
Colson Darcy Miss N 18961 15
Conrad Jason Mr. Y 166289 15
Cook NULL Sir NULL 81755 15
Cook John Mr. Y 237195 15
Cope Felicia Dr. Y 195003 15
Corwin Rene Sir N 98796 15
Cota Jorge Mr. Y 3324 16
Coughlin Valerie Ms. N 161399 15
Cruz Donna Ms. Y 180864 15
Dalton Dorthea Dr. N 37698 15
David Timothy Mr. Y 20342 15
Davies Ruben Sir N 232060 15
Davis Donald Dr. N 50931 15
Davis Maegan Miss N 59792 15
Davis Ronald Sir N 213719 16
Davis Sandra Ms. N 141249 15
Davison Jeffrey Mr. N 81413 15
Day Arturo Mr. N 25501 15
Dean Latonya Dr. N 45372 15
Delagarza John Mr. Y 62980 15
Delgado Marilyn Ms. Y 201044 15
Delong Marybelle Mrs. N 17565 15
Dempsey Kristy Mrs. N 148060 15
Dennis Lee Sir Y 119489 15
Diaz Brian Mr. N 73210 16
Dickerson Bessie Mrs. Y 196201 16
Dietrich Tammy Dr. Y 114650 15
Dorsey Lisa Dr. Y 5587 15
Dube Ray Mr. N 233056 15
Dumont Jason Dr. N 6941 15
Eason Mario Sir Y 174089 16
Edgar Lisa Mrs. Y 37606 15
Edwards Anthony Ms. N 31471 16
Elliot Mark Mr. N 35782 15
Emerson Melissa Mrs. N 156199 15
Epps William Mr. Y 43680 15
Estes Elizabeth Mrs. N 176718 15
Ferrell Roy Mr. N 139997 15
Ferris William Sir Y 12536 15
Fields Philomena Dr. Y 217374 15
Fife Terry Dr. Y 81012 16
Fisher Christopher Sir N 45467 15
Fitzgerald Thomas Mr. N 2698 16
Fletcher Russell Sir N 42951 15
Flores Elizabeth Ms. Y 214688 16
Forbes Robert Mr. N 175736 15
Forrest Nicholas Mr. N 230893 16
Fuqua Harvey Mr. Y 130609 16
Galvin Josephine Dr. Y 235213 16
Garcia Dalton Mr. N 82145 15
Garcia Kenny Dr. Y 197122 16
Garcia Marie Ms. N 224067 15
Garcia Vera Dr. Y 227613 15
Gardner Wanda Ms. Y 182977 15
German Katie Dr. Y 33536 15
Gifford Cathy Ms. Y 188658 15
Gilbreath Andrea Mrs. N 209039 15
Gill Joshua Sir N 230910 15
Godwin Sharon Ms. Y 220509 16
Gomez Amanda Mrs. N 22490 16
Gomez Brandon Sir N 160457 15
Goodwin Fred Mr. N 93828 16
Gordon Roger Sir N 88367 15
Gorham Jason Mr. Y 68420 15
Graham Brian Mr. Y 13629 15
Graham Jerry Sir NULL 152656 15
Graham Tandra Mrs. N 103566 15
Gray Cole Mr. Y 30280 16
Gray Jeffery Mr. Y 154258 15
Gray Marshall Dr. Y 138913 15
Grayson Terry Mr. N 130480 16
Green Michael Dr. Y 143191 15
Green Robert Mr. Y 73965 16
Greene Willie Sir N 85413 15
Griffin Martha Dr. Y 82841 16
Gutierrez Ashley Dr. N 209948 16
Guzman Mason Mr. N 235019 15
Haley Henry Sir N 141619 16
Hamilton Alex Mrs. N 23084 15
Hammonds Richelle Dr. N 135423 16
Hammonds Wendy Miss N 107817 15
Handy John Mr. N 50651 15
Harris Charles Dr. N 61618 15
Harris Ezekiel Sir N 142043 15
Harris Karmen Ms. Y 73434 15
Harris Sam Sir N 61242 15
Harrison Holly Mrs. N 197654 15
Harrison Michal Mr. Y 209687 15
Hart Carroll Mr. Y 165744 16
Harwood James Mr. Y 197429 16
Hayes Johnnie Sir N 57732 16
Haynes Jennifer Dr. Y 203136 15
Hernandez Kyle Dr. Y 59668 16
Hernandez Melonie Dr. N 120302 15
Hewitt Michelle Dr. Y 155492 16
Hill Lorena Miss N 41444 16
Hobbs Richard Mr. Y 24027 15
Holland Melinda Mrs. Y 76237 15
Holt James Dr. N 110248 15
Huffman Laura Mrs. Y 225321 15
Hughes Martin Dr. Y 178631 15
Isom Jessica Dr. Y 193785 15
Jackman Ida Dr. Y 11753 16
Jackson Jack Sir N 228975 15
Jacobs Kathy Ms. Y 66259 15
Jaramillo NULL Ms. NULL 107981 15
Jarman Evangeline Miss Y 233260 15
Jensen Roscoe Mr. Y 10819 16
Johnson Beverly Dr. N 7637 15
Johnson Glenn Dr. N 190780 15
Johnson Ola Mrs. N 87442 15
Johnson Olen Mr. N 12862 16
Johnson Ramon Dr. Y 72434 16
Johnson Terri Miss N 14075 15
Johnston Walter Mr. Y 219689 15
Joseph Ramon Mr. N 7856 16
Joyce NULL Ms. NULL 154184 15
Kane Phyllis Mrs. Y 159162 15
Kay Robert Sir Y 22999 15
Keefer Stephen Sir N 94450 15
Kelley Janet Dr. N 209622 16
Kemp Wanda Dr. Y 119906 15
Kennedy David Sir Y 114462 15
King Frank Mr. Y 100779 15
King Thomas Sir Y 62796 15
Kinney Angelica Mrs. N 192978 15
Kline Donald Mr. N 161957 16
Kraus Roger Dr. Y 117604 15
Kruse Jose Dr. N 114533 15
Lacy Mina Miss Y 227155 15
Lancaster David Mr. Y 214962 15
Landry Kaylene Dr. Y 86610 15
Larsen Russell Sir N 154877 15
Law Horace Mr. Y 157178 16
Lawson Amanda Ms. Y 61212 16
Ledbetter Dena Dr. N 135044 15
Lee Edward Mr. N 184034 16
Leonard Debra Dr. Y 158368 15
Levin Robert Dr. N 231293 16
Levy Marjorie Ms. Y 24429 15
Lewis Annie Ms. N 131418 16
Lewis Bradley Sir Y 182566 15
Lewis Jerry Mr. Y 233447 15
Light Robert Mr. N 90021 15
Long Bradley Sir Y 11712 15
Lopez Randee Miss Y 9979 15
Lopez Theresa Miss N 169110 15
Low Timothy Sir N 10488 15
Lowe Elmer Sir Y 133003 16
Lowery Marie Ms. N 10643 15
Macias Roger Sir N 82746 16
Mack Bonnie Miss N 103028 15
Mann Russell Sir Y 29737 15
Manning David Dr. Y 147404 15
Mansfield Paul Dr. Y 5723 15
Marks Duane Dr. N 34432 15
Marrero Susanna Mrs. N 102535 15
Marsh Gary Sir N 6580 15
Martin Caren Ms. N 169732 15
Martin Lena Mrs. N 6954 15
Martin Steve Mr. Y 72094 15
Martinez Henry Mr. Y 134637 15
Martino NULL Ms. NULL 61890 15
Mason Richard Sir N 27500 16
Matos Josephine Ms. Y 128283 16
Mccallister Andrew Ms. Y 122178 16
Mcconnell Scott Mr. Y 78305 15
Mccormick Joanne Ms. N 236985 15
Mcdonald Araceli Ms. Y 121343 16
Mcintyre Lee Sir Y 229633 16
Mcswain Virgil Mr. N 71937 16
Merrill Ming Miss Y 85806 16
Meyer William Sir Y 53235 15
Milam Gwendolyn Miss N 51944 15
Miller Dennis Dr. Y 137781 15
Miller Georgia Ms. Y 40740 15
Miller Larry Sir N 233614 15
Miller Marshall Dr. N 171497 16
Miller Nancy Mrs. Y 82671 15
Miller Robert Sir Y 42361 16
Mitchell Cristobal Mr. N 67082 15
Monk NULL Dr. NULL 213814 15
Montgomery Julie Miss N 17471 15
Moreland John Mr. Y 37985 15
Morgan Betty Dr. N 90306 16
Morris John Dr. Y 214378 15
Morrow Annette Dr. N 68649 16
Mulkey Evette Miss Y 70472 15
Mulligan Mark Sir Y 184598 15
Myers Christina Miss N 160380 15
Naranjo Barbara Mrs. N 45938 15
Neeley Stephanie Mrs. Y 216299 16
Nesbitt Andrew Miss N 185257 16
Newman Herschel Mr. Y 3829 16
Norfleet Ethel Miss N 14366 15
Odell Lona Ms. Y 160018 15
Odum David Dr. N 86314 15
Ohara Ronald Dr. Y 142825 15
Olds Stephen Dr. Y 206275 15
Olsen Ruben Sir Y 29076 15
Oneill Thomas Mr. Y 93473 16
Oneill Thomas Mr. Y 188154 15
Osborn Lena Miss Y 226949 15
Outlaw Valerie Dr. N 139286 15
Palacios Alma Miss Y 136540 16
Parker Kari Ms. N 67553 15
Payne Warren Dr. Y 180016 16
Peace Carlos Sir N 203823 15
Peck Jose Dr. N 100636 15
Pederson Matthew Mr. Y 152234 15
Perez Harold Mr. N 6311 16
Perez Sheri Ms. Y 157585 16
Perkins Jill Miss Y 145614 15
Perry Sarah Ms. Y 100885 15
Phelan Micheal NULL N 118503 15
Phelps Marco Dr. N 86494 15
Phillips Judith Mrs. N 155042 16
Pinto Charles Sir N 932 16
Pitts Marissa Dr. N 114581 15
Poirier Marine Miss N 11423 15
Pool Sylvester Sir N 213306 16
Powell Robert Sir Y 185862 15
Price Florence Ms. Y 17220 15
Price Paul Sir Y 103985 15
Price Reginald Sir N 123793 15
Pritchett Cecil Mr. N 38968 15
Ramirez Lee Sir N 234584 15
Redden Edgar Sir N 48534 16
Reece Jimmy Sir N 166493 15
Reyes NULL Ms. Y 83162 15
Rice Sherry Ms. Y 202456 15
Richards Marilyn Dr. N 177798 15
Richardson Alice Ms. N 43255 16
Rios John Dr. Y 138605 15
Ritchie Terrell Dr. N 174749 15
Rivera Gary Dr. Y 24449 15
Rivera Kate Ms. Y 204524 15
Roark Kenneth Mr. Y 167963 15
Roberson Suzanne Mrs. Y 41652 15
Roberts Candice Dr. Y 111855 16
Roberts Jennifer Miss Y 141296 15
Roberts May Ms. N 209690 15
Robinson Gary Mr. Y 87081 15
Robinson Robert Mr. Y 57177 15
Robinson Sara Mrs. N 190406 16
Rodriguez Linda Ms. N 209909 15
Rodriguez Marjorie Ms. N 83591 15
Roldan Dorothy Mrs. N 9370 16
Roman Jimmie Dr. N 221049 15
Ross Rachael Mrs. N 106042 15
Rowe Keith Dr. Y 145862 15
Roy Betty Mrs. N 36106 15
Russell Carl Sir N 190517 16
Russell Larry Dr. Y 15209 16
Salter Antonio Miss N 27497 15
Sampson Helen Mrs. Y 81717 15
Sanders David Sir N 95107 16
Sanders Dustin Mr. N 20319 15
Sanford Ronald Sir Y 211947 16
Schneider Marvin Mr. Y 80017 15
Scott Adam Mrs. Y 13944 15
Scott Gilbert Dr. N 186743 15
Scott Michael Mr. N 104162 16
Seidel Wilma NULL NULL 198108 15
Self Harry Sir Y 102208 16
Sharp Sondra Dr. Y 206153 15
Shelton James Dr. N 18103 15
Shelton Rex Mr. Y 53510 15
Sheppard Joseph Dr. N 55721 16
Shuler Joseph Sir Y 57224 15
Sims Fern Dr. N 175233 15
Sims John Dr. Y 113923 16
Smith Dalene Ms. Y 143125 16
Smith Gerald Dr. Y 87759 15
Smith Herbert Dr. Y 238646 15
Smith Joanne Miss Y 34335 15
Smith Ralph Sir N 87132 15
Smith Sara Miss Y 7453 16
Smith Steven Sir Y 25132 15
Smith Terry Dr. N 16945 16
Snell Robert Mr. Y 237726 15
Snyder Harry Mr. N 237793 15
Spencer Alfred Mr. N 159308 16
Stanton Eric Dr. N 116291 15
Stephens Alma Ms. N 196929 16
Stephens Donna Ms. N 151844 15
Stevens Everett Mr. Y 160909 15
Stevens Micheal Dr. Y 38659 16
Stevenson Dan Mr. Y 67850 15
Stewart Amanda Mrs. Y 145235 15
Stewart Pamela Mrs. N 88160 16
Stowe Teresa Miss N 64714 15
Street Barry Sir N 232396 15
Sullivan Amy Dr. N 166225 15
Swain Laura Ms. Y 36774 15
Taylor Heather Dr. Y 8049 15
Taylor Karen Dr. N 29777 16
Taylor Robert Dr. Y 37700 15
Thomas Barbara Dr. N 172596 15
Thomas Hazel Ms. Y 174853 16
Thomas Jeffrey Dr. N 115846 15
Thomas Nichole Miss Y 200721 16
Thomas Rebecca Mrs. N 80953 15
Thompson Eleanor Dr. Y 126349 15
Thompson Melissa Dr. Y 162831 15
Thompson Ruth Mrs. N 158091 15
Tilley Jane Mrs. Y 45378 15
Tinsley Charlie Dr. N 23881 16
Tolbert Emily Miss Y 40132 16
Tolley Leo Mr. N 154182 15
Tompkins Charlotte NULL NULL 197857 15
Torres Jason Dr. Y 224 15
Toth Luis Sir Y 113792 15
Townsend Bonnie Dr. Y 211674 15
Townsend Michelle Mrs. N 39872 15
Treadwell Roberto Sir N 104915 16
Turner Marjorie Mrs. N 65289 15
Vanhorn Linda Mrs. N 134112 16
Vargas Charles Dr. N 79536 15
Walker Carolyn Mrs. N 157430 16
Walker Charles Sir Y 186002 15
Walker Donald Sir N 88588 15
Walker Jose Sir N 189670 16
Walter Pam Dr. Y 112910 15
Warren Brian Dr. Y 15877 15
Watson Tina Ms. Y 120030 16
Webb Gloria Ms. N 65663 15
Weber Adeline Miss N 11061 15
West Rachel Dr. Y 138384 16
Wetzel Bebe Dr. Y 82518 16
Wheeler Lee Dr. N 27440 15
White Diane Dr. N 82960 16
Whitehead Magan Dr. Y 192159 16
Wiggins Kermit Sir Y 112643 16
Wilbur Terry Sir N 200312 15
Williams Archie Mr. Y 113007 15
Williams Roger Dr. N 62444 16
Willis James Mr. Y 125924 15
Willis Michael Sir Y 207326 15
Wilson Charles Mr. N 60 15
Windham Goldie Mrs. N 26519 15
Woody Philip Mr. N 211173 15
Wright Nichole Miss N 171969 15
Yates Kimberly Ms. N 220849 15



# Q15
query I
SELECT ca_zip,
       sum(cs_sales_price)
FROM catalog_sales,
     customer,
     customer_address,
     date_dim
WHERE cs_bill_customer_sk = c_customer_sk
  AND c_current_addr_sk = ca_address_sk
  AND (SUBSTRING(ca_zip, 1, 5) IN ('85669',
                                '86197',
                                '88274',
                                '83405',
                                '86475',
                                '85392',
                                '85460',
                                '80348',
                                '81792')
       OR ca_state IN ('CA',
                       'WA',
                       'GA')
       OR cs_sales_price > 500)
  AND cs_sold_date_sk = d_date_sk
  AND d_qoy = 2
  AND d_year = 2001
GROUP BY ca_zip
ORDER BY ca_zip NULLS FIRST
LIMIT 100;
----
NULL 3808.17
30059 629.58
30069 542.70
30150 593.88
30162 1942.92
30169 1364.41
30191 355.63
30194 151.28
30309 148.26
30330 507.01
30399 209.99
30411 601.45
30492 230.45
30499 1229.00
30525 317.77
30534 1404.16
30587 150.75
31087 215.97
31289 625.91
31387 1565.54
31675 282.77
31692 230.63
31749 362.62
31757 1845.67
31838 885.98
31952 1019.36
32219 907.80
32293 606.00
32477 325.80
32565 284.81
32724 297.51
32739 976.60
32812 1567.58
32898 1081.14
33003 457.44
33075 201.49
33394 211.08
33451 1656.55
33511 384.88
33604 2229.05
33683 561.92
33951 1054.35
34027 785.92
34062 515.76
34092 554.13
34098 359.40
34107 1718.39
34136 398.47
34190 219.63
34244 1147.34
34289 684.50
34338 1406.56
34466 2017.42
34536 373.57
34593 950.67
34854 706.14
34975 420.61
35038 348.73
35115 391.48
35124 1205.24
35281 495.07
35413 293.50
35508 342.05
35709 278.63
35752 456.32
35804 957.30
35817 2321.38
35867 633.77
36060 77.57
36074 227.99
36098 707.28
36115 586.16
36192 854.04
36523 381.53
36534 1842.41
36557 1758.07
36614 1390.67
36668 578.39
36719 973.96
36787 417.77
36867 950.64
36871 780.24
36971 853.07
37057 2554.08
37683 786.39
37746 2115.63
37838 841.27
38014 308.95
38048 1202.38
38054 1385.96
38075 890.35
38119 196.75
38222 2628.49
38354 2902.80
38370 1656.08
38371 528.33
38579 541.48
38605 247.85
38721 2315.94
38828 298.60



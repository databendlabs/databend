statement ok
drop table if exists t_uuid

statement ok
create table t_uuid(id string default uuid(), a int)

statement ok
remove @data/csv/unload/uuid

query III
copy into @data/csv/unload/uuid/ from (select NULL,1 )  file_format = (type = CSV null_display='')
----
1 3 3


query TIITI
copy into t_uuid from @data/csv/unload/uuid file_format = (type = CSV) RETURN_FAILED_ONLY=TRUE
----

query TI
select * from t_uuid
----
NULL 1

query TIITI
copy into t_uuid from @data/csv/unload/uuid file_format = (type = CSV  empty_field_as=null) force=true RETURN_FAILED_ONLY=TRUE
----

query TI
select * from t_uuid
----
NULL 1
NULL 1

query III
copy into @data/csv/unload/uuid/ from (select NULL,1 )  file_format = (type = CSV null_display='')
----
1 3 3

statement ok
truncate table t_uuid

query TIITI
copy into t_uuid from @data/csv/unload/uuid file_format = (type = CSV  empty_field_as=field_default) force=true RETURN_FAILED_ONLY=TRUE
----

query I
select uniq(id) from t_uuid
----
2

statement ok
DROP DATABASE IF EXISTS db1

statement ok
CREATE DATABASE db1

statement ok
USE db1

statement ok
drop table if exists t

statement ok
create table t(c0 tuple(int, int) not null, c1 string null)

statement error 1006
insert into t(c1) values(null), (null), (null)

statement ok
insert into t(c0,c1) values((0,0),null), ((0,0),null), ((0,0),null)

query I
select count(c1) from t
----
0

query I
select count(c0) from t
----
3

## test #issue13932
statement ok
create table t3(a int not null,b text);

statement error 1006
insert into t3(b) values('a');

statement error 1006
insert into t3(a) values(null);

statement ok
insert into t3(a) values(1);

statement ok
insert into t3(a,b) values(1,'a');

statement ok
drop table if exists t

## count distinct rewrite keeps NULL-filtered semantics
statement ok
drop table if exists test_count_distinct_nulls

statement ok
create table test_count_distinct_nulls(g int, a int, b int)

statement ok
insert into test_count_distinct_nulls values
    (1, 1, 1),
    (1, 1, NULL),
    (1, NULL, 1),
    (1, NULL, NULL),
    (2, 1, 1),
    (2, 1, 2),
    (2, NULL, 2)

query II
select g, count(distinct a, b) as cnt from test_count_distinct_nulls group by g order by g
----
1 1
2 2

query II
select g, count(*) as cnt from (
    select g, a, b
    from test_count_distinct_nulls
    where a is not null and b is not null
    group by g, a, b
) d
group by g
order by g
----
1 1
2 2

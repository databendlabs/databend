statement ok
DROP DATABASE IF EXISTS showcolumn

statement ok
CREATE DATABASE showcolumn

statement ok
CREATE TABLE showcolumn.t1(c1 int not null) ENGINE = Null

statement ok
CREATE TABLE showcolumn.t2(c1 int not null) ENGINE = Null

statement ok
CREATE TABLE showcolumn.t3(c1 int null default 4, c2 Datetime not null default '2022-02-02 12:00:00', c3 String not null Default 'c3') ENGINE = Null;

query TTTT??
SHOW COLUMNS FROM default.showcolumn.t3
----
c1 int YES 4 NULL NULL
c2 timestamp NO '2022-02-02 12:00:00.000000' NULL NULL
c3 varchar(16382) NO 'c3' NULL NULL

statement ok
CREATE TABLE showcolumn.t4(c1 int comment '4', c2 Datetime comment '2022-02-02 12:00:00', c3 String comment 'c\s3') ENGINE = Null;

query T
select comment from system.columns where database='showcolumn' and table='t4' order by name;
----
4
2022-02-02 12:00:00
c\s3

query TT
select column_name, column_comment from information_schema.columns where table_schema='showcolumn' and table_name='t4' order by column_name;
----
c1 4
c2 2022-02-02 12:00:00
c3 c\s3

statement ok
use showcolumn

query TTTT??T?T
SHOW FULL COLUMNS IN t3
----
c1 int YES 4 NULL NULL NULL NULL (empty)
c2 timestamp NO '2022-02-02 12:00:00.000000' NULL NULL NULL NULL (empty)
c3 varchar(16382) NO 'c3' NULL NULL utf8mb4_general_ci NULL (empty)

query TTTT??T?T
SHOW FULL COLUMNS IN t3 like '%1';
----
c1 int YES 4 NULL NULL NULL NULL (empty)

query TTTT??
SHOW COLUMNS IN t3 where column_name like '%1';
----
c1 int YES 4 NULL NULL

query TTTT??T?T
SHOW FULL COLUMNS IN t3 where is_nullable!='YES' and default like '%2022-02-02 12:00:00.000000%';
----
c2 timestamp NO '2022-02-02 12:00:00.000000' NULL NULL NULL NULL (empty)


query TTTT??T?T
SHOW FULL COLUMNS IN columns from system
----
comment varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
data_type varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
database varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
default_expression varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
default_kind varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
is_nullable varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
name varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
table varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
type varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)

query TTTT??
SHOW COLUMNS IN columns from system like '%type%'
----
data_type varchar(16382) NO (empty) NULL NULL
type varchar(16382) NO (empty) NULL NULL

query TTTT??
SHOW COLUMNS IN columns from system where column_name != '%type%' and is_nullable!='YES'
----
comment varchar(16382) NO (empty) NULL NULL
data_type varchar(16382) NO (empty) NULL NULL
database varchar(16382) NO (empty) NULL NULL
default_expression varchar(16382) NO (empty) NULL NULL
default_kind varchar(16382) NO (empty) NULL NULL
is_nullable varchar(16382) NO (empty) NULL NULL
name varchar(16382) NO (empty) NULL NULL
table varchar(16382) NO (empty) NULL NULL
type varchar(16382) NO (empty) NULL NULL

query TTTT??T?T
SHOW FULL COLUMNS IN columns from information_schema
----
character_maximum_length smallint unsigned YES (empty) NULL NULL NULL NULL (empty)
character_octet_length smallint unsigned YES (empty) NULL NULL NULL NULL (empty)
character_set_catalog null NO (empty) NULL NULL NULL NULL (empty)
character_set_name varchar(16382) YES (empty) NULL NULL utf8mb4_general_ci NULL (empty)
character_set_schema null NO (empty) NULL NULL NULL NULL (empty)
collation_catalog null NO (empty) NULL NULL NULL NULL (empty)
collation_name varchar(16382) YES (empty) NULL NULL utf8mb4_general_ci NULL (empty)
collation_schema null NO (empty) NULL NULL NULL NULL (empty)
column_comment varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
column_default null NO (empty) NULL NULL NULL NULL (empty)
column_key null NO (empty) NULL NULL NULL NULL (empty)
column_name varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
column_type varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
data_type varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
datetime_precision null NO (empty) NULL NULL NULL NULL (empty)
default varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
domain_catalog null NO (empty) NULL NULL NULL NULL (empty)
domain_name null NO (empty) NULL NULL NULL NULL (empty)
domain_schema null NO (empty) NULL NULL NULL NULL (empty)
extra null NO (empty) NULL NULL NULL NULL (empty)
is_nullable varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
nullable tinyint unsigned YES (empty) NULL NULL NULL NULL (empty)
numeric_precision null NO (empty) NULL NULL NULL NULL (empty)
numeric_precision_radix null NO (empty) NULL NULL NULL NULL (empty)
numeric_scale null NO (empty) NULL NULL NULL NULL (empty)
ordinal_position tinyint unsigned NO (empty) NULL NULL NULL NULL (empty)
privileges null NO (empty) NULL NULL NULL NULL (empty)
table_catalog varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
table_name varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)
table_schema varchar(16382) NO (empty) NULL NULL utf8mb4_general_ci NULL (empty)

query TTTT??
SHOW COLUMNS IN columns from information_schema like 'numeric%'
----
numeric_precision null NO (empty) NULL NULL
numeric_precision_radix null NO (empty) NULL NULL
numeric_scale null NO (empty) NULL NULL

query TTTT??
SHOW COLUMNS IN columns from information_schema where column_name != '%type%' and column_type!='NULL'
----
character_maximum_length smallint unsigned YES (empty) NULL NULL
character_octet_length smallint unsigned YES (empty) NULL NULL
character_set_catalog null NO (empty) NULL NULL
character_set_name varchar(16382) YES (empty) NULL NULL
character_set_schema null NO (empty) NULL NULL
collation_catalog null NO (empty) NULL NULL
collation_name varchar(16382) YES (empty) NULL NULL
collation_schema null NO (empty) NULL NULL
column_comment varchar(16382) NO (empty) NULL NULL
column_default null NO (empty) NULL NULL
column_key null NO (empty) NULL NULL
column_name varchar(16382) NO (empty) NULL NULL
column_type varchar(16382) NO (empty) NULL NULL
data_type varchar(16382) NO (empty) NULL NULL
datetime_precision null NO (empty) NULL NULL
default varchar(16382) NO (empty) NULL NULL
domain_catalog null NO (empty) NULL NULL
domain_name null NO (empty) NULL NULL
domain_schema null NO (empty) NULL NULL
extra null NO (empty) NULL NULL
is_nullable varchar(16382) NO (empty) NULL NULL
nullable tinyint unsigned YES (empty) NULL NULL
numeric_precision null NO (empty) NULL NULL
numeric_precision_radix null NO (empty) NULL NULL
numeric_scale null NO (empty) NULL NULL
ordinal_position tinyint unsigned NO (empty) NULL NULL
privileges null NO (empty) NULL NULL
table_catalog varchar(16382) NO (empty) NULL NULL
table_name varchar(16382) NO (empty) NULL NULL
table_schema varchar(16382) NO (empty) NULL NULL

statement ok
DROP DATABASE showcolumn

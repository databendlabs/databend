statement ok
DROP DATABASE IF EXISTS seq_db

statement ok
CREATE DATABASE seq_db

statement ok
USE seq_db

statement ok
DROP SEQUENCE IF EXISTS seq

statement error 2004
CREATE SEQUENCE seq start = 1 increment = 0

statement ok
CREATE SEQUENCE seq

statement ok
DROP TABLE IF EXISTS tmp;

statement ok
DROP TABLE IF EXISTS tmp1;

statement ok
DROP TABLE IF EXISTS tmp2;

statement ok
DROP TABLE IF EXISTS tmp3;

statement ok
CREATE TABLE tmp(a uint64);

statement ok
CREATE TABLE tmp1(a string);

statement ok
CREATE TABLE tmp2(a uint64);

statement ok
CREATE TABLE tmp3(a int, b uint64, c int);


statement ok
INSERT INTO tmp1 values(nextval(seq));

statement ok
INSERT INTO tmp2 select nextval(seq) from numbers(2);

query I
select * from tmp2;
----
2
3

statement ok
INSERT INTO tmp2 values(nextval(seq)), (1024);

query I
select * from tmp2 order by a;
----
2
3
4
1024

statement ok
INSERT INTO tmp3 values(1,nextval(seq) + 1,3);

query III
select * from tmp3;
----
1 6 3

statement ok
INSERT INTO tmp3 select 10,nextval(seq),20 from numbers(3);

query III
select * from tmp3 order by b,a;
----
1 6 3
10 6 20
10 7 20
10 8 20

query I
select nextval(seq);
----
9

query I
select nextval(seq) + 20 from numbers(5);
----
30
31
32
33
34

query R
select cast(nextval(seq) as float);
----
15.0

query I
select sum(nextval(seq)) from numbers(10);
----
205

statement ok
INSERT INTO tmp select nextval(seq) from numbers(1000000);

query I
select count(*) from tmp;
----
1000000


query I
select uniq(nextval(seq)) from numbers(10000000);
----
10000000

query I
select uniq(nextval(seq)) from numbers(10000000);
----
10000000

query I
select uniq(nextval(seq)) from numbers(10000000);
----
10000000

statement ok
select nextval(seq) % 3 as c from numbers(1000000) group by c order by c;

statement ok
DESC SEQUENCE SEQ

statement ok
SHOW SEQUENCES

statement ok
DROP SEQUENCE seq

statement error 1126
DROP SEQUENCE seq

statement error 3101
INSERT INTO tmp3 values(1,nextval(seq),3);

statement ok
DROP TABLE IF EXISTS tmp;

statement ok
DROP TABLE IF EXISTS tmp1;

statement ok
DROP TABLE IF EXISTS tmp2;

statement ok
DROP TABLE IF EXISTS tmp3;

statement ok
CREATE OR REPLACE SEQUENCE seq;

statement error 1065
create or replace table t(id int default nextval(seq) + 1, name string);

statement error 1065
create or replace table t(id int, name string default nextval(seq));

statement ok
create or replace table t(id int default nextval(seq), name string);

statement ok
insert into t (name) values('a');

query IT
select * from t order by id;
----
1 a

statement ok
insert into t (name) values('b');

query IT
select * from t order by id;
----
1 a
2 b

statement ok
insert into t (name) values('c');

query IT
select * from t order by id;
----
1 a
2 b
3 c

statement error 1132
alter table t add column id2 int default nextval(seq);

statement ok
delete from t;

statement ok
alter table t add column id2 int default nextval(seq);

statement ok
insert into t (name) values('a'),('b'),('c');

query ITI
select * from t order by id;
----
4 a 7
5 b 8
6 c 9

statement ok
drop table t;

statement ok
CREATE OR REPLACE SEQUENCE seq start = 1 increment = 2;

statement ok
CREATE OR REPLACE table t2(id int default nextval(seq), name string);

statement ok
INSERT INTO t2(name) values('x'),('x'),('x');

statement ok
INSERT INTO t2(name) values('x'),('x'),('x');

query IT
select * from t2 order by id;
----
1 x
3 x
5 x
7 x
9 x
11 x

statement ok
DROP TABLE t2

statement ok
DROP SEQUENCE seq;

statement ok
DROP DATABASE seq_db;

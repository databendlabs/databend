statement ok
DROP FILE FORMAT IF EXISTS test_format

statement error 2507
DROP FILE FORMAT test_format

statement ok
CREATE FILE FORMAT test_format TYPE=CSV  FIELD_DELIMITER='\t' ESCAPE='\\'

statement ok
CREATE FILE FORMAT if not exists test_format TYPE=CSV

statement error 2509
CREATE FILE FORMAT test_format TYPE=CSV


query TT
show FILE FORMATS;
----
avro_raw TYPE = AVRO, NULL_FIELDS_AS = none
csv1 TYPE = CSV COMPRESSION = Auto FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 1 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_gzip TYPE = CSV COMPRESSION = Gzip FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_none TYPE = CSV COMPRESSION = None FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_raw TYPE = CSV COMPRESSION = None FIELD_DELIMITER = '#' RECORD_DELIMITER = '\n' QUOTE = '`' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_snappy TYPE = CSV COMPRESSION = Snappy FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_special TYPE = CSV COMPRESSION = None FIELD_DELIMITER = '|' RECORD_DELIMITER = '\n' QUOTE = '\'' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
csv_zip TYPE = CSV COMPRESSION = Zip FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
head_csv_format TYPE = CSV COMPRESSION = None FIELD_DELIMITER = ',' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 1 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
my_csv TYPE = CSV COMPRESSION = None FIELD_DELIMITER = '|' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
parquet_none TYPE = PARQUET MISSING_FIELD_AS = ERROR
parquet_null_if TYPE = PARQUET MISSING_FIELD_AS = ERROR
parquet_raw TYPE = PARQUET MISSING_FIELD_AS = ERROR
parquet_snappy TYPE = PARQUET MISSING_FIELD_AS = ERROR
replace_file_format TYPE = CSV COMPRESSION = None FIELD_DELIMITER = '\t' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '\\' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING
test_format TYPE = CSV COMPRESSION = None FIELD_DELIMITER = '\t' RECORD_DELIMITER = '\n' QUOTE = '\"' ESCAPE = '\\' SKIP_HEADER= 0 OUTPUT_HEADER= false NULL_DISPLAY = '\\N' NAN_DISPLAY = 'NaN' EMPTY_FIELD_AS = NULL BINARY_FORMAT = hex ERROR_ON_COLUMN_COUNT_MISMATCH = true ALLOW_QUOTED_NULLS = false QUOTED_EMPTY_FIELD_AS = STRING

statement ok
DROP FILE FORMAT test_format

statement error 2507
DROP FILE FORMAT test_format

statement ok
show FILE FORMATS

statement error 1005
CREATE FILE FORMAT csv TYPE=CSV

statement error Databend sqllogictests error: http query error: code: 2509, Text: UserDefinedFileFormat 'replace_file_format' already exists: Exist when add
CREATE FILE FORMAT replace_file_format TYPE=CSV;

statement error 1005
CREATE OR REPLACE FILE FORMAT IF NOT EXISTS replace_file_format TYPE=CSV  FIELD_DELIMITER='\t' ESCAPE='\\';

statement ok
CREATE OR REPLACE FILE FORMAT replace_file_format TYPE=CSV  FIELD_DELIMITER='\t' ESCAPE='\\';

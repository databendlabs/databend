query TIT
select name, size, creator from list_stage(location => '@data/udf/') order by name
----
udf/gcd.js 128 NULL
udf/test10-udf-wasm-gcd.tar.gz 8932 NULL
udf/test10_udf_wasm_gcd.wasm.zst 666082 NULL
udf/to_array.js 103 NULL

statement ok
CREATE OR REPLACE FUNCTION wasm_gcd (INT, INT) RETURNS INT LANGUAGE wasm HANDLER = 'wasm_gcd(int4,int4)->int4' AS $$@data/udf/test10_udf_wasm_gcd.wasm.zst$$

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select number, wasm_gcd(number * 3, number * 6) from numbers(5) where number > 0 order by 1;

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select  sum(wasm_gcd(number * 3, number * 6)) from numbers(5) where number > 0;

statement ok
CREATE OR REPLACE FUNCTION wasm_lcm (INT, INT) RETURNS INT LANGUAGE wasm HANDLER = 'wasm_lcm(int4,int4)->int4' AS $$@data/udf/test10_udf_wasm_gcd.wasm.zst$$

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select number, wasm_lcm(number * 3, number * 6) from numbers(5) where number > 0 order by 1;

statement ok
CREATE OR REPLACE FUNCTION wasm_factorial (INT) RETURNS INT LANGUAGE wasm HANDLER = 'wasm_factorial(int4)->int4' AS $$@data/udf/test10_udf_wasm_gcd.wasm.zst$$

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select number, wasm_factorial(number) from numbers(5) where number > 0 order by 1;

statement ok
CREATE OR REPLACE FUNCTION wasm_fibonacci (INT) RETURNS INT LANGUAGE wasm HANDLER = 'wasm_fibonacci(int4)->int4' AS $$@data/udf/test10_udf_wasm_gcd.wasm.zst$$

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select number, wasm_fibonacci(number) from numbers(5) where number > 0 order by 1;

statement ok
CREATE OR REPLACE FUNCTION wasm_is_prime (INT) RETURNS BOOLEAN LANGUAGE wasm HANDLER = 'wasm_is_prime(int4)->boolean' AS $$@data/udf/test10_udf_wasm_gcd.wasm.zst$$

query error Databend sqllogictests error: http query error: code: 1046, Text: Bad bytes, cannot parse bytes with UTF8, cause: invalid utf\-8 sequence of 1 bytes from index 9
select number, wasm_is_prime(number) from numbers(5) where number > 0 order by 1;

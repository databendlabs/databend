statement ok
drop database if exists testdb

statement ok
create database testdb

statement ok
use testdb

statement ok
create table t(a int, b int)

statement ok
insert into t select number, number + 1 from numbers(1000)

query T
explain(verbose, logical) select * from t where a = 1
----
EvalScalar
├── scalars: [t.a (#0) AS (#0), t.b (#1) AS (#1)]
├── output columns: [t.a (#0), t.b (#1)]
├── outer columns: []
├── used columns: [t.a (#0), t.b (#1)]
├── cardinality: 0.000
├── precise cardinality: N/A
├── statistics
└── Filter
    ├── filters: [eq(t.a (#0), 1)]
    ├── output columns: [t.a (#0), t.b (#1)]
    ├── outer columns: []
    ├── used columns: [t.a (#0), t.b (#1)]
    ├── cardinality: 0.000
    ├── precise cardinality: N/A
    ├── statistics
    └── Scan
        ├── table: testdb.t (#0)
        ├── filters: []
        ├── order by: []
        ├── limit: NONE
        ├── output columns: [t.a (#0), t.b (#1)]
        ├── outer columns: []
        ├── used columns: [t.a (#0), t.b (#1)]
        ├── cardinality: 0.000
        ├── precise cardinality: N/A
        └── statistics

query T
explain(verbose, logical, optimized) select * from t where a = 1
----
Scan
├── table: testdb.t (#0)
├── filters: [eq(t.a (#0), 1)]
├── order by: []
├── limit: NONE
├── output columns: [t.a (#0), t.b (#1)]
├── outer columns: []
├── used columns: [t.a (#0), t.b (#1)]
├── cardinality: 1.041
├── precise cardinality: N/A
└── statistics
    ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
    └── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }

query T
explain(verbose, logical, optimized) select * from t, t t1, t t2, t t3, t t4
where t.a = 1 and t1.a = 1 and t2.a = 1 and t3.a = 1 and t4.a = 1
----
Join(Cross)
├── build keys: []
├── probe keys: []
├── other filters: []
├── output columns: [t.a (#0), t.a (#2), t.a (#4), t.a (#6), t.a (#8), t.b (#1), t.b (#3), t.b (#5), t.b (#7), t.b (#9)]
├── outer columns: []
├── used columns: [t.a (#0), t.a (#2), t.a (#4), t.a (#6), t.a (#8), t.b (#1), t.b (#3), t.b (#5), t.b (#7), t.b (#9)]
├── cardinality: 1.220
├── precise cardinality: N/A
├── statistics
│   ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
│   ├── t.a (#2): { min: 1, max: 1, ndv: 1, null count: 0 }
│   ├── t.a (#4): { min: 1, max: 1, ndv: 1, null count: 0 }
│   ├── t.a (#6): { min: 1, max: 1, ndv: 1, null count: 0 }
│   ├── t.a (#8): { min: 1, max: 1, ndv: 1, null count: 0 }
│   ├── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }
│   ├── t.b (#3): { min: 1, max: 1000, ndv: 1, null count: 0 }
│   ├── t.b (#5): { min: 1, max: 1000, ndv: 1, null count: 0 }
│   ├── t.b (#7): { min: 1, max: 1000, ndv: 1, null count: 0 }
│   └── t.b (#9): { min: 1, max: 1000, ndv: 1, null count: 0 }
├── Scan
│   ├── table: testdb.t (#4)
│   ├── filters: [eq(t.a (#8), 1)]
│   ├── order by: []
│   ├── limit: NONE
│   ├── output columns: [t.a (#8), t.b (#9)]
│   ├── outer columns: []
│   ├── used columns: [t.a (#8), t.b (#9)]
│   ├── cardinality: 1.041
│   ├── precise cardinality: N/A
│   └── statistics
│       ├── t.a (#8): { min: 1, max: 1, ndv: 1, null count: 0 }
│       └── t.b (#9): { min: 1, max: 1000, ndv: 1, null count: 0 }
└── Join(Cross)
    ├── build keys: []
    ├── probe keys: []
    ├── other filters: []
    ├── output columns: [t.a (#0), t.a (#2), t.a (#4), t.a (#6), t.b (#1), t.b (#3), t.b (#5), t.b (#7)]
    ├── outer columns: []
    ├── used columns: [t.a (#0), t.a (#2), t.a (#4), t.a (#6), t.b (#1), t.b (#3), t.b (#5), t.b (#7)]
    ├── cardinality: 1.172
    ├── precise cardinality: N/A
    ├── statistics
    │   ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
    │   ├── t.a (#2): { min: 1, max: 1, ndv: 1, null count: 0 }
    │   ├── t.a (#4): { min: 1, max: 1, ndv: 1, null count: 0 }
    │   ├── t.a (#6): { min: 1, max: 1, ndv: 1, null count: 0 }
    │   ├── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }
    │   ├── t.b (#3): { min: 1, max: 1000, ndv: 1, null count: 0 }
    │   ├── t.b (#5): { min: 1, max: 1000, ndv: 1, null count: 0 }
    │   └── t.b (#7): { min: 1, max: 1000, ndv: 1, null count: 0 }
    ├── Scan
    │   ├── table: testdb.t (#3)
    │   ├── filters: [eq(t.a (#6), 1)]
    │   ├── order by: []
    │   ├── limit: NONE
    │   ├── output columns: [t.a (#6), t.b (#7)]
    │   ├── outer columns: []
    │   ├── used columns: [t.a (#6), t.b (#7)]
    │   ├── cardinality: 1.041
    │   ├── precise cardinality: N/A
    │   └── statistics
    │       ├── t.a (#6): { min: 1, max: 1, ndv: 1, null count: 0 }
    │       └── t.b (#7): { min: 1, max: 1000, ndv: 1, null count: 0 }
    └── Join(Cross)
        ├── build keys: []
        ├── probe keys: []
        ├── other filters: []
        ├── output columns: [t.a (#0), t.a (#2), t.a (#4), t.b (#1), t.b (#3), t.b (#5)]
        ├── outer columns: []
        ├── used columns: [t.a (#0), t.a (#2), t.a (#4), t.b (#1), t.b (#3), t.b (#5)]
        ├── cardinality: 1.127
        ├── precise cardinality: N/A
        ├── statistics
        │   ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
        │   ├── t.a (#2): { min: 1, max: 1, ndv: 1, null count: 0 }
        │   ├── t.a (#4): { min: 1, max: 1, ndv: 1, null count: 0 }
        │   ├── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }
        │   ├── t.b (#3): { min: 1, max: 1000, ndv: 1, null count: 0 }
        │   └── t.b (#5): { min: 1, max: 1000, ndv: 1, null count: 0 }
        ├── Scan
        │   ├── table: testdb.t (#2)
        │   ├── filters: [eq(t.a (#4), 1)]
        │   ├── order by: []
        │   ├── limit: NONE
        │   ├── output columns: [t.a (#4), t.b (#5)]
        │   ├── outer columns: []
        │   ├── used columns: [t.a (#4), t.b (#5)]
        │   ├── cardinality: 1.041
        │   ├── precise cardinality: N/A
        │   └── statistics
        │       ├── t.a (#4): { min: 1, max: 1, ndv: 1, null count: 0 }
        │       └── t.b (#5): { min: 1, max: 1000, ndv: 1, null count: 0 }
        └── Join(Cross)
            ├── build keys: []
            ├── probe keys: []
            ├── other filters: []
            ├── output columns: [t.a (#0), t.a (#2), t.b (#1), t.b (#3)]
            ├── outer columns: []
            ├── used columns: [t.a (#0), t.a (#2), t.b (#1), t.b (#3)]
            ├── cardinality: 1.083
            ├── precise cardinality: N/A
            ├── statistics
            │   ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
            │   ├── t.a (#2): { min: 1, max: 1, ndv: 1, null count: 0 }
            │   ├── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }
            │   └── t.b (#3): { min: 1, max: 1000, ndv: 1, null count: 0 }
            ├── Scan
            │   ├── table: testdb.t (#1)
            │   ├── filters: [eq(t.a (#2), 1)]
            │   ├── order by: []
            │   ├── limit: NONE
            │   ├── output columns: [t.a (#2), t.b (#3)]
            │   ├── outer columns: []
            │   ├── used columns: [t.a (#2), t.b (#3)]
            │   ├── cardinality: 1.041
            │   ├── precise cardinality: N/A
            │   └── statistics
            │       ├── t.a (#2): { min: 1, max: 1, ndv: 1, null count: 0 }
            │       └── t.b (#3): { min: 1, max: 1000, ndv: 1, null count: 0 }
            └── Scan
                ├── table: testdb.t (#0)
                ├── filters: [eq(t.a (#0), 1)]
                ├── order by: []
                ├── limit: NONE
                ├── output columns: [t.a (#0), t.b (#1)]
                ├── outer columns: []
                ├── used columns: [t.a (#0), t.b (#1)]
                ├── cardinality: 1.041
                ├── precise cardinality: N/A
                └── statistics
                    ├── t.a (#0): { min: 1, max: 1, ndv: 1, null count: 0 }
                    └── t.b (#1): { min: 1, max: 1000, ndv: 1, null count: 0 }

query T
explain(decorrelated,verbose) select a, exists(select * from numbers(1000) where number % 10 = t.b) mark from t;
----
EvalScalar
├── scalars: [t.a (#0) AS (#0), is_true(marker (#6)) AS (#3)]
├── output columns: [b (#5), mark (#3), marker (#6), numbers.number (#2), t.a (#0), t.b (#1)]
├── outer columns: []
├── used columns: [a (#4), b (#5), mark (#3), marker (#6), numbers.number (#2), t.a (#0), t.b (#1)]
├── cardinality: 0.000
├── precise cardinality: N/A
├── statistics
└── Join(RightMark)
    ├── build keys: [b (#5)]
    ├── probe keys: [t.b (#1)]
    ├── other filters: []
    ├── output columns: [b (#5), marker (#6), numbers.number (#2), t.a (#0), t.b (#1)]
    ├── outer columns: []
    ├── used columns: [a (#4), b (#5), numbers.number (#2), t.a (#0), t.b (#1)]
    ├── cardinality: 0.000
    ├── precise cardinality: N/A
    ├── statistics
    ├── EvalScalar
    │   ├── scalars: [numbers.number (#2) AS (#2), b (#5) AS (#5)]
    │   ├── output columns: [b (#5), numbers.number (#2)]
    │   ├── outer columns: []
    │   ├── used columns: [a (#4), b (#5), numbers.number (#2)]
    │   ├── cardinality: 0.000
    │   ├── precise cardinality: N/A
    │   ├── statistics
    │   └── Filter
    │       ├── filters: [eq(modulo(numbers.number (#2), 10), b (#5))]
    │       ├── output columns: [b (#5), numbers.number (#2)]
    │       ├── outer columns: []
    │       ├── used columns: [a (#4), b (#5), numbers.number (#2)]
    │       ├── cardinality: 0.000
    │       ├── precise cardinality: N/A
    │       ├── statistics
    │       └── Join(Cross)
    │           ├── build keys: []
    │           ├── probe keys: []
    │           ├── other filters: []
    │           ├── output columns: [b (#5), numbers.number (#2)]
    │           ├── outer columns: []
    │           ├── used columns: [a (#4), b (#5), numbers.number (#2)]
    │           ├── cardinality: 0.000
    │           ├── precise cardinality: N/A
    │           ├── statistics
    │           ├── Scan
    │           │   ├── table: system.numbers (#1)
    │           │   ├── filters: []
    │           │   ├── order by: []
    │           │   ├── limit: NONE
    │           │   ├── output columns: [numbers.number (#2)]
    │           │   ├── outer columns: []
    │           │   ├── used columns: [numbers.number (#2)]
    │           │   ├── cardinality: 0.000
    │           │   ├── precise cardinality: N/A
    │           │   └── statistics
    │           └── Aggregate(Initial)
    │               ├── group items: [b (#5) AS (#5)]
    │               ├── aggregate functions: []
    │               ├── output columns: [b (#5)]
    │               ├── outer columns: []
    │               ├── used columns: [a (#4), b (#5)]
    │               ├── cardinality: 1.000
    │               ├── precise cardinality: N/A
    │               ├── statistics
    │               └── Scan
    │                   ├── table: testdb.t (#0)
    │                   ├── filters: []
    │                   ├── order by: []
    │                   ├── limit: NONE
    │                   ├── output columns: [a (#4), b (#5)]
    │                   ├── outer columns: []
    │                   ├── used columns: [a (#4), b (#5)]
    │                   ├── cardinality: 0.000
    │                   ├── precise cardinality: N/A
    │                   └── statistics
    └── Scan
        ├── table: testdb.t (#0)
        ├── filters: []
        ├── order by: []
        ├── limit: NONE
        ├── output columns: [t.a (#0), t.b (#1)]
        ├── outer columns: []
        ├── used columns: [t.a (#0), t.b (#1)]
        ├── cardinality: 0.000
        ├── precise cardinality: N/A
        └── statistics


statement ok
drop database testdb

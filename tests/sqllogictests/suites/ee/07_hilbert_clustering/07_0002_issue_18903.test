## Copyright 2023 Databend Cloud
##
## Licensed under the Elastic License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
##
##     https://www.elastic.co/licensing/elastic-license
##
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.

statement ok
CREATE OR REPLACE DATABASE test_hilbert_2;

statement ok
use test_hilbert_2

statement ok
create or replace table t(a string, b int) cluster by hilbert(substring(a, 1, 5), b) row_per_block=2 block_size_threshold = 18;

statement ok
insert into t values('b', 2), ('c', 4);

statement ok
insert into t values('a', 3),('d', 1);

statement ok
alter table t recluster final;

query TTT
select cluster_key, type, info from clustering_information('test_hilbert_2','t');
----
(SUBSTRING(a FROM 1 FOR 5), b) hilbert {"partial_block_count":2,"partial_segment_count":1,"stable_block_count":0,"stable_segment_count":0,"total_block_count":2,"total_segment_count":1,"unclustered_block_count":0,"unclustered_segment_count":0}

statement ok
drop table t all;

statement ok
drop database test_hilbert_2;

statement ok
drop table if exists t1;


statement ok
create table t1(a int, b int);


statement ok
insert into t1 values(7, 8), (3, 4), (5, 6);


statement ok
drop table if exists t2;


statement ok
create table t2(a int, d int);


statement ok
insert into t2 values(1, 2), (3, 4), (5, 6);


statement query III
select * from t1 join t2 using(a) order by t1.a, t2.a;

----
3 4 4
5 6 6

statement query I
select t1.a from t1 join t2 using(a) order by t1.a, t2.a;

----
3
5


statement query I
select t2.d from t1 join t2 using(a) order by t1.a, t2.a;

----
4
6


statement query III
select * from t1 natural join t2 order by t1.a, t2.a;

----
3 4 4
5 6 6


statement ok
drop table t1;


statement ok
drop table t2;

statement ok
create table t1(a int, b int);


statement ok
insert into t1 values(1, 2), (1, 3), (2, 4);


statement ok
create table t2(c int, d int);


statement ok
insert into t2 values(1, 2), (2, 6);


statement query IIII
select * from t2 inner join t1 on t1.a = t2.c order by a, b, c, d;

----
1 2 1 2
1 2 1 3
2 6 2 4


statement ok
drop table t1;


statement ok
drop table t2;

statement ok
create table t1(a int, b int);


statement ok
create table t2(c int, d int);


statement ok
insert into t1 values(1, 2), (3 ,4), (7, 8);


statement ok
insert into t2 values(1, 4), (2, 3), (6, 8);


statement query IIII
select * from t1 right join t2 on t1.a = t2.c;

----
1 2 1 4
NULL NULL 2 3
NULL NULL 6 8


statement query IIII
select * from t1 left join t2 on t1.a = t2.c;

----
1 2 1 4
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t1.a = t2.c and t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t1.a = t2.c and t2.c > 4 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t2.c > 4 and t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 1 4
7 8 2 3
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t2.c > 4 order by a,b,c,d;

----
1 2 6 8
3 4 6 8
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t1.a > t2.c order by a,b,c,d;

----
1 2 NULL NULL
3 4 1 4
3 4 2 3
7 8 1 4
7 8 2 3
7 8 6 8


statement ok
drop table t1;


statement ok
drop table t2;

statement ok
drop table if exists t;

statement ok
create table t(a int);

statement ok
insert into t values(1),(2),(3);

statement ok
create table t1(b float);


statement ok
insert into t1 values(1.0),(2.0),(3.0);

statement ok
create table t2(c smallint unsigned null);


statement ok
insert into t2 values(1),(2),(null);


statement query IF
select * from t inner join t1 on t.a = t1.b order by a, b;

----
1 1.0
2 2.0
3 3.0


statement query II
select * from t inner join t2 on t.a = t2.c order by a, c;

----
1 1
2 2


statement query II
select * from t inner join t2 on t.a = t2.c + 1 order by a, c;

----
2 1
3 2


statement query II
select * from t inner join t2 on t.a = t2.c + 1 and t.a - 1 = t2.c order by a, c;

----
2 1
3 2


statement query FI
select * from t1 inner join t on t.a = t1.b order by a, b;

----
1.0 1
2.0 2
3.0 3


statement query II
select * from t2 inner join t on t.a = t2.c order by a, c;

----
1 1
2 2


statement query II
select * from t2 inner join t on t.a = t2.c + 1 order by a, c;

----
1 2
2 3


statement query II
select * from t2 inner join t on t.a = t2.c + 1 and t.a - 1 = t2.c order by a, c;

----
1 2
2 3


statement query I
select count(*) from numbers(1000) as t inner join numbers(1000) as t1 on t.number = t1.number;

----
1000


statement query I
select t.number from numbers(10000) as t inner join numbers(1000) as t1 on t.number % 1000 = t1.number order by number limit 5;

----
0
1
2
3
4

statement ok
drop table t;

statement ok
drop table t1;


statement ok
drop table t2;

statement ok
create table t1(a int, b int);


statement ok
create table t2(c int, d int);


statement ok
insert into t1 values(1, 2), (3 ,4), (7, 8);


statement ok
insert into t2 values(1, 4), (2, 3), (6, 8);


statement query IIII
select * from t1 right join t2 on t1.a = t2.c;

----
1 2 1 4
NULL NULL 2 3
NULL NULL 6 8


statement query IIII
select * from t1 left join t2 on t1.a = t2.c;

----
1 2 1 4
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t1.a = t2.c and t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t1.a = t2.c and t2.c > 4 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 NULL NULL


statement query IIII
select * from t1 left outer join t2 on t2.c > 4 and t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t1.a > 3 order by a,b,c,d;

----
1 2 NULL NULL
3 4 NULL NULL
7 8 1 4
7 8 2 3
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t2.c > 4 order by a,b,c,d;

----
1 2 6 8
3 4 6 8
7 8 6 8


statement query IIII
select * from t1 left outer join t2 on t1.a > t2.c order by a,b,c,d;

----
1 2 NULL NULL
3 4 1 4
3 4 2 3
7 8 1 4
7 8 2 3
7 8 6 8

statement ok
CREATE TABLE t3(c0 BIGINT NULL, c1 DOUBLE NULL);

statement ok
CREATE TABLE t4(c0 FLOAT NULL);

statement query I
SELECT SUM(count) FROM (SELECT ((false IS NOT NULL AND false) ::INT64)as count FROM t4 NATURAL LEFT JOIN t3) as res;

----
0

statement ok
drop table t1;

statement ok
drop table t2;

statement ok
drop table t3;

statement ok
drop table t4;

statement ok
create table t1_null(a int null , b int null);


statement ok
create table t2_null(a int null , b int null);


statement ok
insert into t1_null values(1, 2), (2, 3), (null, 1);


statement ok
insert into t2_null values(3, 4), (2, 3), (null, 2);


statement query IIII
select * from t1_null inner join t2_null on t1_null.a = t2_null.a;

----
2 3 2 3

statement ok
drop table t1_null;

statement ok
drop table t2_null;

statement query I
select * from (SELECT number AS a FROM numbers(10)) x left join (SELECT number AS a FROM numbers(5))  y using(a) order by x.a;

----
0
1
2
3
4
5
6
7
8
9

statement query I
select * from (SELECT number AS a FROM numbers(10)) x right join (SELECT number AS a FROM numbers(5))  y using(a) order by x.a;

----
0
1
2
3
4

statement query II
select * from numbers(10) x join (select 1::UInt64 number) y on x.number = y.number;

----
1 1

statement ok
CREATE TABLE onecolumn (x INT NULL);

statement ok
INSERT INTO onecolumn(x) VALUES (44), (NULL), (42);

statement ok
CREATE TABLE empty (x INT);

statement ok
SELECT * FROM onecolumn AS a(x) CROSS JOIN empty AS b(y);

statement ok
drop table onecolumn;

statement ok
drop table empty;


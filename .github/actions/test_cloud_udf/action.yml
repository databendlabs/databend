name: "Test cloud UDF for databend query"
description: "Test cloud Python UDF flow with mock control plane"
runs:
  using: "composite"
  steps:
    - uses: ./.github/actions/setup_test

    - name: Install jq
      shell: bash
      run: sudo apt-get update -yq && sudo apt-get install -yq jq

    - name: Install uv
      shell: bash
      run: pip install uv

    - uses: ./.github/actions/setup_minio

    - name: Run Cloud UDF Test
      shell: bash
      run: |
        bash ./tests/udf/test-cloud-udf.sh

    - name: Upload failure
      if: failure()
      uses: ./.github/actions/artifact_failure
      with:
        name: test-cloud-udf

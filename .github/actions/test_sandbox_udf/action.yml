name: "Test sandbox UDF for databend query"
description: "Test sandbox Python UDF flow with mock control plane"
runs:
  using: "composite"
  steps:
    - uses: ./.github/actions/setup_test

    - name: Install uv
      shell: bash
      run: pip install uv

    - name: Install nox
      shell: bash
      run: pip install nox

    - uses: ./.github/actions/setup_minio

    - name: Run Sandbox UDF Test
      shell: bash
      run: |
        nox -f tests/nox/noxfile.py -s udf_sandbox

    - name: Upload failure
      if: failure()
      uses: ./.github/actions/artifact_failure
      with:
        name: test-sandbox-udf
